<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1D Bose-Hubbard Model · Rimu.jl</title><meta name="title" content="1D Bose-Hubbard Model · Rimu.jl"/><meta property="og:title" content="1D Bose-Hubbard Model · Rimu.jl"/><meta property="twitter:title" content="1D Bose-Hubbard Model · Rimu.jl"/><meta name="description" content="Documentation for Rimu.jl."/><meta property="og:description" content="Documentation for Rimu.jl."/><meta property="twitter:description" content="Documentation for Rimu.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="Rimu.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Rimu.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Guide</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href="BHM-example.html">1D Bose-Hubbard Model</a></li><li><a class="tocitem" href="BHM-example-mpi.html">Rimu with MPI</a></li><li><a class="tocitem" href="G2-example.html">Calculating observables</a></li><li><a class="tocitem" href="exact-example.html">Exact diagonalisation</a></li><li><a class="tocitem" href="HO-example.html">Degenerate perturbation theory in a harmonic oscillator basis</a></li></ul></li><li><span class="tocitem">User documentation</span><ul><li><a class="tocitem" href="../statstools.html">StatsTools</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../interfaces.html">Interfaces</a></li><li><a class="tocitem" href="../hamiltonians.html">Hamiltonians</a></li><li><a class="tocitem" href="../dictvectors.html">Dict vectors</a></li><li><a class="tocitem" href="../addresses.html">BitString addresses</a></li><li><a class="tocitem" href="../stochasticstyles.html">Stochastic styles</a></li><li><a class="tocitem" href="../RMPI.html">RMPI</a></li><li><a class="tocitem" href="../rimuio.html">I/O</a></li><li><a class="tocitem" href="../randomnumbers.html">Random numbers</a></li><li><a class="tocitem" href="../documentation.html">Documentation generation</a></li><li><a class="tocitem" href="../testing.html">Code testing</a></li></ul></li><li><a class="tocitem" href="../API.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="BHM-example.html">1D Bose-Hubbard Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="BHM-example.html">1D Bose-Hubbard Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/joachimbrand/Rimu.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/joachimbrand/Rimu.jl/blob/develop/scripts/BHM-example.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-1:-1D-Bose-Hubbard-Model"><a class="docs-heading-anchor" href="#Example-1:-1D-Bose-Hubbard-Model">Example 1: 1D Bose-Hubbard Model</a><a id="Example-1:-1D-Bose-Hubbard-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-1D-Bose-Hubbard-Model" title="Permalink"></a></h1><p>This is an example calculation finding the ground state of a 1D Bose-Hubbard chain with 6 particles in 6 lattice sites.</p><p>A runnable script for this example is located <a href="https://github.com/joachimbrand/Rimu.jl/blob/develop/scripts/BHM-example.jl">here</a>. Run it with <code>julia BHM-example.jl</code>.</p><p>Firstly, we load all needed modules. <code>Rimu</code> for FCIQMC calculation;</p><pre><code class="language-julia hljs">using Rimu
using Random</code></pre><p>Now we define the physical problem: Setting the number of lattice sites <code>m = 6</code>; and the number of particles <code>n = 6</code>:</p><pre><code class="language-julia hljs">m = n = 6</code></pre><pre><code class="nohighlight hljs">6</code></pre><p>Generating a configuration that particles are evenly distributed:</p><pre><code class="language-julia hljs">aIni = near_uniform(BoseFS{n,m})</code></pre><pre><code class="nohighlight hljs">BoseFS{6,6}((1, 1, 1, 1, 1, 1))</code></pre><p>where <code>BoseFS</code> is used to create a bosonic system. The Hamiltonian is defined based on the configuration <code>aIni</code>, with additional onsite interaction strength <code>u = 6.0</code> and the hopping strength <code>t = 1.0</code>:</p><pre><code class="language-julia hljs">Ĥ = HubbardReal1D(aIni; u = 6.0, t = 1.0)</code></pre><pre><code class="nohighlight hljs">HubbardReal1D(BoseFS{6,6}((1, 1, 1, 1, 1, 1)); u=6.0, t=1.0)</code></pre><p>Now let&#39;s setup the Monte Carlo settings. The number of walkers to use in this Monte Carlo run:</p><pre><code class="language-julia hljs">targetwalkers = 1_000</code></pre><pre><code class="nohighlight hljs">1000</code></pre><p>The number of time steps before doing statistics, i.e. letting the walkers to sample Hilbert and to equilibrate:</p><pre><code class="language-julia hljs">steps_equilibrate = 1_000</code></pre><pre><code class="nohighlight hljs">1000</code></pre><p>And the number of time steps used for getting statistics, e.g. time-average of shift, projected energy, walker numbers, etc.:</p><pre><code class="language-julia hljs">steps_measure = 2_000</code></pre><pre><code class="nohighlight hljs">2000</code></pre><p>Set the size of a time step</p><pre><code class="language-julia hljs">dτ = 0.001</code></pre><pre><code class="nohighlight hljs">0.001</code></pre><p>and we report QMC data every k-th step, set the interval to record QMC data:</p><pre><code class="language-julia hljs">reporting_interval = 1</code></pre><pre><code class="nohighlight hljs">1</code></pre><p>Now we prepare initial state and allocate memory. The initial address is defined above as <code>aIni = near_uniform(Ĥ)</code>. Putting one of walkers into the initial address <code>aIni</code></p><pre><code class="language-julia hljs">svec = DVec(aIni =&gt; 1)</code></pre><pre><code class="nohighlight hljs">DVec{BoseFS{6, 6, BitString{11, 1, UInt16}},Int64} with 1 entry, style = IsStochasticInteger{Int64}()
  fs&quot;|1 1 1 1 1 1⟩&quot; =&gt; 1</code></pre><p>Let&#39;s plant a seed for the random number generator to get consistent result:</p><pre><code class="language-julia hljs">Random.seed!(17)</code></pre><pre><code class="nohighlight hljs">Random.TaskLocalRNG()</code></pre><p>Now let&#39;s setup all the FCIQMC strategies.</p><p>Passing dτ and total number of time steps into params:</p><pre><code class="language-julia hljs">params = RunTillLastStep(dτ = dτ, laststep = steps_equilibrate + steps_measure)</code></pre><pre><code class="nohighlight hljs">RunTillLastStep{Float64}
  step: Int64 0
  laststep: Int64 3000
  shiftMode: Bool false
  shift: Float64 0.0
  dτ: Float64 0.001
</code></pre><p>Strategy for updating the shift:</p><pre><code class="language-julia hljs">s_strat = DoubleLogUpdate(targetwalkers = targetwalkers, ζ = 0.08)</code></pre><pre><code class="nohighlight hljs">DoubleLogUpdate{Int64}(1000, 0.08, 0.0016)</code></pre><p>Strategy for reporting info:</p><pre><code class="language-julia hljs">r_strat = ReportDFAndInfo(reporting_interval = reporting_interval, info_interval = 100)</code></pre><pre><code class="nohighlight hljs">ReportDFAndInfo
  reporting_interval: Int64 1
  info_interval: Int64 100
  io: IOContext{Base.PipeEndpoint}
  writeinfo: Bool false
</code></pre><p>Strategy for updating dτ:</p><pre><code class="language-julia hljs">τ_strat = ConstantTimeStep()</code></pre><pre><code class="nohighlight hljs">ConstantTimeStep()</code></pre><p>set up the calculation and reporting of the projected energy in this case we are projecting onto the starting vector, which contains a single configuration</p><pre><code class="language-julia hljs">post_step = ProjectedEnergy(Ĥ, copy(svec))</code></pre><pre><code class="nohighlight hljs">ProjectedEnergy{HubbardReal1D{Float64, BoseFS{6, 6, BitString{11, 1, UInt16}}, 6.0, 1.0}, Rimu.DictVectors.FrozenDVec{BoseFS{6, 6, BitString{11, 1, UInt16}}, Int64}, Rimu.DictVectors.FrozenDVec{BoseFS{6, 6, BitString{11, 1, UInt16}}, Float64}}(:vproj, :hproj, HubbardReal1D(BoseFS{6,6}((1, 1, 1, 1, 1, 1)); u=6.0, t=1.0), Rimu.DictVectors.FrozenDVec{BoseFS{6, 6, BitString{11, 1, UInt16}}, Int64}(Pair{BoseFS{6, 6, BitString{11, 1, UInt16}}, Int64}[fs&quot;|1 1 1 1 1 1⟩&quot; =&gt; 1]), Rimu.DictVectors.FrozenDVec{BoseFS{6, 6, BitString{11, 1, UInt16}}, Float64}(Pair{BoseFS{6, 6, BitString{11, 1, UInt16}}, Float64}[fs&quot;|1 1 1 1 2 0⟩&quot; =&gt; -1.4142135623730951, fs&quot;|0 2 1 1 1 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|1 1 1 1 0 2⟩&quot; =&gt; -1.4142135623730951, fs&quot;|1 2 0 1 1 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|2 0 1 1 1 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|1 1 1 2 0 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|1 1 2 0 1 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|1 1 0 2 1 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|1 1 1 0 2 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|1 0 2 1 1 1⟩&quot; =&gt; -1.4142135623730951, fs&quot;|2 1 1 1 1 0⟩&quot; =&gt; -1.4142135623730951, fs&quot;|0 1 1 1 1 2⟩&quot; =&gt; -1.4142135623730951]))</code></pre><p>Print out info about what we are doing:</p><pre><code class="language-julia hljs">println(&quot;Finding ground state for:&quot;)
println(Ĥ)
println(&quot;Strategies for run:&quot;)
println(params, s_strat)
println(τ_strat)</code></pre><pre><code class="nohighlight hljs">Finding ground state for:
HubbardReal1D(BoseFS{6,6}((1, 1, 1, 1, 1, 1)); u=6.0, t=1.0)
Strategies for run:
RunTillLastStep{Float64}
  step: Int64 0
  laststep: Int64 3000
  shiftMode: Bool false
  shift: Float64 0.0
  dτ: Float64 0.001
DoubleLogUpdate{Int64}(1000, 0.08, 0.0016)
ConstantTimeStep()
</code></pre><p>Finally, we can start the main FCIQMC loop:</p><pre><code class="language-julia hljs">df, state = lomc!(Ĥ,svec;
            params,
            laststep = steps_equilibrate + steps_measure,
            s_strat,
            r_strat,
            τ_strat,
            post_step,
);</code></pre><p>Here is how to save the output data stored in <code>df</code> into a <code>.arrow</code> file, which can be read in later:</p><pre><code class="language-julia hljs">println(&quot;Writing data to disk...&quot;)
save_df(&quot;fciqmcdata.arrow&quot;, df)</code></pre><pre><code class="nohighlight hljs">&quot;fciqmcdata.arrow&quot;</code></pre><p>Now let&#39;s look at the calculated energy from the shift. Loading the equilibrated data</p><pre><code class="language-julia hljs">qmcdata = last(df,steps_measure);</code></pre><p>compute the average shift and its standard error</p><pre><code class="language-julia hljs">se = shift_estimator(qmcdata)</code></pre><pre><code class="nohighlight hljs">BlockingResult{Float64}
  mean = -3.95 ± 0.11
  with uncertainty of ± 0.010173501311647543
  from 62 blocks after 5 transformations (k = 6).
</code></pre><p>For the projected energy, it a bit more complicated as it&#39;s a ratio of two means:</p><pre><code class="language-julia hljs">pe = projected_energy(qmcdata)</code></pre><pre><code class="nohighlight hljs">RatioBlockingResult{Float64,MonteCarloMeasurements.Particles{Float64, 2000}}
  ratio = -3.94422 ± (0.0650487, 0.0740682) (MC)
  95% confidence interval: [-4.0873, -3.81349]) (MC)
  linear error propagation: -3.947 ± 0.0693808
  |δ_y| = |0.0299894| (≤ 0.1 for normal approx)
  Blocking successful with 15 blocks after 7 transformations (k = 8).
</code></pre><p>The result is a ratio distribution. Let&#39;s get its median and lower and upper error bars for a 95% confidence interval</p><pre><code class="language-julia hljs">v = val_and_errs(pe; p=0.95)

println(&quot;Energy from $steps_measure steps with $targetwalkers walkers:
         Shift: $(se.mean) ± $(se.err);
         Projected Energy: $(v.val) ± ($(v.val_l), $(v.val_u))&quot;)</code></pre><pre><code class="nohighlight hljs">Energy from 2000 steps with 1000 walkers:
         Shift: -3.952639003491845 ± 0.11236999479597524;
         Projected Energy: -3.944215043127995 ± (0.14308532769110638, 0.1307274471262665)
</code></pre><p>Finished!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../index.html">« Guide</a><a class="docs-footer-nextpage" href="BHM-example-mpi.html">Rimu with MPI »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Wednesday 20 September 2023 02:29">Wednesday 20 September 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
