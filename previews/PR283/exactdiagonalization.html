<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Exact Diagonalization · Rimu.jl</title><meta name="title" content="Exact Diagonalization · Rimu.jl"/><meta property="og:title" content="Exact Diagonalization · Rimu.jl"/><meta property="twitter:title" content="Exact Diagonalization · Rimu.jl"/><meta name="description" content="Documentation for Rimu.jl."/><meta property="og:description" content="Documentation for Rimu.jl."/><meta property="twitter:description" content="Documentation for Rimu.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Rimu.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Rimu.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Guide</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="generated/BHM-example.html">1D Bose-Hubbard Model</a></li><li><a class="tocitem" href="generated/BHM-example-mpi.html">Rimu with MPI</a></li><li><a class="tocitem" href="generated/G2-example.html">Calculating observables</a></li><li><a class="tocitem" href="generated/exact-example.html">Exact diagonalization</a></li><li><a class="tocitem" href="generated/HO-example.html">Degenerate perturbation theory in a harmonic oscillator basis</a></li></ul></li><li><span class="tocitem">User documentation</span><ul><li class="is-active"><a class="tocitem" href="exactdiagonalization.html">Exact Diagonalization</a><ul class="internal"><li><a class="tocitem" href="#ExactDiagonalizationProblem"><span><code>ExactDiagonalizationProblem</code></span></a></li><li><a class="tocitem" href="#Solver-algorithms"><span>Solver algorithms</span></a></li><li><a class="tocitem" href="#Converting-a-Hamiltonian-in-to-a-matrix"><span>Converting a Hamiltonian in to a matrix</span></a></li><li><a class="tocitem" href="#Deprecated"><span>Deprecated</span></a></li></ul></li><li><a class="tocitem" href="projectormontecarlo.html">Projector Monte Carlo</a></li><li><a class="tocitem" href="statstools.html">StatsTools</a></li><li><a class="tocitem" href="mpi.html">Using MPI</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="interfaces.html">Interfaces</a></li><li><a class="tocitem" href="hamiltonians.html">Hamiltonians</a></li><li><a class="tocitem" href="dictvectors.html">Dict vectors</a></li><li><a class="tocitem" href="addresses.html">BitString addresses</a></li><li><a class="tocitem" href="stochasticstyles.html">Stochastic styles</a></li><li><a class="tocitem" href="RMPI.html">RMPI</a></li><li><a class="tocitem" href="rimuio.html">I/O</a></li><li><a class="tocitem" href="randomnumbers.html">Random numbers</a></li><li><a class="tocitem" href="documentation.html">Documentation generation</a></li><li><a class="tocitem" href="testing.html">Code testing</a></li></ul></li><li><a class="tocitem" href="API.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User documentation</a></li><li class="is-active"><a href="exactdiagonalization.html">Exact Diagonalization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="exactdiagonalization.html">Exact Diagonalization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/joachimbrand/Rimu.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/joachimbrand/Rimu.jl/blob/develop/docs/src/exactdiagonalization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Exact-Diagonalization"><a class="docs-heading-anchor" href="#Exact-Diagonalization">Exact Diagonalization</a><a id="Exact-Diagonalization-1"></a><a class="docs-heading-anchor-permalink" href="#Exact-Diagonalization" title="Permalink"></a></h1><p>The main functionality of Rimu for exact diagonalization is contained in the module <code>ExactDiagonalization</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization" href="#Rimu.ExactDiagonalization"><code>Rimu.ExactDiagonalization</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The module <code>Rimu.ExactDiagonalization</code> provides a framework for exact diagonalization of quantum many-body systems defined by an <a href="hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> type.</p><p>The main usage is through defining an <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> and solving it with the <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a> function. The module provides a unified interface for accessing different solver algorithms, which make use of solvers provided by external packages.</p><p><strong>Exports</strong></p><ul><li><p><a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a></p></li><li><p><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a></p></li><li><p><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.build_basis"><code>build_basis</code></a></p></li><li><p><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.KrylovKitSolver"><code>KrylovKitSolver</code></a></p></li><li><p><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.LinearAlgebraSolver"><code>LinearAlgebraSolver</code></a></p></li><li><p><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.ArpackSolver"><code>ArpackSolver</code></a></p></li><li><p><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.LOBPCGSolver"><code>LOBPCGSolver</code></a></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/ExactDiagonalization.jl#L1-L19">source</a></section></article><h2 id="ExactDiagonalizationProblem"><a class="docs-heading-anchor" href="#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a><a id="ExactDiagonalizationProblem-1"></a><a class="docs-heading-anchor-permalink" href="#ExactDiagonalizationProblem" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.ExactDiagonalizationProblem" href="#Rimu.ExactDiagonalization.ExactDiagonalizationProblem"><code>Rimu.ExactDiagonalization.ExactDiagonalizationProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExactDiagonalizationProblem(hamiltonian::AbstractHamiltonian, [v0]; kwargs...)</code></pre><p>Defines an exact diagonalization problem with an <a href="hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> <code>hamiltonian</code>. Optionally, a starting vector of type <a href="dictvectors.html#Rimu.Interfaces.AbstractDVec"><code>AbstractDVec</code></a>, or a single address or a collection of addresses can be passed as <code>v0</code>.</p><p><code>ExactDiagonalizationProblem</code>s can be solved with <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>algorithm=LinearAlgebraSolver()</code>: The algorithm to use for solving the problem. The   algorithm can also be specified as the second positional argument in the <code>init</code>   function.</li><li>Optional keyword arguments will be passed on to the <code>init</code> and <code>solve</code> functions.</li></ul><p><strong>Algorithms</strong></p><ul><li><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.LinearAlgebraSolver"><code>LinearAlgebraSolver()</code></a>: An algorithm for solving the problem using the   dense-matrix eigensolver from the <code>LinearAlgebra</code> standard library (eventually using   LAPACK). Only suitable for small matrices.</li><li><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.KrylovKitSolver"><code>KrylovKitSolver(matrix_free=true)</code></a>: An algorithm for finding a few eigenvalues   and vectors. With <code>matrix_free=true</code> the problem is solved without instatiating a   matrix. This is suitable for large dimensions. With <code>matrix_free=false</code> the problem is   solved after instantiating a sparse matrix. This is faster if sufficient memory is   available. Requires <code>using KrylovKit</code>.</li><li><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.ArpackSolver"><code>ArpackSolver()</code></a>: An algorithm for solving the problem after instantiating a   sparse matrix and using the Arpack Fortran library. Requires <code>using Arpack</code>.</li><li><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.LOBPCGSolver"><code>LOBPCGSolver()</code></a>: An algorithm for solving the problem after instantiating a   sparse matrix using the LOBPCG method. Requires <code>using IterativeSolvers</code>.</li></ul><p><strong>Keyword arguments for matrix-based algorithms (also accepted by <a href="exactdiagonalization.html#CommonSolve.init-Tuple{ExactDiagonalizationProblem}"><code>init</code></a>)</strong></p><p>See <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a> for more information.</p><ul><li><code>sizelim</code>: The maximum size of the basis set representation. The default is <code>10^6</code> for   sparse matrices and <code>10^5</code> for dense matrices.</li><li><code>cutoff</code>: A cutoff value for the basis set representation.</li><li><code>filter</code>: A filter function for the basis set representation.</li><li><code>nnzs = 0</code>: The number of non-zero elements in the basis set representation. Setting a   non-zero value can speed up the computation.</li><li><code>col_hint = 0</code>: A hint for the number of columns in the basis set representation.</li><li><code>sort = false</code>: Whether to sort the basis set representation.</li></ul><p><strong>Keyword arguments for iterative algorithms (also accepted by <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>)</strong></p><ul><li><code>verbose = false</code>: Whether to print additional information.</li><li><code>abstol = nothing</code>: The absolute tolerance for the solver. If <code>nothing</code>, the solver   chooses a default value.</li><li><code>howmany = 1</code>: The minimum number of eigenvalues to compute.</li><li><code>which = :SR</code>: Whether to compute the largest or smallest eigenvalues.</li><li><code>maxiters = nothing</code>: The maximum number of iterations for the solver. If <code>nothing</code>, the   solver chooses a default value.</li></ul><p><strong>Solving an <code>ExactDiagonalizationProblem</code></strong></p><p>The <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a> function can be called directly on an <code>ExactDiagonalizationProblem</code> to solve it. Alternatively, the <a href="exactdiagonalization.html#CommonSolve.init-Tuple{ExactDiagonalizationProblem}"><code>init</code></a> function can be used to initialize a solver, which can then be solved with <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>. The <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a> function returns a result type with the eigenvalues, eigenvectors, and convergence information.</p><p><strong>Result type</strong></p><p>The result type for the <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a> function is determined by the algorithm used. It has the following fields:</p><ul><li><code>values::Vector</code>: The eigenvalues.</li><li><code>vectors::Vector{&lt;:AbstractDVec}</code>: The eigenvectors.</li><li><code>success::Bool</code>: A boolean flag indicating whether the solver was successful.</li><li><code>info</code>: Convergence information.</li><li><code>algorithm</code>: The algorithm used for the computation.</li><li><code>problem</code>: The <code>ExactDiagonalizationProblem</code> that was solved.</li><li>Additional fields may be present depending on the algorithm used.</li></ul><p>Iterating the result type will yield the eigenvalues, eigenvectors, and a boolean flag <code>success</code> in that order.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; p = ExactDiagonalizationProblem(HubbardReal1D(BoseFS(1,1,1)))
ExactDiagonalizationProblem(
  HubbardReal1D(fs&quot;|1 1 1⟩&quot;; u=1.0, t=1.0),
  nothing;
  NamedTuple()...
)

julia&gt; result = solve(p) # convert to dense matrix and solve with LinearAlgebra.eigen
EDResult for algorithm LinearAlgebraSolver() with 10 eigenvalue(s),
  values = [-5.09593, -1.51882, -1.51882, 1.55611, 1.6093, 1.6093, 4.0, 4.53982, 4.90952, 4.90952],
  and vectors of length 10.
  Convergence info: &quot;Dense matrix eigensolver solution from `LinearAlgebra.eigen`&quot;, with howmany = 10 eigenvalues requested.
  success = true.

julia&gt; using KrylovKit # an external package has to be installed and loaded

julia&gt; s = init(p; algorithm = KrylovKitSolver(true)) # solve without building a matrix
KrylovKitDirectEDSolver
 with algorithm KrylovKitSolver(matrix_free = true,) for hamiltonian = HubbardReal1D(fs&quot;|1 1 1⟩&quot;; u=1.0, t=1.0),
  v0 = 1-element PDVec: style = IsDeterministic{Float64}()
  fs&quot;|1 1 1⟩&quot; =&gt; 1.0,
  kwargs = NamedTuple()
)

julia&gt; values, vectors, success = solve(s);

julia&gt; result.values[1] ≈ values[1]
true</code></pre><p>See also <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve(::ExactDiagonalizationProblem)</code></a>, <a href="exactdiagonalization.html#CommonSolve.init-Tuple{ExactDiagonalizationProblem}"><code>init(::ExactDiagonalizationProblem)</code></a>, <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.KrylovKitSolver"><code>KrylovKitSolver</code></a>, <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.ArpackSolver"><code>ArpackSolver</code></a>, <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.LinearAlgebraSolver"><code>LinearAlgebraSolver</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Using the <code>KrylovKitSolver()</code> algorithms requires the KrylovKit.jl package. The package can be loaded with <code>using KrylovKit</code>. Using the <code>ArpackSolver()</code> algorithm requires the Arpack.jl package. The package can be loaded with <code>using Arpack</code>. Using the <code>LOBPCGSolver()</code> algorithm requires the IterativeSolvers.jl package. The package can be loaded with <code>using IterativeSolvers</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/exact_diagonalization_problem.jl#L1-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonSolve.solve-Tuple{ExactDiagonalizationProblem}" href="#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>CommonSolve.solve</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solve(p::ExactDiagonalizationProblem, [algorithm]; kwargs...)</code></pre><p>Solve an <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> <code>p</code> directly. Optionally specify an <code>algorithm.</code> Returns a result type with the eigenvalues, eigenvectors, and convergence information.</p><p>For a description of the keyword arguments, see the documentation for <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a>.</p><p>See also <a href="API.html#CommonSolve.solve"><code>solve(::ProjectorMonteCarloProblem)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/solve.jl#L59-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonSolve.init-Tuple{ExactDiagonalizationProblem}" href="#CommonSolve.init-Tuple{ExactDiagonalizationProblem}"><code>CommonSolve.init</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init(p::ExactDiagonalizationProblem, [algorithm]; kwargs...)</code></pre><p>Initialize a solver for an <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> <code>p</code> with an optional <code>algorithm</code>. Returns a solver instance that can be solved with <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>.</p><p>For a description of the keyword arguments, see the documentation for <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/init_and_solvers.jl#L1-L10">source</a></section></article><h2 id="Solver-algorithms"><a class="docs-heading-anchor" href="#Solver-algorithms">Solver algorithms</a><a id="Solver-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Solver-algorithms" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.KrylovKitSolver" href="#Rimu.ExactDiagonalization.KrylovKitSolver"><code>Rimu.ExactDiagonalization.KrylovKitSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KrylovKitSolver(matrix_free::Bool; kwargs...)
KrylovKitSolver(; matrix_free = false, kwargs...)</code></pre><p>Algorithm for solving a large <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> to find a few eigenvalues and vectors using the KrylovKit.jl package. The Lanczos method is used for hermitian matrices, and the Arnoldi method is used for non-hermitian matrices.</p><p><strong>Arguments</strong></p><ul><li><code>matrix_free = false</code>: Whether to use a matrix-free algorithm. If <code>false</code>, a sparse matrix   will be instantiated. This is typically faster and recommended for small matrices,   but requires more memory. If <code>true</code>, the matrix is not instantiated, which is useful for   large matrices that would not fit into memory. The calculation will parallelise using   threading and MPI if available by making use of <a href="dictvectors.html#Rimu.DictVectors.PDVec"><code>PDVec</code></a>.</li><li><code>kwargs</code>: Additional keyword arguments are passed on to the function   <a href="https://jutho.github.io/KrylovKit.jl/stable/man/eig/#KrylovKit.eigsolve"><code>KrylovKit.eigsolve()</code></a>.</li></ul><p>See also <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a>, <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Requires the KrylovKit.jl package to be loaded with <code>using KrylovKit</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/algorithms.jl#L4-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.LinearAlgebraSolver" href="#Rimu.ExactDiagonalization.LinearAlgebraSolver"><code>Rimu.ExactDiagonalization.LinearAlgebraSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearAlgebraSolver(; kwargs...)</code></pre><p>Algorithm for solving an <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> using the dense-matrix eigensolver from the <code>LinearAlgebra</code> standard library. This is only suitable for small matrices.</p><p>The <code>kwargs</code> are passed on to function <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.eigen"><code>LinearAlgebra.eigen</code></a>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>permute = true</code>: Whether to permute the matrix before diagonalization.</li><li><code>scale = true</code>: Whether to scale the matrix before diagonalization.</li><li><code>sortby</code>: The sorting order for the eigenvalues.</li></ul><p>See also <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a>, <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/algorithms.jl#L133-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.ArpackSolver" href="#Rimu.ExactDiagonalization.ArpackSolver"><code>Rimu.ExactDiagonalization.ArpackSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ArpackSolver(; kwargs...)</code></pre><p>Algorithm for solving an <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> after instantiating a sparse matrix. It uses the Lanzcos method for hermitian problems, and the Arnoldi method for non-hermitian problems, using the Arpack Fortran library. This is faster than <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.KrylovKitSolver"><code>KrylovKitSolver(; matrix_free=true)</code></a>, but it requires more memory and will only be useful if the matrix fits into memory.</p><p>The <code>kwargs</code> are passed on to the function <a href="https://arpack.julialinearalgebra.org/stable/eigs/"><code>Arpack.eigs()</code></a>.</p><p>See also <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a>, <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Requires the Arpack.jl package to be loaded with <code>using Arpack</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/algorithms.jl#L52-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.LOBPCGSolver" href="#Rimu.ExactDiagonalization.LOBPCGSolver"><code>Rimu.ExactDiagonalization.LOBPCGSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LOBPCGSolver(; kwargs...)</code></pre><p>The Locally Optimal Block Preconditioned Conjugate Gradient Method (LOBPCG). Algorithm for solving an <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> after instantiating a sparse matrix.</p><p>LOBPCG is not suitable for non-hermitian eigenvalue problems.</p><p>The <code>kwargs</code> are passed on to the function <a href="https://iterativesolvers.julialinearalgebra.org/dev/eigenproblems/lobpcg/"><code>IterativeSolvers.lobpcg()</code></a>.</p><p>See also <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a>, <a href="exactdiagonalization.html#CommonSolve.solve-Tuple{ExactDiagonalizationProblem}"><code>solve</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Requires the IterativeSolvers.jl package to be loaded with <code>using IterativeSolvers</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/algorithms.jl#L92-L108">source</a></section></article><h2 id="Converting-a-Hamiltonian-in-to-a-matrix"><a class="docs-heading-anchor" href="#Converting-a-Hamiltonian-in-to-a-matrix">Converting a Hamiltonian in to a matrix</a><a id="Converting-a-Hamiltonian-in-to-a-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-a-Hamiltonian-in-to-a-matrix" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.BasisSetRepresentation" href="#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>Rimu.ExactDiagonalization.BasisSetRepresentation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BasisSetRepresentation(
    hamiltonian::AbstractHamiltonian, addr=starting_address(hamiltonian);
    sizelim=10^6, nnzs, cutoff, filter, sort=false, kwargs...
)
BasisSetRepresentation(hamiltonian::AbstractHamiltonian, addresses::AbstractVector; kwargs...)</code></pre><p>Eagerly construct the basis set representation of the operator <code>hamiltonian</code> with all addresses reachable from <code>addr</code>. Instead of a single address, a vector of <code>addresses</code> can be passed.</p><p>An <code>ArgumentError</code> is thrown if <code>dimension(hamiltonian) &gt; sizelim</code> in order to prevent memory overflow. Set <code>sizelim = Inf</code> in order to disable this behaviour.</p><p>Providing the number <code>nnzs</code> of expected calculated matrix elements and <code>col_hint</code> for the estimated number of nonzero off-diagonal matrix elements in each matrix column may improve performance.</p><p>Providing an energy cutoff will skip the columns and rows with diagonal elements greater than <code>cutoff</code>. Alternatively, an arbitrary <code>filter</code> function can be used instead. Addresses passed as arguments are not filtered. To generate the matrix truncated to the subspace spanned by the <code>addresses</code>, use <code>filter = Returns(false)</code>.</p><p>Setting <code>sort</code> to <code>true</code> will sort the matrix rows and columns. This is useful when the order of the columns matters, e.g. when comparing matrices. Any additional keyword arguments are passed on to <code>Base.sortperm</code>.</p><p><strong>Fields</strong></p><ul><li><code>sparse_matrix</code>: sparse matrix representing <code>hamiltonian</code> in the basis <code>basis</code></li><li><code>basis</code>: vector of addresses</li><li><code>hamiltonian</code>: the Hamiltonian <code>hamiltonian</code></li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; hamiltonian = HubbardReal1D(BoseFS(1,0,0));

julia&gt; bsr = BasisSetRepresentation(hamiltonian)
BasisSetRepresentation(HubbardReal1D(fs&quot;|1 0 0⟩&quot;; u=1.0, t=1.0)) with dimension 3 and 9 stored entries:3×3 SparseArrays.SparseMatrixCSC{Float64, Int64} with 9 stored entries:
  0.0  -1.0  -1.0
 -1.0   0.0  -1.0
 -1.0  -1.0   0.0

julia&gt; BasisSetRepresentation(hamiltonian, bsr.basis[1:2]; filter = Returns(false)) # passing addresses and truncating
BasisSetRepresentation(HubbardReal1D(fs&quot;|1 0 0⟩&quot;; u=1.0, t=1.0)) with dimension 2 and 4 stored entries:2×2 SparseArrays.SparseMatrixCSC{Float64, Int64} with 4 stored entries:
  0.0  -1.0
 -1.0   0.0

julia&gt; using LinearAlgebra; round.(eigvals(Matrix(bsr)); digits = 4) # eigenvalues
3-element Vector{Float64}:
 -2.0
  1.0
  1.0

julia&gt; ev = eigvecs(Matrix(bsr))[:,1]; ev = ev .* sign(ev[1]) # ground state eigenvector
3-element Vector{Float64}:
 0.5773502691896257
 0.5773502691896255
 0.5773502691896257

julia&gt; dv = DVec(zip(bsr.basis, ev)) # ground state as DVec
DVec{BoseFS{1, 3, BitString{3, 1, UInt8}},Float64} with 3 entries, style = IsDeterministic{Float64}()
  fs&quot;|0 0 1⟩&quot; =&gt; 0.57735
  fs&quot;|0 1 0⟩&quot; =&gt; 0.57735
  fs&quot;|1 0 0⟩&quot; =&gt; 0.57735</code></pre><p>Has methods for <a href="hamiltonians.html#Rimu.Hamiltonians.dimension"><code>dimension</code></a>, <a href="exactdiagonalization.html#SparseArrays.sparse"><code>sparse</code></a>, <a href="exactdiagonalization.html#Base.Matrix"><code>Matrix</code></a>, <a href="hamiltonians.html#Rimu.Interfaces.starting_address"><code>starting_address</code></a>.</p><p>Part of the <a href="hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface. See also <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.build_basis"><code>build_basis</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/basis_set_representation.jl#L155-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.build_basis" href="#Rimu.ExactDiagonalization.build_basis"><code>Rimu.ExactDiagonalization.build_basis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_basis(
    ham, address=starting_address(ham);
    cutoff, filter, sizelim, sort=false, kwargs...
) -&gt; basis
build_basis(ham, addresses::AbstractVector; kwargs...)</code></pre><p>Get all basis element of a linear operator <code>ham</code> that are reachable (via non-zero matrix elements) from the address <code>address</code>, returned as a vector. Instead of a single address, a vector of <code>addresses</code> can be passed. Does not return the matrix, for that purpose use <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a>.</p><p>Providing an energy cutoff will skip addresses with diagonal elements greater than <code>cutoff</code>. Alternatively, an arbitrary <code>filter</code> function can be used instead. Addresses passed as arguments are not filtered. A maximum basis size <code>sizelim</code> can be set which will throw an error if the expected dimension of <code>ham</code> is larger than <code>sizelim</code>. This may be useful when memory may be a concern. These options are disabled by default.</p><p>Setting <code>sort</code> to <code>true</code> will sort the basis. Any additional keyword arguments are passed on to <code>Base.sort!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/basis_set_representation.jl#L95-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.Matrix" href="#Base.Matrix"><code>Base.Matrix</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Matrix(
    hamiltonian::AbstractHamiltonian, addr=starting_address(hamiltonian);
    sizelim=10^4, kwargs...
)
Matrix(bsr::BasisSetRepresentation)</code></pre><p>Return a dense matrix representation of <code>hamiltonian</code> or <code>bsr</code>. <code>kwargs</code> are passed to <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a>.</p><p>See <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/basis_set_representation.jl#L446-L457">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SparseArrays.sparse" href="#SparseArrays.sparse"><code>SparseArrays.sparse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sparse(hamiltonian::AbstractHamiltonian, addr=starting_address(hamiltonian); kwargs...)
sparse(bsr::BasisSetRepresentation)</code></pre><p>Return a sparse matrix representation of <code>hamiltonian</code> or <code>bsr</code>. <code>kwargs</code> are passed to <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a>.</p><p>See <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/basis_set_representation.jl#L432-L440">source</a></section></article><h2 id="Deprecated"><a class="docs-heading-anchor" href="#Deprecated">Deprecated</a><a id="Deprecated-1"></a><a class="docs-heading-anchor-permalink" href="#Deprecated" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.ExactDiagonalization.BasisSetRep" href="#Rimu.ExactDiagonalization.BasisSetRep"><code>Rimu.ExactDiagonalization.BasisSetRep</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BasisSetRep(args...; kwargs...)</code></pre><p><code>BasisSetRep</code> is deprecated. Use <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/92d6b97f45f72529aa091eb6ee2f2004d31bf87c/src/ExactDiagonalization/deprecated.jl#L4-L7">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="generated/HO-example.html">« Degenerate perturbation theory in a harmonic oscillator basis</a><a class="docs-footer-nextpage" href="projectormontecarlo.html">Projector Monte Carlo »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 26 September 2024 10:17">Thursday 26 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
