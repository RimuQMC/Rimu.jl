<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Custom Hamiltonians · Rimu.jl</title><meta name="title" content="Custom Hamiltonians · Rimu.jl"/><meta property="og:title" content="Custom Hamiltonians · Rimu.jl"/><meta property="twitter:title" content="Custom Hamiltonians · Rimu.jl"/><meta name="description" content="Documentation for Rimu.jl."/><meta property="og:description" content="Documentation for Rimu.jl."/><meta property="twitter:description" content="Documentation for Rimu.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Rimu.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Rimu.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Guide</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="generated/BHM-example.html">1D Bose-Hubbard Model</a></li><li><a class="tocitem" href="generated/BHM-example-mpi.html">Rimu with MPI</a></li><li><a class="tocitem" href="generated/G2-example.html">Calculating observables</a></li><li><a class="tocitem" href="generated/exact-example.html">Exact diagonalization</a></li><li><a class="tocitem" href="generated/HO-example.html">Degenerate perturbation theory in a harmonic oscillator basis</a></li></ul></li><li><span class="tocitem">User documentation</span><ul><li><a class="tocitem" href="exactdiagonalization.html">Exact Diagonalization</a></li><li><a class="tocitem" href="projectormontecarlo.html">Projector Monte Carlo</a></li><li><a class="tocitem" href="hamiltonians.html">Hamiltonians</a></li><li><a class="tocitem" href="statstools.html">StatsTools</a></li><li><a class="tocitem" href="mpi.html">Using MPI</a></li><li class="is-active"><a class="tocitem" href="custom_hamiltonians.html">Custom Hamiltonians</a><ul class="internal"><li><a class="tocitem" href="#Operator-type-hierarchy"><span>Operator type hierarchy</span></a></li><li><a class="tocitem" href="#Hamiltonians-interface"><span>Hamiltonians interface</span></a></li><li><a class="tocitem" href="#Operator-and-observable-interface"><span>Operator and observable interface</span></a></li><li><a class="tocitem" href="#Interface-tests"><span>Interface tests</span></a></li><li><a class="tocitem" href="#Utilities-for-harmonic-oscillator-models"><span>Utilities for harmonic oscillator models</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="interfaces.html">Interfaces</a></li><li><a class="tocitem" href="dictvectors.html">Dict vectors</a></li><li><a class="tocitem" href="addresses.html">BitString addresses</a></li><li><a class="tocitem" href="stochasticstyles.html">Stochastic styles</a></li><li><a class="tocitem" href="rimuio.html">I/O</a></li><li><a class="tocitem" href="documentation.html">Documentation generation</a></li><li><a class="tocitem" href="testing.html">Code testing</a></li></ul></li><li><a class="tocitem" href="API.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User documentation</a></li><li class="is-active"><a href="custom_hamiltonians.html">Custom Hamiltonians</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="custom_hamiltonians.html">Custom Hamiltonians</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/RimuQMC/Rimu.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/RimuQMC/Rimu.jl/blob/develop/docs/src/custom_hamiltonians.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-operator-usage-and-custom-Hamiltonians"><a class="docs-heading-anchor" href="#Advanced-operator-usage-and-custom-Hamiltonians">Advanced operator usage and custom Hamiltonians</a><a id="Advanced-operator-usage-and-custom-Hamiltonians-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-operator-usage-and-custom-Hamiltonians" title="Permalink"></a></h1><p><code>Rimu</code> can be used to work with custom Hamiltonians and observables that are user-defined and  not part of the <code>Rimu.jl</code> package. To make this possible and reliable, <code>Rimu</code> exposes a number   of interfaces and provides helper functions to test compliance with the interfaces through the   submodule <a href="custom_hamiltonians.html#Rimu.InterfaceTests"><code>Rimu.InterfaceTests</code></a>, see <a href="custom_hamiltonians.html#Interface-tests">Interface tests</a>. This section covers the  relevant interfaces, the interface functions as well as potentially useful helper functions.</p><p>In order to define custom Hamiltonians or observables it is useful to know how the operator   type hierarchy works in <code>Rimu</code>. For an example of how to implement custom Hamiltonians that   are not part of the <code>Rimu.jl</code> package, see   <a href="https://github.com/RimuQMC/RimuLegacyHamiltonians.jl"><code>RimuLegacyHamiltonians.jl</code></a>.</p><h2 id="Operator-type-hierarchy"><a class="docs-heading-anchor" href="#Operator-type-hierarchy">Operator type hierarchy</a><a id="Operator-type-hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Operator-type-hierarchy" title="Permalink"></a></h2><p><code>Rimu</code> offers a hierarchy of abstract types that define interfaces with different requirements for operators:</p><pre><code class="language-julia hljs">AbstractHamiltonian &lt;: AbstractOperator &lt;: AbstractObservable</code></pre><p>The different abstract types have different requirements and are meant to be used for different purposes. </p><ul><li><a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>s are fully featured models that define a Hilbert space and a linear operator over a scalar field. They can be passed as a Hamiltonian into <a href="projectormontecarlo.html#ProjectorMonteCarloProblem"><code>ProjectorMonteCarloProblem</code></a> or <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a>.</li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a> and <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a> are supertypes of <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> with less stringent conditions. They are useful for defining observables that can be used in a three-way <code>dot</code> product, or passed as observables into a <a href="API.html#Rimu.ReplicaStrategy"><code>ReplicaStrategy</code></a> that can be inserted with the keyword <code>replica_strategy</code> into a <a href="projectormontecarlo.html#ProjectorMonteCarloProblem"><code>ProjectorMonteCarloProblem</code></a>.</li></ul><h2 id="Hamiltonians-interface"><a class="docs-heading-anchor" href="#Hamiltonians-interface">Hamiltonians interface</a><a id="Hamiltonians-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonians-interface" title="Permalink"></a></h2><p>Behind the implementation of a particular model is a more abstract interface for defining Hamiltonians. If you want to define a new model you should make use of this interface. A new  model Hamiltonian should subtype to <code>AbstractHamiltonian</code> and implement the relevant methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.AbstractHamiltonian" href="#Rimu.Interfaces.AbstractHamiltonian"><code>Rimu.Interfaces.AbstractHamiltonian</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractHamiltonian{T} &lt;: AbstractOperator{T}</code></pre><p>Supertype that provides an interface for linear operators over a linear space with scalar type <code>T</code> that are suitable for FCIQMC (with <a href="API.html#Rimu.ProjectorMonteCarloProblem"><code>ProjectorMonteCarloProblem</code></a>). Indexing is done with addresses (typically not integers) from an address space that may be large (and will not need to be completely generated).</p><p><code>AbstractHamiltonian</code> instances operate on vectors of type <a href="dictvectors.html#Rimu.Interfaces.AbstractDVec"><code>AbstractDVec</code></a> from the module <code>DictVectors</code> and work well with addresses of type <a href="addresses.html#Rimu.BitStringAddresses.AbstractFockAddress"><code>AbstractFockAddress</code></a> from the module <code>BitStringAddresses</code>. The type works well with the external package <a href="https://github.com/Jutho/KrylovKit.jl">KrylovKit.jl</a>.</p><p>For available implementations see <a href="hamiltonians.html#Rimu.Hamiltonians"><code>Hamiltonians</code></a>.</p><p><strong>Interface</strong></p><p>Basic interface methods to implement:</p><ul><li><a href="custom_hamiltonians.html#Rimu.Interfaces.starting_address"><code>starting_address(::AbstractHamiltonian)</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.diagonal_element"><code>diagonal_element(::AbstractHamiltonian, address)</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.num_offdiagonals"><code>num_offdiagonals(::AbstractHamiltonian, address)</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.get_offdiagonal"><code>get_offdiagonal(::AbstractHamiltonian, address, chosen::Integer)</code></a> (optional, see   below)</li></ul><p>Optional additional methods to implement:</p><ul><li><a href="custom_hamiltonians.html#Rimu.Interfaces.LOStructure"><code>LOStructure(::Type{typeof(lo)})</code></a>: defaults to <code>AdjointUnknown</code></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.dimension"><code>dimension(::AbstractHamiltonian, addr)</code></a>: defaults to dimension of address space</li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.allows_address_type"><code>allows_address_type(h::AbstractHamiltonian, type)</code></a>: defaults to <code>type :&lt; typeof(starting_address(h))</code></li><li><a href="hamiltonians.html#Rimu.Hamiltonians.momentum"><code>momentum(::AbstractHamiltonian)</code></a>: no default</li></ul><p>Provides the following functions and methods:</p><ul><li><a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a>: iterator over reachable off-diagonal matrix elements</li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.random_offdiagonal"><code>random_offdiagonal</code></a>: function to generate random off-diagonal matrix element</li><li><code>*(H, v)</code>: deterministic matrix-vector multiply (allocating)</li><li><code>H(v)</code>: equivalent to <code>H * v</code>.</li><li><code>mul!(w, H, v)</code>: mutating matrix-vector multiply.</li><li><a href="custom_hamiltonians.html#LinearAlgebra.dot"><code>dot(x, H, v)</code></a>: compute <code>x⋅(H*v)</code> minimizing allocations.</li><li><code>H[address1, address2]</code>: indexing with <code>getindex()</code> - mostly for testing purposes (slow!)</li><li><a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a>: construct a basis set repesentation</li><li><a href="exactdiagonalization.html#SparseArrays.sparse"><code>sparse</code></a>, <a href="exactdiagonalization.html#Base.Matrix"><code>Matrix</code></a>: construct a (sparse) matrix representation</li></ul><p>Alternatively to the above, <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a> can be implemented instead of <a href="custom_hamiltonians.html#Rimu.Interfaces.get_offdiagonal"><code>get_offdiagonal</code></a>. Sometimes this can be done efficiently. In this case <a href="custom_hamiltonians.html#Rimu.Interfaces.num_offdiagonals"><code>num_offdiagonals</code></a> should provide an upper bound on the number of elements obtained when iterating <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a>.</p><p>See also <a href="hamiltonians.html#Rimu.Hamiltonians"><code>Hamiltonians</code></a>, <a href="API.html#Interfaces"><code>Interfaces</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L143-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.offdiagonals" href="#Rimu.Interfaces.offdiagonals"><code>Rimu.Interfaces.offdiagonals</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">offdiagonals(h::AbstractHamiltonian, address)</code></pre><p>Return an iterator over nonzero off-diagonal matrix elements of <code>h</code> in the same column as <code>address</code>. Will iterate over pairs <code>(newaddress, matrixelement)</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; address = BoseFS(3,2,1);


julia&gt; H = HubbardReal1D(address);


julia&gt; h = offdiagonals(H, address)
6-element Rimu.Hamiltonians.Offdiagonals{BoseFS{6, 3, BitString{8, 1, UInt8}}, Float64, HubbardReal1D{Float64, BoseFS{6, 3, BitString{8, 1, UInt8}}, 1.0, 1.0}}:
 (fs&quot;|2 3 1⟩&quot;, -3.0)
 (fs&quot;|2 2 2⟩&quot;, -2.449489742783178)
 (fs&quot;|3 1 2⟩&quot;, -2.0)
 (fs&quot;|4 1 1⟩&quot;, -2.8284271247461903)
 (fs&quot;|4 2 0⟩&quot;, -2.0)
 (fs&quot;|3 3 0⟩&quot;, -1.7320508075688772)</code></pre><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p><p><strong>Extemded help</strong></p><p><code>offdiagonals</code> return and iterator of type <code>&lt;:AbstractOffdiagonals</code>. It defaults to returning <code>Offdiagonals(h, a)</code></p><p>See also <a href="custom_hamiltonians.html#Rimu.Hamiltonians.Offdiagonals"><code>Offdiagonals</code></a>, <a href="custom_hamiltonians.html#Rimu.Hamiltonians.AbstractOffdiagonals"><code>AbstractOffdiagonals</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L308-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.diagonal_element" href="#Rimu.Interfaces.diagonal_element"><code>Rimu.Interfaces.diagonal_element</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diagonal_element(ham, address)</code></pre><p>Compute the diagonal matrix element of the linear operator <code>ham</code> at address <code>address</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; address = BoseFS((3, 2, 1));


julia&gt; H = HubbardMom1D(address);


julia&gt; diagonal_element(H, address)
8.666666666666664</code></pre><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L221-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.starting_address" href="#Rimu.Interfaces.starting_address"><code>Rimu.Interfaces.starting_address</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">starting_address(h)</code></pre><p>Return the starting address for Hamiltonian <code>h</code>. When called on an <code>AbstractMatrix</code>, <code>starting_address</code> returns the index of the lowest diagonal element.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; address = BoseFS((3, 2, 1));


julia&gt; H = HubbardMom1D(address);


julia&gt; address == starting_address(H)
true</code></pre><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L285-L305">source</a></section></article><p>The following functions may be implemented instead of <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.num_offdiagonals" href="#Rimu.Interfaces.num_offdiagonals"><code>Rimu.Interfaces.num_offdiagonals</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">num_offdiagonals(ham, address)</code></pre><p>Compute the number of number of reachable configurations from address <code>address</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; address = BoseFS((3, 2, 1));


julia&gt; H = HubbardMom1D(address);


julia&gt; num_offdiagonals(H, address)
10</code></pre><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L243-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.get_offdiagonal" href="#Rimu.Interfaces.get_offdiagonal"><code>Rimu.Interfaces.get_offdiagonal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">newadd, me = get_offdiagonal(ham, address, chosen)</code></pre><p>Compute value <code>me</code> and new address <code>newadd</code> of a single (off-diagonal) matrix element in a Hamiltonian <code>ham</code>. The off-diagonal element is in the same column as address <code>address</code> and is indexed by integer index <code>chosen</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; addr = BoseFS(3, 2, 1);

julia&gt; H = HubbardMom1D(addr);

julia&gt; get_offdiagonal(H, addr, 3)
(BoseFS{6,3}(2, 1, 3), 1.0)</code></pre><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L264-L282">source</a></section></article><p>The following functions come with default implementations, but may be customized.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.random_offdiagonal" href="#Rimu.Interfaces.random_offdiagonal"><code>Rimu.Interfaces.random_offdiagonal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_offdiagonal(offdiagonals::AbstractOffdiagonals)
random_offdiagonal(ham::AbstractHamiltonian, address)
-&gt; newaddress, probability, matrixelement</code></pre><p>Generate a single random excitation, i.e. choose from one of the accessible off-diagonal elements in the column corresponding to <code>address</code> in the Hamiltonian matrix represented by <code>ham</code>. Alternatively, pass as argument an iterator over the accessible matrix elements.</p><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L350-L360">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.LOStructure" href="#Rimu.Interfaces.LOStructure"><code>Rimu.Interfaces.LOStructure</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LOStructure(op::AbstractHamiltonian)
LOStructure(typeof(op))</code></pre><p>Return information about the structure of the linear operator <code>op</code>. <code>LOStructure</code> is used as a trait to speficy symmetries or other properties of the linear operator <code>op</code> that may simplify or speed up calculations. Implemented instances are:</p><ul><li><code>IsDiagonal()</code>: The operator is diagonal.</li><li><code>IsHermitian()</code>: The operator is complex and Hermitian or real and symmetric.</li><li><code>AdjointKnown()</code>: The operator is not Hermitian, but its   <a href="custom_hamiltonians.html#Base.adjoint"><code>adjoint</code></a> is implemented.</li><li><code>AdjointUnknown()</code>: <a href="custom_hamiltonians.html#Base.adjoint"><code>adjoint</code></a> for this operator is not   implemented.</li></ul><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p><p>In order to define this trait for a new linear operator type, define a method for <code>LOStructure(::Type{&lt;:MyNewLOType}) = …</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L372-L391">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.dimension" href="#Rimu.Hamiltonians.dimension"><code>Rimu.Hamiltonians.dimension</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dimension(h::AbstractHamiltonian, addr=starting_address(h))
dimension(h::AbstractObservable, addr)
dimension(addr::AbstractFockAddress)
dimension(::Type{&lt;:AbstractFockAddress})</code></pre><p>Return the estimated dimension of Hilbert space. May return a <code>BigInt</code> number.</p><p>When called on an address or address type, the dimension of the linear space spanned by the address type is returned. When called on an <code>AbstractHamiltonian</code>, an upper bound on the dimension of the matrix representing the Hamiltonian is returned.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; dimension(OccupationNumberFS(1,2,3))
16777216

julia&gt; dimension(HubbardReal1D(OccupationNumberFS(1,2,3)))
28

julia&gt; dimension(BoseFS{200,100})
1386083821086188248261127842108801860093488668581216236221011219101585442774669540

julia&gt; Float64(ans)
1.3860838210861882e81</code></pre><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface. See also <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a>.</p><p><strong>Extended Help</strong></p><p>The default fallback for <code>dimension</code> called on an <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> is to return the dimension of the address space, which provides an upper bound. For new Hamiltonians a tighter bound can be provided by defining a custom method.</p><p>When extending <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>, define a method for the two-argument form <code>dimension(h::MyNewHamiltonian, addr)</code>. For number-conserving Hamiltonians, the function <a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_dimension"><code>Hamiltonians.number_conserving_dimension</code></a> may be useful.</p><p>When extending <a href="addresses.html#Rimu.BitStringAddresses.AbstractFockAddress"><code>AbstractFockAddress</code></a>, define a method for <code>dimension(::Type{MyNewFockAddress})</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/abstract.jl#L25-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.has_adjoint" href="#Rimu.Interfaces.has_adjoint"><code>Rimu.Interfaces.has_adjoint</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has_adjoint(op)</code></pre><p>Return true if <code>adjoint</code> is defined on <code>op</code>.</p><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.LOStructure"><code>LOStructure</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L410-L418">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.allows_address_type" href="#Rimu.Interfaces.allows_address_type"><code>Rimu.Interfaces.allows_address_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">allows_address_type(operator, addr_or_type)</code></pre><p>Returns <code>true</code> if <code>addr_or_type</code> is a valid address for <code>operator</code>. Otherwise, returns <code>false</code>.</p><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface.</p><p><strong>Extended help</strong></p><p>Defaults to <code>addr_or_type &lt;: typeof(starting_address(operator))</code>. Overload this function if the operator can be used with addresses of different types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L203-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.eltype" href="#Base.eltype"><code>Base.eltype</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eltype(op::AbstractObservable)</code></pre><p>Return the type of the elements of the operator. This can be a vector value. For the underlying scalar type use <a href="custom_hamiltonians.html#VectorInterface.scalartype"><code>scalartype</code></a>.</p><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a> interface.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>New types do not have to implement this method explicitly. An implementation is provided based on the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a>&#39;s type parameter.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L35-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VectorInterface.scalartype" href="#VectorInterface.scalartype"><code>VectorInterface.scalartype</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scalartype(op::AbstractObservable)</code></pre><p>Return the type of the underlying scalar field of the operator. This may be different from the element type of the operator returned by <a href="custom_hamiltonians.html#Base.eltype"><code>eltype</code></a>, which can be a vector value.</p><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a> interface.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>New types do not have to implement this method explicitly. An implementation is provided based on the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a>&#39;s type parameter.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L46-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.mul!" href="#LinearAlgebra.mul!"><code>LinearAlgebra.mul!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearAlgebra.mul!(w::AbstractDVec, op::AbstractOperator, v::AbstractDVec)</code></pre><p>In place multiplication of <code>op</code> with <code>v</code> and storing the result in <code>w</code>. The result is returned. Note that <code>w</code> needs to have a <code>valtype</code> that can hold a product of instances of <code>eltype(op)</code> and <code>valtype(v)</code>. Moreover, the <a href="stochasticstyles.html#Rimu.Interfaces.StochasticStyle"><code>StochasticStyle</code></a> of <code>w</code> needs to be <a href="stochasticstyles.html#Rimu.StochasticStyles.IsDeterministic"><code>&lt;:IsDeterministic</code></a>.</p><p>Part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a> interface.</p><p>The default implementation relies of <a href="custom_hamiltonians.html#Rimu.Interfaces.diagonal_element"><code>diagonal_element</code></a> and <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a> to access the elements of the operator. The function can be overloaded for custom operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L112-L123">source</a></section></article><p>This interface relies on unexported functionality, including</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.adjoint" href="#Base.adjoint"><code>Base.adjoint</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adjoint(::LOStructure, op::AbstractObservable)</code></pre><p>Represent the adjoint of an <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a>. Extend this method to define custom adjoints.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/abstract.jl#L226-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.dot" href="#LinearAlgebra.dot"><code>LinearAlgebra.dot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dot(w, op::AbstractObservable, v)</code></pre><p>Evaluate <code>w⋅op(v)</code> minimizing memory allocations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L126-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.AbstractOffdiagonals" href="#Rimu.Hamiltonians.AbstractOffdiagonals"><code>Rimu.Hamiltonians.AbstractOffdiagonals</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractOffdiagonals{A,T}&lt;:AbstractVector{Tuple{A,T}}</code></pre><p>Iterator over new address and matrix elements for reachable off-diagonal matrix elements of a linear operator.</p><p>See <a href="custom_hamiltonians.html#Rimu.Hamiltonians.Offdiagonals"><code>Offdiagonals</code></a> for a default implementation.</p><p><strong>Methods to define</strong></p><ul><li><a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals(h, a)::AbstractOffdiagonals</code></a>: This function is used to construct the correct type of offdiagonals for a given combination of Hamiltonian <code>h</code> and Fock address <code>a</code>.</li><li><code>Base.getindex(::AbstractOffdiagonals, i)</code>: should be equivalent to <code>get_offdiagonal(h, a, i)</code>.</li><li><code>Base.size(::AbstractOffdiagonals)</code>: should be equivalent to <code>num_offdiagonals(h, a)</code>.</li></ul><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/offdiagonals.jl#L4-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.Offdiagonals" href="#Rimu.Hamiltonians.Offdiagonals"><code>Rimu.Hamiltonians.Offdiagonals</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Offdiagonals(h, address) &lt;: AbstractOffdiagonals</code></pre><p>Iterator over new address and matrix element for reachable off-diagonal matrix elements of linear operator <code>h</code> from address <code>address</code>.  Represents an abstract vector containing the non-zero off-diagonal matrix elements of the column of <code>h</code> indexed by <code>address</code>. To construct this iterator use <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a>.</p><p>This is the default implementation of <a href="custom_hamiltonians.html#Rimu.Hamiltonians.AbstractOffdiagonals"><code>AbstractOffdiagonals</code></a> defined in terms of <a href="custom_hamiltonians.html#Rimu.Interfaces.num_offdiagonals"><code>num_offdiagonals</code></a> and <a href="custom_hamiltonians.html#Rimu.Interfaces.get_offdiagonal"><code>get_offdiagonal</code></a>.</p><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/offdiagonals.jl#L29-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.check_address_type" href="#Rimu.Hamiltonians.check_address_type"><code>Rimu.Hamiltonians.check_address_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_address_type(h::AbstractObservable, addr_or_type)</code></pre><p>Throw an <code>ArgumentError</code> if <code>addr_or_type</code> is not compatible with <code>h</code>, otherwise return <code>true</code>. Acceptable arguments are either an address or an address type, or a tuple or array thereof.</p><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.allows_address_type"><code>allows_address_type</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/abstract.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.number_conserving_dimension" href="#Rimu.Hamiltonians.number_conserving_dimension"><code>Rimu.Hamiltonians.number_conserving_dimension</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">number_conserving_dimension(address &lt;: AbstractFockAddress)</code></pre><p>Return the dimension of the Fock space spanned by the address type assuming particle number conservation.</p><p>See also <a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_bose_dimension"><code>number_conserving_bose_dimension</code></a>, <a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_fermi_dimension"><code>number_conserving_fermi_dimension</code></a>, <a href="custom_hamiltonians.html#Rimu.Hamiltonians.dimension"><code>dimension</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/abstract.jl#L121-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.number_conserving_bose_dimension" href="#Rimu.Hamiltonians.number_conserving_bose_dimension"><code>Rimu.Hamiltonians.number_conserving_bose_dimension</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">number_conserving_bose_dimension(n, m)</code></pre><p>Return the dimension of the number-conserving Fock space for <code>n</code> bosons in <code>m</code> modes: <code>binomial(n + m - 1, n)</code>.</p><p>See also <a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_fermi_dimension"><code>number_conserving_fermi_dimension</code></a>, <a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_dimension"><code>number_conserving_dimension</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/abstract.jl#L102-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.number_conserving_fermi_dimension" href="#Rimu.Hamiltonians.number_conserving_fermi_dimension"><code>Rimu.Hamiltonians.number_conserving_fermi_dimension</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">number_conserving_fermi_dimension(n, m)</code></pre><p>Return the dimension of the number-conserving Fock space for <code>n</code> fermions in <code>m</code> modes: <code>binomial(m, n)</code>.</p><p>See also <a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_bose_dimension"><code>number_conserving_bose_dimension</code></a>, <a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_dimension"><code>number_conserving_dimension</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/abstract.jl#L111-L118">source</a></section></article><h2 id="Operator-and-observable-interface"><a class="docs-heading-anchor" href="#Operator-and-observable-interface">Operator and observable interface</a><a id="Operator-and-observable-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Operator-and-observable-interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.AbstractObservable" href="#Rimu.Interfaces.AbstractObservable"><code>Rimu.Interfaces.AbstractObservable</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractObservable{T}</code></pre><p>Most permissive supertype for operators in the type hierarchy:</p><pre><code class="nohighlight hljs">AbstractHamiltonian{T} &lt;: AbstractOperator{T} &lt;: AbstractObservable{T}</code></pre><p><code>AbstractObservable</code> provides an interface for operators that can appear in a three-way dot product <a href="custom_hamiltonians.html#LinearAlgebra.dot"><code>dot(x, op, y)</code></a> with two vectors of type <a href="dictvectors.html#Rimu.Interfaces.AbstractDVec"><code>AbstractDVec</code></a>. The result is a value of type <code>T</code>, which is also returned by the <a href="custom_hamiltonians.html#Base.eltype"><code>eltype</code></a> function. This may be a vector type associated with a scalar type returned by the <a href="custom_hamiltonians.html#VectorInterface.scalartype"><code>scalartype</code></a> function.</p><p>The <code>AbstractObservable</code> type is useful for defining observables that can be calculated in the context of a <a href="projectormontecarlo.html#ProjectorMonteCarloProblem"><code>ProjectorMonteCarloProblem</code></a> using <a href="hamiltonians.html#Rimu.Hamiltonians"><code>AllOverlaps</code></a>.</p><p><strong>Interface</strong></p><p>Basic interface methods to implement:</p><ul><li><a href="dictvectors.html#Rimu.Interfaces.dot_from_right"><code>Interfaces.dot_from_right(x, op, y)</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.allows_address_type"><code>allows_address_type(op, type)</code></a></li></ul><p>Optional additional methods to implement:</p><ul><li><a href="custom_hamiltonians.html#VectorInterface.scalartype"><code>VectorInterface.scalartype(op)</code></a>: defaults to <code>eltype(eltype(op))</code></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.LOStructure"><code>LOStructure(::Type{typeof(op)})</code></a>: defaults to <code>AdjointUnknown</code></li></ul><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>, <a href="API.html#Interfaces"><code>Interfaces</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L4-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Interfaces.AbstractOperator" href="#Rimu.Interfaces.AbstractOperator"><code>Rimu.Interfaces.AbstractOperator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractOperator{T} &lt;: AbstractObservable{T}</code></pre><p>Supertype that provides an interface for linear operators over a linear space with elements of type <code>T</code> (returned by <a href="custom_hamiltonians.html#Base.eltype"><code>eltype</code></a>) and general (custom type) indices called &#39;addresses&#39;.</p><p><code>AbstractOperator</code> instances operate on vectors of type <a href="dictvectors.html#Rimu.Interfaces.AbstractDVec"><code>AbstractDVec</code></a> from the module <code>DictVectors</code> and work well with addresses of type <a href="addresses.html#Rimu.BitStringAddresses.AbstractFockAddress"><code>AbstractFockAddress</code></a> from the module <code>BitStringAddresses</code>.</p><p>The defining feature of an <code>AbstractOperator</code> is that it can be applied to a vector with <a href="custom_hamiltonians.html#LinearAlgebra.mul!"><code>mul!(y, op, x)</code></a> and that three-way dot products can be calculated with <a href="custom_hamiltonians.html#LinearAlgebra.dot"><code>dot(x, op, y)</code></a>.</p><p>The <code>AbstractOperator</code> type is useful for defining operators that are not necessarily Hamiltonians, but that can be used in the context of a <a href="projectormontecarlo.html#ProjectorMonteCarloProblem"><code>ProjectorMonteCarloProblem</code></a> as observable operators in a <a href="API.html#Rimu.ReplicaStrategy"><code>ReplicaStrategy</code></a>, e.g. for defining correlation functions. In contrast to <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>s, <code>AbstractOperator</code>s do not need to have a <a href="custom_hamiltonians.html#Rimu.Interfaces.starting_address"><code>starting_address</code></a>. Moreover, the <code>eltype</code> of an <code>AbstractOperator</code> can be a vector value whereas <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>s requre a scalar <code>eltype</code>.</p><pre><code class="nohighlight hljs">AbstractHamiltonian{T} &lt;: AbstractOperator{T} &lt;: AbstractObservable{T}</code></pre><p>The <code>AbstractOperator</code> type is part of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a> hierarchy. It is more restrictive than <code>AbstractObservable</code> in that it requires the interface for the generation of diagonal and off-diagonal elements.</p><p>For concrete implementations see <a href="hamiltonians.html#Rimu.Hamiltonians"><code>Hamiltonians</code></a>. In order to implement a Hamiltonian for use in <a href="projectormontecarlo.html#ProjectorMonteCarloProblem"><code>ProjectorMonteCarloProblem</code></a> or <a href="exactdiagonalization.html#ExactDiagonalizationProblem"><code>ExactDiagonalizationProblem</code></a> use the type <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> instead.</p><p><strong>Interface</strong></p><p>Basic interface methods to implement:</p><ul><li><a href="custom_hamiltonians.html#Rimu.Interfaces.allows_address_type"><code>allows_address_type(op, type)</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.diagonal_element"><code>diagonal_element(op, address)</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.num_offdiagonals"><code>num_offdiagonals(op, address)</code></a> and</li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.get_offdiagonal"><code>get_offdiagonal(op, address, chosen)</code></a> or <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a></li></ul><p>Optional additional methods to implement:</p><ul><li><a href="custom_hamiltonians.html#VectorInterface.scalartype"><code>VectorInterface.scalartype(op)</code></a>: defaults to <code>eltype(eltype(op))</code></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.LOStructure"><code>LOStructure(::Type{typeof(op)})</code></a>: defaults to <code>AdjointUnknown</code></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.dimension"><code>dimension(op, addr)</code></a>: defaults to dimension of address space</li></ul><p>In order to calculate observables efficiently, it may make sense to implement custom methods for <a href="dictvectors.html#Rimu.Interfaces.dot_from_right"><code>Interfaces.dot_from_right(x, op, y)</code></a> and <a href="custom_hamiltonians.html#LinearAlgebra.mul!"><code>LinearAlgebra.mul!(y, op, x)</code></a>.</p><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a>, <a href="API.html#Interfaces"><code>Interfaces</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Interfaces/hamiltonians.jl#L57-L109">source</a></section></article><h2 id="Interface-tests"><a class="docs-heading-anchor" href="#Interface-tests">Interface tests</a><a id="Interface-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Interface-tests" title="Permalink"></a></h2><p>Helper functions that can be used for testing the various interfaces are provided in the  (unexported) submodule <code>Rimu.InterfaceTests</code>. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.InterfaceTests" href="#Rimu.InterfaceTests"><code>Rimu.InterfaceTests</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The module <code>Rimu.InterfaceTests</code> provides functions to test compliance with the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a>, <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a>, and <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interfaces. Load the module with <code>using Rimu.InterfaceTests</code>.</p><p>The module exports the following functions:</p><ul><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_observable_interface"><code>test_observable_interface</code></a></li><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_operator_interface"><code>test_operator_interface</code></a></li><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_hamiltonian_interface"><code>test_hamiltonian_interface</code></a></li><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_hamiltonian_structure"><code>test_hamiltonian_structure</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/InterfaceTests.jl#L1-L11">source</a></section></article><h3 id="Testing-functions"><a class="docs-heading-anchor" href="#Testing-functions">Testing functions</a><a id="Testing-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.InterfaceTests.test_hamiltonian_interface" href="#Rimu.InterfaceTests.test_hamiltonian_interface"><code>Rimu.InterfaceTests.test_hamiltonian_interface</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">test_hamiltonian_interface(h, addr=starting_address(h); test_spawning=true)</code></pre><p>The main purpose of this test function is to check that all required methods of the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>AbstractHamiltonian</code></a> interface are defined and work as expected.</p><p>Set <code>test_spawning=false</code> to skip tests that require <a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>offdiagonals</code></a> to return an <code>AbstractVector</code>.</p><p>This function also tests the following properties of the Hamiltonian:</p><ul><li><code>dimension(h) ≥ dimension(h, addr)</code></li><li><code>scalartype(h) === eltype(h)</code></li><li>Hamiltonian action on a vector &lt;: <code>AbstractDVec</code></li><li><code>starting_address</code> returns an <a href="custom_hamiltonians.html#Rimu.Interfaces.allows_address_type"><code>allows_address_type</code></a> address</li><li><code>LOStructure</code> is one of <code>IsDiagonal</code>, <code>IsHermitian</code>, <code>AdjointKnown</code></li><li>the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a> interface is tested</li><li>the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a> interface is tested</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-doctest hljs">julia&gt; using Rimu.InterfaceTests

julia&gt; test_hamiltonian_interface(HubbardRealSpace(BoseFS(2,0,3,1)));
Test Summary:                          | Pass  Total  Time
Observable interface: HubbardRealSpace |    4      4  0.0s
Test Summary:       | Pass  Total  Time
allows_address_type |    1      1  0.0s
Test Summary:                        | Pass  Total  Time
Operator interface: HubbardRealSpace |    9      9  0.0s
Test Summary:       | Pass  Total  Time
allows_address_type |    1      1  0.0s
Test Summary:                                 | Pass  Total  Time
Hamiltonians-only tests with HubbardRealSpace |    6      6  0.0s</code></pre><p>See also <a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_operator_interface"><code>test_operator_interface</code></a>, <a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_observable_interface"><code>test_observable_interface</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/InterfaceTests.jl#L158-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.InterfaceTests.test_hamiltonian_structure" href="#Rimu.InterfaceTests.test_hamiltonian_structure"><code>Rimu.InterfaceTests.test_hamiltonian_structure</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">test_hamiltonian_structure(h::AbstractHamiltonian; sizelim=20)</code></pre><p>Test the <code>LOStructure</code> of a small Hamiltonian <code>h</code> by instantiating it as a sparse matrix and checking whether the structure of the matrix is constistent with the result of <code>LOStructure(h)</code> and the <code>eltype</code> is consistent with <code>eltype(h)</code>.</p><p>This function is intended to be used in automated test for small Hamiltonians where instantiating the matrix is quick. A warning will print if the dimension of the Hamiltonian is larger than <code>20</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-doctest hljs">julia&gt; using Rimu.InterfaceTests

julia&gt; test_hamiltonian_structure(HubbardRealSpace(BoseFS(2,0,1)));
Test Summary: | Pass  Total  Time
structure     |    4      4  0.0s</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/InterfaceTests.jl#L241-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.InterfaceTests.test_observable_interface" href="#Rimu.InterfaceTests.test_observable_interface"><code>Rimu.InterfaceTests.test_observable_interface</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">test_observable_interface(obs, addr)</code></pre><p>This function tests compliance with the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a> interface for an observable <code>obs</code> at address <code>addr</code> (typically <a href="addresses.html#Rimu.BitStringAddresses.AbstractFockAddress"><code>&lt;: AbstractFockAddress</code></a>) by checking that all required methods are defined.</p><p>The following properties are tested:</p><ul><li><code>dot(v, obs, v)</code> returns a value of the same type as the <code>eltype</code> of the observable</li><li><code>LOStructure</code> is set consistently</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-doctest hljs">julia&gt; using Rimu.InterfaceTests

julia&gt; test_observable_interface(ReducedDensityMatrix(2), FermiFS(1,0,1,1));
Test Summary:                              | Pass  Total  Time
Observable interface: ReducedDensityMatrix |    4      4  0.0s</code></pre><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a>, <a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_operator_interface"><code>test_operator_interface</code></a>, <a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_hamiltonian_interface"><code>test_hamiltonian_interface</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/InterfaceTests.jl#L26-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.InterfaceTests.test_operator_interface" href="#Rimu.InterfaceTests.test_operator_interface"><code>Rimu.InterfaceTests.test_operator_interface</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">test_operator_interface(op, addr; test_spawning=true)</code></pre><p>This function tests compliance with the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a> interface for an operator <code>op</code> at address <code>addr</code> (typically <a href="addresses.html#Rimu.BitStringAddresses.AbstractFockAddress"><code>&lt;: AbstractFockAddress</code></a>) by checking that all required methods are defined.</p><p>If <code>test_spawning</code> is <code>true</code>, tests are performed that require <code>offdiagonals</code> to return an <code>Hamiltonians.AbstractOffDiagonals</code>, which is a prerequisite for using the <code>spawn!</code> function. Otherwise, the spawning tests are skipped.</p><p>The following properties are tested:</p><ul><li><code>diagonal_element</code> returns a value of the same type as the <code>eltype</code> of the operator</li><li><code>offdiagonals</code> behaves like an <code>AbstractVector</code></li><li><code>num_offdiagonals</code> returns the correct number of offdiagonals</li><li><code>random_offdiagonal</code> returns a tuple with the correct types</li><li><code>mul!</code> and <code>dot</code> work as expected</li><li><code>dimension</code> returns a consistent value</li><li>the <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>AbstractObservable</code></a> interface is tested</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-doctest hljs">julia&gt; using Rimu.InterfaceTests

julia&gt; test_operator_interface(SuperfluidCorrelator(3), BoseFS(1, 2, 3, 1));
Test Summary:                              | Pass  Total  Time
Observable interface: SuperfluidCorrelator |    4      4  0.0s
Test Summary:       | Pass  Total  Time
allows_address_type |    1      1  0.0s
Test Summary:                            | Pass  Total  Time
Operator interface: SuperfluidCorrelator |    9      9  0.0s</code></pre><p>See also <a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>AbstractOperator</code></a>, <a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_observable_interface"><code>test_observable_interface</code></a>, <a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_hamiltonian_interface"><code>test_hamiltonian_interface</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/InterfaceTests.jl#L78-L114">source</a></section></article><h2 id="Utilities-for-harmonic-oscillator-models"><a class="docs-heading-anchor" href="#Utilities-for-harmonic-oscillator-models">Utilities for harmonic oscillator models</a><a id="Utilities-for-harmonic-oscillator-models-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities-for-harmonic-oscillator-models" title="Permalink"></a></h2><p>Useful utilities for harmonic oscillator in Cartesian basis, see <a href="hamiltonians.html#Rimu.Hamiltonians.HOCartesianContactInteractions"><code>HOCartesianContactInteractions</code></a> and <a href="hamiltonians.html#Rimu.Hamiltonians.HOCartesianEnergyConservedPerDim"><code>HOCartesianEnergyConservedPerDim</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.get_all_blocks" href="#Rimu.Hamiltonians.get_all_blocks"><code>Rimu.Hamiltonians.get_all_blocks</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_all_blocks(h::Union{HOCartesianContactInteractions,HOCartesianEnergyConservedPerDim};
    target_energy = nothing,
    max_energy = nothing,
    max_blocks = nothing,
    method = :vertices,
    kwargs...) -&gt; df</code></pre><p>Find all distinct blocks of <code>h</code>. Returns a <code>DataFrame</code> with columns</p><ul><li><code>block_id</code>: index of block in order found</li><li><code>block_E0</code>: noninteracting energy of all elements in the block</li><li><code>block_size</code>: number of elements in the block</li><li><code>addr</code>: first address that generates the block with e.g. <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a></li><li><code>indices</code>: tuple of mode indices that allow recreation of the generating address   <code>addr</code>; in this case use e.g. <code>BoseFS(M; indices .=&gt; 1)</code> This is useful when   the <code>DataFrame</code> is loaded from file since <code>Arrow.jl</code> converts custom   types to <code>NamedTuple</code>s.</li><li><code>t_basis</code>: time to generate the basis for each block</li></ul><p>Keyword arguments:</p><ul><li><code>target_energy</code>: only blocks with this noninteracting energy are found</li><li><code>max_energy</code>: only blocks with noninteracting energy less than this are found</li><li><code>max_blocks</code>: exit after finding this many blocks</li><li><code>method</code>: Choose between <code>:vertices</code> and <code>:comb</code> for method of enumerating   tuples of quantum numbers</li><li><code>save_to_file=nothing</code>: if set then the <code>DataFrame</code> recording blocks is saved   after each new block is found</li><li>additional <code>kwargs</code>: passed to <code>isapprox</code> for comparing block energies.   Useful for anisotropic traps</li></ul><p>Note: If <code>h</code> was constructed with option <code>block_by_level = false</code> then the block seeds <code>addr</code> are determined by parity. In this case the blocks are not generated; <code>t_basis</code> will be zero, and <code>block_size</code> will be an estimate. Pass the seed addresses to <a href="exactdiagonalization.html#Rimu.ExactDiagonalization.BasisSetRepresentation"><code>BasisSetRepresentation</code></a> with an appropriate <code>filter</code> to generate the blocks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/ho-cart-tools.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.fock_to_cart" href="#Rimu.Hamiltonians.fock_to_cart"><code>Rimu.Hamiltonians.fock_to_cart</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fock_to_cart(addr, S; zero_index = true)</code></pre><p>Convert a Fock state address <code>addr</code> to Cartesian harmonic oscillator basis indices <span>$n_x,n_y,\ldots$</span>. These indices are bounded by <code>S</code> which is a tuple of the maximum number of states in each dimension. By default the groundstate in each dimension is indexed by <code>0</code>, but this can be changed by setting <code>zero_index = false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/ho-cart-tools.jl#L211-L219">source</a></section></article><p>Underlying integrals for the interaction matrix elements are implemented in the following unexported functions</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.four_oscillator_integral_general" href="#Rimu.Hamiltonians.four_oscillator_integral_general"><code>Rimu.Hamiltonians.four_oscillator_integral_general</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">four_oscillator_integral_general(i, j, k, l; max_level = typemax(Int))</code></pre><p>Integral of four one-dimensional harmonic oscillator functions,</p><p class="math-container">\[    \mathcal{I}(i,j,k,l) = \int_{-\infty}^\infty dx \,
    \phi_i(x) \phi_j(x) \phi_k(x) \phi_l(x)\]</p><p>Indices <code>i,j,k,l</code> start at <code>0</code> for the groundstate.</p><p>This integral has a closed form in terms of the hypergeometric <span>$_{3}F_2$</span> function, and is non-zero unless <span>$i+j+k+l$</span> is odd. See e.g. <a href="https://doi.org/10.1112/jlms/s1-23.1.15">Titchmarsh (1948)</a>. This is a generalisation of the closed form in <a href="https://doi.org/10.1103/PhysRevA.65.033606">Papenbrock (2002)</a>, which is is the special case where <span>$i+j == k+l$</span>, but is numerically unstable for large arguments. Used in <a href="hamiltonians.html#Rimu.Hamiltonians.HOCartesianContactInteractions"><code>HOCartesianContactInteractions</code></a> and <a href="hamiltonians.html#Rimu.Hamiltonians.HOCartesianEnergyConservedPerDim"><code>HOCartesianEnergyConservedPerDim</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/HOCartesianContactInteractions.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.ho_delta_potential" href="#Rimu.Hamiltonians.ho_delta_potential"><code>Rimu.Hamiltonians.ho_delta_potential</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ho_delta_potential(S, i, j; [vals])</code></pre><p>Returns the matrix element of a delta potential at the centre of a trap, i.e. the  product of two harmonic oscillator functions evaluated at the origin,</p><p class="math-container">\[    v_{ij} = \phi_{\mathbf{n}_i}(0) \phi_{\mathbf{n}_j}(0)\]</p><p>which is only non-zero for even-parity states. The <code>i</code>th single particle state corresponds to a <span>$D$</span>-tuple of harmonic oscillator indices <span>$\mathbf{n}_i$</span>. <code>S</code> defines the bounds of Cartesian harmonic oscillator indices for each dimension. The optional keyword argument <code>vals</code> allows passing pre-computed values of <span>$\phi_i(0)$</span> to speed-up the calculation. The values can be calculated with <a href="custom_hamiltonians.html#Rimu.Hamiltonians.log_abs_oscillator_zero"><code>log_abs_oscillator_zero</code></a>.</p><p>See also <a href="hamiltonians.html#Rimu.Hamiltonians.HOCartesianCentralImpurity"><code>HOCartesianCentralImpurity</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/HOCartesianCentralImpurity.jl#L16-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Rimu.Hamiltonians.log_abs_oscillator_zero" href="#Rimu.Hamiltonians.log_abs_oscillator_zero"><code>Rimu.Hamiltonians.log_abs_oscillator_zero</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">log_abs_oscillator_zero(n)</code></pre><p>Compute the logarithm of the absolute value of the <span>$n^\mathrm{th}$</span> 1D harmonic oscillator function evaluated at the origin. The overall sign is determined when the matrix element is evaluated in <a href="custom_hamiltonians.html#Rimu.Hamiltonians.ho_delta_potential"><code>ho_delta_potential</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RimuQMC/Rimu.jl/blob/754b3fba9e3730e56f69333ef8bb68a0c161d713/src/Hamiltonians/HOCartesianCentralImpurity.jl#L1-L7">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests"><code>Rimu.InterfaceTests</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.AbstractOffdiagonals"><code>Rimu.Hamiltonians.AbstractOffdiagonals</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.Offdiagonals"><code>Rimu.Hamiltonians.Offdiagonals</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractHamiltonian"><code>Rimu.Interfaces.AbstractHamiltonian</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractObservable"><code>Rimu.Interfaces.AbstractObservable</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.AbstractOperator"><code>Rimu.Interfaces.AbstractOperator</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.LOStructure"><code>Rimu.Interfaces.LOStructure</code></a></li><li><a href="custom_hamiltonians.html#Base.adjoint"><code>Base.adjoint</code></a></li><li><a href="custom_hamiltonians.html#Base.eltype"><code>Base.eltype</code></a></li><li><a href="custom_hamiltonians.html#LinearAlgebra.dot"><code>LinearAlgebra.dot</code></a></li><li><a href="custom_hamiltonians.html#LinearAlgebra.mul!"><code>LinearAlgebra.mul!</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.check_address_type"><code>Rimu.Hamiltonians.check_address_type</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.dimension"><code>Rimu.Hamiltonians.dimension</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.fock_to_cart"><code>Rimu.Hamiltonians.fock_to_cart</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.four_oscillator_integral_general"><code>Rimu.Hamiltonians.four_oscillator_integral_general</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.get_all_blocks"><code>Rimu.Hamiltonians.get_all_blocks</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.ho_delta_potential"><code>Rimu.Hamiltonians.ho_delta_potential</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.log_abs_oscillator_zero"><code>Rimu.Hamiltonians.log_abs_oscillator_zero</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_bose_dimension"><code>Rimu.Hamiltonians.number_conserving_bose_dimension</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_dimension"><code>Rimu.Hamiltonians.number_conserving_dimension</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Hamiltonians.number_conserving_fermi_dimension"><code>Rimu.Hamiltonians.number_conserving_fermi_dimension</code></a></li><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_hamiltonian_interface"><code>Rimu.InterfaceTests.test_hamiltonian_interface</code></a></li><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_hamiltonian_structure"><code>Rimu.InterfaceTests.test_hamiltonian_structure</code></a></li><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_observable_interface"><code>Rimu.InterfaceTests.test_observable_interface</code></a></li><li><a href="custom_hamiltonians.html#Rimu.InterfaceTests.test_operator_interface"><code>Rimu.InterfaceTests.test_operator_interface</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.allows_address_type"><code>Rimu.Interfaces.allows_address_type</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.diagonal_element"><code>Rimu.Interfaces.diagonal_element</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.get_offdiagonal"><code>Rimu.Interfaces.get_offdiagonal</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.has_adjoint"><code>Rimu.Interfaces.has_adjoint</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.num_offdiagonals"><code>Rimu.Interfaces.num_offdiagonals</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.offdiagonals"><code>Rimu.Interfaces.offdiagonals</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.random_offdiagonal"><code>Rimu.Interfaces.random_offdiagonal</code></a></li><li><a href="custom_hamiltonians.html#Rimu.Interfaces.starting_address"><code>Rimu.Interfaces.starting_address</code></a></li><li><a href="custom_hamiltonians.html#VectorInterface.scalartype"><code>VectorInterface.scalartype</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="mpi.html">« Using MPI</a><a class="docs-footer-nextpage" href="interfaces.html">Interfaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 6 January 2025 23:31">Monday 6 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
