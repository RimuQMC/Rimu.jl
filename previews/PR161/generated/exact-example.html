<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Exact diagonalisation · Rimu.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="Rimu.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Rimu.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Guide</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="BHM-example.html">1D Bose-Hubbard Model</a></li><li><a class="tocitem" href="BHM-example-mpi.html">Rimu with MPI</a></li><li><a class="tocitem" href="G2-example.html">Calculating observables</a></li><li class="is-active"><a class="tocitem" href="exact-example.html">Exact diagonalisation</a><ul class="internal"><li><a class="tocitem" href="#Preliminaries"><span>Preliminaries</span></a></li><li><a class="tocitem" href="#The-BasisSetRep"><span>The BasisSetRep</span></a></li><li><a class="tocitem" href="#Computing-eigenvalues"><span>Computing eigenvalues</span></a></li><li><a class="tocitem" href="#Reducing-matrix-size-with-symmetries"><span>Reducing matrix size with symmetries</span></a></li><li><a class="tocitem" href="#Computing-observables"><span>Computing observables</span></a></li></ul></li></ul></li><li><span class="tocitem">User documentation</span><ul><li><a class="tocitem" href="../statstools.html">StatsTools</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../interfaces.html">Interfaces</a></li><li><a class="tocitem" href="../hamiltonians.html">Hamiltonians</a></li><li><a class="tocitem" href="../dictvectors.html">Dict vectors</a></li><li><a class="tocitem" href="../addresses.html">BitString addresses</a></li><li><a class="tocitem" href="../stochasticstyles.html">Stochastic styles</a></li><li><a class="tocitem" href="../RMPI.html">RMPI</a></li><li><a class="tocitem" href="../consistentrng.html">Random Numbers</a></li><li><a class="tocitem" href="../rimuio.html">I/O</a></li><li><a class="tocitem" href="../documentation.html">Documentation generation</a></li><li><a class="tocitem" href="../testing.html">Code testing</a></li></ul></li><li><a class="tocitem" href="../API.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="exact-example.html">Exact diagonalisation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="exact-example.html">Exact diagonalisation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/joachimbrand/Rimu.jl/blob/develop/scripts/exact-example.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-4:-Exact-diagonalisation"><a class="docs-heading-anchor" href="#Example-4:-Exact-diagonalisation">Example 4: Exact diagonalisation</a><a id="Example-4:-Exact-diagonalisation-1"></a><a class="docs-heading-anchor-permalink" href="#Example-4:-Exact-diagonalisation" title="Permalink"></a></h1><p>When working with smaller systems, or when multiple eigenvalues of a system are required, it&#39;s better to work with an exact diagonalization method. There are a few ways to go about this, each with its pros and cons. The purpose of this tutorial is to show off the methods as well as provide a few tips regarding them.</p><p>A runnable script for this example is located <a href="https://github.com/joachimbrand/Rimu.jl/blob/develop/scripts/exact-example.jl">here</a>. Run it with <code>julia exact-example.jl</code>.</p><p>We start by loading the required modules.</p><pre><code class="language-julia hljs">using Rimu
using LinearAlgebra # eigen, eigvals, and eigvecs
using Arpack        # eigs
using KrylovKit     # eigsolve
using LaTeXStrings</code></pre><h2 id="Preliminaries"><a class="docs-heading-anchor" href="#Preliminaries">Preliminaries</a><a id="Preliminaries-1"></a><a class="docs-heading-anchor-permalink" href="#Preliminaries" title="Permalink"></a></h2><p>In this example, we will look at a system of 6 particles in 7 sites, formulated in real space. Let&#39;s start by building the Hamiltonian. To create a momentum Fock state, we put all the particles in the middle of the address, as that corresponds to the zero momentum mode.</p><pre><code class="language-julia hljs">M = 7
N = 4
add = BoseFS(M, cld(M, 2) =&gt; N)
ham = HubbardMom1D(add)</code></pre><pre><code class="nohighlight hljs">HubbardMom1D(BoseFS{4,7}((0, 0, 0, 4, 0, 0, 0)); u=1.0, t=1.0)</code></pre><p>Before doing exact diagonalisation, it is a good idea to check the dimensionality of the Hamiltonian.</p><pre><code class="language-julia hljs">dimension(ham)</code></pre><pre><code class="nohighlight hljs">210</code></pre><p>Keep in mind that this is an estimate on the number of Fock states the Hamiltonian can act on, not the actual matrix size, but it can be used as a guide to decide whether a Hamiltonian is amenable to exact diagonalisation and which algorithm would be best suited to diagonalising it.</p><h2 id="The-BasisSetRep"><a class="docs-heading-anchor" href="#The-BasisSetRep">The BasisSetRep</a><a id="The-BasisSetRep-1"></a><a class="docs-heading-anchor-permalink" href="#The-BasisSetRep" title="Permalink"></a></h2><p>As we&#39;ll see later, there are two ways to construct the matrices from Hamiltonians directly, but they both use <code>BasisSetRep</code> under the hood. The <code>BasisSetRep</code>, when called with a Hamiltonian and optionally a starting address, constructs the sparse matrix of the system and its basis. The starting address defaults to the one that was used to initialize the Hamiltonian. <code>BasisSetRep</code> only returns the part of the matrix that is accessible from this starting address through non-zero offdiagonal elements.</p><pre><code class="language-julia hljs">bsr = BasisSetRep(ham);</code></pre><p>To access the matrix or basis, access the <code>sm</code> and <code>basis</code> fields, respectively.</p><pre><code class="language-julia hljs">bsr.sm</code></pre><pre><code class="nohighlight hljs">30×30 SparseArrays.SparseMatrixCSC{Float64, Int64} with 366 stored entries:
⣿⣿⢶⡲⣖⠲⣢⡤⣄⠀⠀⠀⠀⠀⠀
⢸⡳⢿⢗⣕⣙⢶⠃⠢⠻⠝⢒⢢⢄⡀
⢸⡙⣕⢹⡛⣬⡏⢃⡑⢤⣑⣐⢊⠩⣏
⠈⡾⠼⠓⠯⢉⢑⣴⡏⠙⡭⣚⠘⠈⢥
⠀⠙⣬⡂⠑⣌⣏⠉⡛⣬⡹⡈⢛⠃⠁
⠀⠀⢳⢁⢑⢸⣣⢫⡓⠪⠛⣤⣂⠁⡊
⠀⠀⠈⢖⡎⡐⡒⠀⠿⠐⠌⠘⢱⢖⡀
⠀⠀⠀⠈⠋⠙⠁⠓⠁⠀⠊⠈⠀⠈⠛</code></pre><pre><code class="language-julia hljs">bsr.basis</code></pre><pre><code class="nohighlight hljs">30-element Vector{BoseFS{4, 7, BitString{10, 1, UInt16}}}:
 fs&quot;|0 0 0 4 0 0 0⟩&quot;
 fs&quot;|0 0 1 2 1 0 0⟩&quot;
 fs&quot;|0 1 0 2 0 1 0⟩&quot;
 fs&quot;|1 0 0 2 0 0 1⟩&quot;
 fs&quot;|0 1 0 1 2 0 0⟩&quot;
 fs&quot;|1 0 0 1 1 1 0⟩&quot;
 fs&quot;|0 0 0 1 1 0 2⟩&quot;
 fs&quot;|0 0 2 1 0 1 0⟩&quot;
 fs&quot;|0 1 1 1 0 0 1⟩&quot;
 fs&quot;|2 0 1 1 0 0 0⟩&quot;
 fs&quot;|0 0 2 0 2 0 0⟩&quot;
 fs&quot;|0 1 1 0 1 1 0⟩&quot;
 fs&quot;|1 0 1 0 1 0 1⟩&quot;
 fs&quot;|0 0 0 1 0 2 1⟩&quot;
 fs&quot;|1 2 0 1 0 0 0⟩&quot;
 fs&quot;|0 2 0 0 0 2 0⟩&quot;
 fs&quot;|1 1 0 0 0 1 1⟩&quot;
 fs&quot;|2 0 0 0 0 0 2⟩&quot;
 fs&quot;|1 0 0 0 3 0 0⟩&quot;
 fs&quot;|0 0 0 0 2 1 1⟩&quot;
 fs&quot;|0 2 0 0 1 0 1⟩&quot;
 fs&quot;|2 1 0 0 1 0 0⟩&quot;
 fs&quot;|0 0 0 0 1 3 0⟩&quot;
 fs&quot;|1 0 1 0 0 2 0⟩&quot;
 fs&quot;|3 0 0 0 0 1 0⟩&quot;
 fs&quot;|0 0 1 0 0 1 2⟩&quot;
 fs&quot;|0 1 0 0 0 0 3⟩&quot;
 fs&quot;|0 0 3 0 0 0 1⟩&quot;
 fs&quot;|1 1 2 0 0 0 0⟩&quot;
 fs&quot;|0 3 1 0 0 0 0⟩&quot;</code></pre><p>When the basis is not needed, we can use <code>Matrix</code> or <code>sparse</code> directly.</p><pre><code class="language-julia hljs">Matrix(ham)</code></pre><pre><code class="nohighlight hljs">30×30 Matrix{Float64}:
 -7.14286    0.494872   0.494872  0.494872   0.0       0.0       0.0        0.0       0.0       0.0        0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0
  0.494872  -4.92253    0.285714  0.285714   0.571429  0.404061  0.285714   0.571429  0.404061  0.285714   0.404061  0.202031  0.202031  0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0
  0.494872   0.285714  -1.53849   0.285714   0.285714  0.404061  0.0        0.285714  0.404061  0.0        0.0       0.202031  0.0       0.571429  0.571429  0.404061  0.202031  0.0        0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0
  0.494872   0.285714   0.285714  1.1753     0.0       0.404061  0.571429   0.0       0.404061  0.571429   0.0       0.0       0.202031  0.285714  0.285714  0.0       0.202031  0.404061   0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0
  0.0        0.571429   0.285714  0.0       -2.47749   0.404061  0.285714   0.0       0.202031  0.0        0.202031  0.404061  0.0       0.0       0.285714  0.0       0.0       0.0        0.494872  0.285714  0.571429  0.285714  0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0
  0.0        0.404061   0.404061  0.404061   0.404061  0.714286  0.202031   0.202031  0.0       0.404061   0.0       0.285714  0.285714  0.404061  0.202031  0.0       0.285714  0.0        0.349927  0.404061  0.0       0.404061  0.349927  0.404061  0.349927  0.0       0.0        0.0       0.0       0.0
  0.0        0.285714   0.0       0.571429   0.285714  0.202031  1.92832    0.0       0.404061  0.0        0.0       0.0       0.404061  0.285714  0.0       0.0       0.0       0.202031   0.0       0.571429  0.285714  0.0       0.0       0.0       0.0       0.285714  0.494872   0.0       0.0       0.0
  0.0        0.571429   0.285714  0.0        0.0       0.202031  0.0       -2.47749   0.404061  0.285714   0.202031  0.404061  0.0       0.285714  0.0       0.0       0.0       0.0        0.0       0.0       0.0       0.0       0.0       0.571429  0.0       0.285714  0.0        0.494872  0.285714  0.0
  0.0        0.404061   0.404061  0.404061   0.202031  0.0       0.404061   0.404061  0.714286  0.202031   0.0       0.285714  0.285714  0.202031  0.404061  0.0       0.285714  0.0        0.0       0.0       0.404061  0.0       0.0       0.0       0.0       0.404061  0.349927   0.349927  0.404061  0.349927
  0.0        0.285714   0.0       0.571429   0.0       0.404061  0.0        0.285714  0.202031  1.92832    0.0       0.0       0.404061  0.0       0.285714  0.0       0.0       0.202031   0.0       0.0       0.0       0.285714  0.0       0.285714  0.494872  0.0       0.0        0.0       0.571429  0.0
  0.0        0.404061   0.0       0.0        0.202031  0.0       0.0        0.202031  0.0       0.0       -3.55935   0.571429  0.571429  0.0       0.0       0.0       0.0       0.0        0.349927  0.202031  0.0       0.0       0.0       0.0       0.0       0.0       0.0        0.349927  0.202031  0.0
  0.0        0.202031   0.202031  0.0        0.404061  0.285714  0.0        0.404061  0.285714  0.0        0.571429  0.11041   0.285714  0.0       0.0       0.571429  0.285714  0.0        0.0       0.404061  0.404061  0.202031  0.349927  0.404061  0.0       0.202031  0.0        0.0       0.404061  0.349927
  0.0        0.202031   0.0       0.202031   0.0       0.285714  0.404061   0.0       0.285714  0.404061   0.571429  0.285714  2.8242    0.0       0.0       0.0       0.285714  0.571429   0.349927  0.404061  0.202031  0.404061  0.0       0.202031  0.0       0.404061  0.0        0.349927  0.404061  0.0
  0.0        0.0        0.571429  0.285714   0.0       0.404061  0.285714   0.285714  0.202031  0.0        0.0       0.0       0.0       2.26345   0.0       0.202031  0.404061  0.0        0.0       0.285714  0.0       0.0       0.494872  0.285714  0.0       0.571429  0.0        0.0       0.0       0.0
  0.0        0.0        0.571429  0.285714   0.285714  0.202031  0.0        0.0       0.404061  0.285714   0.0       0.0       0.0       0.0       2.26345   0.202031  0.404061  0.0        0.0       0.0       0.285714  0.571429  0.0       0.0       0.0       0.0       0.0        0.0       0.285714  0.494872
  0.0        0.0        0.404061  0.0        0.0       0.0       0.0        0.0       0.0       0.0        0.0       0.571429  0.0       0.202031  0.202031  3.20874   0.571429  0.0        0.0       0.0       0.202031  0.0       0.349927  0.202031  0.0       0.0       0.0        0.0       0.0       0.349927
  0.0        0.0        0.202031  0.202031   0.0       0.285714  0.0        0.0       0.285714  0.0        0.0       0.285714  0.285714  0.404061  0.404061  0.571429  6.20824   0.571429   0.0       0.202031  0.404061  0.404061  0.0       0.404061  0.349927  0.404061  0.349927   0.0       0.202031  0.0
  0.0        0.0        0.0       0.404061   0.0       0.0       0.202031   0.0       0.0       0.202031   0.0       0.0       0.571429  0.0       0.0       0.0       0.571429  8.63632    0.0       0.0       0.0       0.202031  0.0       0.0       0.349927  0.202031  0.349927   0.0       0.0       0.0
  0.0        0.0        0.0       0.0        0.494872  0.349927  0.0        0.0       0.0       0.0        0.349927  0.0       0.349927  0.0       0.0       0.0       0.0       0.0       -0.653287  0.494872  0.0       0.494872  0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0
  0.0        0.0        0.0       0.0        0.285714  0.404061  0.571429   0.0       0.0       0.0        0.202031  0.404061  0.404061  0.285714  0.0       0.0       0.202031  0.0        0.494872  1.32445   0.285714  0.0       0.494872  0.0       0.0       0.285714  0.0        0.0       0.0       0.0
  0.0        0.0        0.0       0.0        0.571429  0.0       0.285714   0.0       0.404061  0.0        0.0       0.404061  0.202031  0.0       0.285714  0.202031  0.404061  0.0        0.0       0.285714  3.01647   0.285714  0.0       0.0       0.0       0.0       0.494872   0.0       0.0       0.494872
  0.0        0.0        0.0       0.0        0.285714  0.404061  0.0        0.0       0.0       0.285714   0.0       0.202031  0.404061  0.0       0.571429  0.0       0.404061  0.202031   0.494872  0.0       0.285714  4.37337   0.0       0.0       0.494872  0.0       0.0        0.0       0.285714  0.0
  0.0        0.0        0.0       0.0        0.0       0.349927  0.0        0.0       0.0       0.0        0.0       0.349927  0.0       0.494872  0.0       0.349927  0.0       0.0        0.0       0.494872  0.0       0.0       1.37386   0.494872  0.0       0.0       0.0        0.0       0.0       0.0
  0.0        0.0        0.0       0.0        0.0       0.404061  0.0        0.571429  0.0       0.285714   0.0       0.404061  0.202031  0.285714  0.0       0.202031  0.404061  0.0        0.0       0.0       0.0       0.0       0.494872  3.01647   0.494872  0.285714  0.0        0.0       0.285714  0.0
  0.0        0.0        0.0       0.0        0.0       0.349927  0.0        0.0       0.0       0.494872   0.0       0.0       0.0       0.0       0.0       0.0       0.349927  0.349927   0.0       0.0       0.0       0.494872  0.0       0.494872  7.13657   0.0       0.0        0.0       0.0       0.0
  0.0        0.0        0.0       0.0        0.0       0.0       0.285714   0.285714  0.404061  0.0        0.0       0.202031  0.404061  0.571429  0.0       0.0       0.404061  0.202031   0.0       0.285714  0.0       0.0       0.0       0.285714  0.0       4.37337   0.494872   0.494872  0.0       0.0
  0.0        0.0        0.0       0.0        0.0       0.0       0.494872   0.0       0.349927  0.0        0.0       0.0       0.0       0.0       0.0       0.0       0.349927  0.349927   0.0       0.0       0.494872  0.0       0.0       0.0       0.0       0.494872  7.13657    0.0       0.0       0.0
  0.0        0.0        0.0       0.0        0.0       0.0       0.0        0.494872  0.349927  0.0        0.349927  0.0       0.349927  0.0       0.0       0.0       0.0       0.0        0.0       0.0       0.0       0.0       0.0       0.0       0.0       0.494872  0.0       -0.653287  0.494872  0.0
  0.0        0.0        0.0       0.0        0.0       0.0       0.0        0.285714  0.404061  0.571429   0.202031  0.404061  0.404061  0.0       0.285714  0.0       0.202031  0.0        0.0       0.0       0.0       0.285714  0.0       0.285714  0.0       0.0       0.0        0.494872  1.32445   0.494872
  0.0        0.0        0.0       0.0        0.0       0.0       0.0        0.0       0.349927  0.0        0.0       0.349927  0.0       0.0       0.494872  0.349927  0.0       0.0        0.0       0.0       0.494872  0.0       0.0       0.0       0.0       0.0       0.0        0.0       0.494872  1.37386</code></pre><pre><code class="language-julia hljs">sparse(ham)</code></pre><pre><code class="nohighlight hljs">30×30 SparseArrays.SparseMatrixCSC{Float64, Int64} with 366 stored entries:
⣿⣿⢶⡲⣖⠲⣢⡤⣄⠀⠀⠀⠀⠀⠀
⢸⡳⢿⢗⣕⣙⢶⠃⠢⠻⠝⢒⢢⢄⡀
⢸⡙⣕⢹⡛⣬⡏⢃⡑⢤⣑⣐⢊⠩⣏
⠈⡾⠼⠓⠯⢉⢑⣴⡏⠙⡭⣚⠘⠈⢥
⠀⠙⣬⡂⠑⣌⣏⠉⡛⣬⡹⡈⢛⠃⠁
⠀⠀⢳⢁⢑⢸⣣⢫⡓⠪⠛⣤⣂⠁⡊
⠀⠀⠈⢖⡎⡐⡒⠀⠿⠐⠌⠘⢱⢖⡀
⠀⠀⠀⠈⠋⠙⠁⠓⠁⠀⠊⠈⠀⠈⠛</code></pre><h2 id="Computing-eigenvalues"><a class="docs-heading-anchor" href="#Computing-eigenvalues">Computing eigenvalues</a><a id="Computing-eigenvalues-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-eigenvalues" title="Permalink"></a></h2><p>Now that we have a way of constructing matrices from Hamiltonians, we can use standard Julia functionality to diagonalize them.</p><p>Let&#39;s begin by looking at the <code>eigen</code> function from the LinearAlgebra standard library. It operates on dense matrices and returns the full spectrum, hence it is only useful for small systems, or when all eigenvalues are required.</p><pre><code class="language-julia hljs">using LinearAlgebra

mat = Matrix(ham)
eig = eigen(mat)</code></pre><pre><code class="nohighlight hljs">LinearAlgebra.Eigen{Float64, Float64, Matrix{Float64}, Vector{Float64}}
values:
30-element Vector{Float64}:
 -7.313652669016772
 -5.20303327575289
 -3.749169513561686
 -2.7189087802075367
 -2.6990477177540626
 -1.737984307198177
 -0.8035991245861094
 -0.799332813252367
 -0.2504534088616168
  0.26752054218184185
  0.2914932298990216
  0.7219822375239513
  0.8061331917279517
  0.846544289700347
  1.501045485103587
  1.5342526863371466
  1.7324225079192255
  1.7998902734151025
  2.675174352055387
  2.746774612650861
  2.801444420412939
  3.2715018722018776
  3.299924728842914
  3.8509778449222534
  4.690398495171209
  4.888214927922314
  6.442683753741093
  7.366283958413225
  7.452075937628737
  9.288442262420302
vectors:
30×30 Matrix{Float64}:
  0.972314     -0.205411     -0.0226119    -0.00249093  -6.69015e-16   0.086586     0.00269686    1.88637e-15  -0.00718494    1.29373e-16   0.0300215   -0.020064    -8.38761e-15   0.039381      0.00902482  -1.20307e-16   1.83223e-16   0.0185675   -0.000113915  -0.0276996   -4.49896e-16  -0.0100659   -3.72629e-16  -0.0100751   4.83228e-16  -0.00725757   0.0045141    6.32973e-17  -0.00202701  -0.00313468
 -0.209379     -0.916627     -0.145877      0.251348     4.75676e-14   0.098167     0.021358      1.30747e-14  -0.0284247     1.43704e-17  -0.072756    -0.0653729   -1.4122e-14    0.0496891    -0.0120973    1.70819e-16   2.12778e-16   0.0321117    0.00984039   -0.0367795    2.63581e-16  -0.0463827   -1.02728e-16  -0.0342126   3.87055e-16  -0.0451389    0.0153164    3.21288e-16  -0.0142784   -0.0117251
 -0.0762832     0.0656493    -0.0239097    -0.301865    -6.01035e-14   0.898475    -0.0257466    -1.95921e-14  -0.0408192    -2.78934e-16  -0.0877932   -0.169184    -2.38655e-14   0.048797      0.0961295   -6.10762e-15   1.08511e-15  -0.0407679   -0.0143179    -0.15679     -5.39476e-16   0.0292513    7.96657e-16  -0.0849432   1.53518e-17  -0.0352988    0.0567989    6.19039e-16  -0.0350875   -0.0203438
 -0.0499134     0.0457976     0.0147206     0.0282495    5.49977e-15  -0.0509694    0.0389351     2.46462e-14  -0.0308255     1.42706e-15   0.611555    -0.0843145   -1.00993e-13   0.537296      0.073604     3.38173e-15   2.26846e-15   0.344187     0.00221744   -0.359986    -8.57293e-16  -0.194702    -3.87605e-15  -0.104667    1.17991e-15  -0.0960048    0.0518087    2.1302e-16   -0.0104153   -0.0720123
  0.0266014     0.173877      0.180224      0.596708     0.683733      0.154813     0.129908      0.13414      -0.0465999     0.0354627    -0.0911636   -0.129777     0.0269771     0.00616508   -0.027685    -0.0446817    -0.0446035     0.00230634  -0.0467247    -0.00151867  -0.0532741    -0.0151178    0.0584083    -0.0460314   0.047874     -0.0711238    0.0293852    0.00185644   -0.0289297   -0.0157695
  0.0142658     0.0409941    -0.0247849    -0.0637732   -0.0327022    -0.163772    -0.20656      -0.122494      0.245075      0.555907     -0.386026    -0.290366     0.279398      0.237026     -0.0437537   -0.230433     -0.0175662    -0.0102814   -0.0462361    -0.135659    -0.142524     -0.100589    -0.141152     -0.0946946   0.0251758    -0.135232     0.0647247   -0.0505091    -0.0865407   -0.05255
  0.00781882    0.024752     -0.00529919   -0.0470087   -0.0408        0.0152956    0.0704818     0.00670581   -0.0756723     0.162931     -0.18313      0.25886     -0.101909     -0.252306     -0.185858     0.391782     -0.419402      0.37277      0.0545033    -0.197774    -0.320362     -0.233777     0.141921     -0.108727   -0.0570799    -0.176854     0.00528754   0.0770448    -0.0610514   -0.0697507
  0.0266014     0.173877      0.180224      0.596708    -0.683733      0.154813     0.129908     -0.13414      -0.0465999    -0.0354627    -0.0911636   -0.129777    -0.0269771     0.00616508   -0.027685     0.0446817     0.0446035     0.00230634  -0.0467247    -0.00151867   0.0532741    -0.0151178   -0.0584083    -0.0460314  -0.047874     -0.0711238    0.0293852   -0.00185644   -0.0289297   -0.0157695
  0.0142658     0.0409941    -0.0247849    -0.0637732    0.0327022    -0.163772    -0.20656       0.122494      0.245075     -0.555907     -0.386026    -0.290366    -0.279398      0.237026     -0.0437537    0.230433      0.0175662    -0.0102814   -0.0462361    -0.135659     0.142524     -0.100589     0.141152     -0.0946946  -0.0251758    -0.135232     0.0647247    0.0505091    -0.0865407   -0.05255
  0.00781882    0.024752     -0.00529919   -0.0470087    0.0408        0.0152956    0.0704818    -0.00670581   -0.0756723    -0.162931     -0.18313      0.25886      0.101909     -0.252306     -0.185858    -0.391782      0.419402      0.37277      0.0545033    -0.197774     0.320362     -0.233777    -0.141921     -0.108727    0.0570799    -0.176854     0.00528754  -0.0770448    -0.0610514   -0.0697507
  0.0197549     0.204457     -0.938067      0.158004     3.33177e-14   0.00254341   0.153136      9.92788e-14  -0.0973405     2.59658e-16  -0.00277106  -0.0752406   -9.08339e-15   0.00860803   -0.0139339   -3.20853e-16  -2.73519e-16  -0.056159     0.0582164     0.0415304    1.07642e-15  -0.0460833   -6.24042e-16  -0.0231425   7.83211e-16  -0.0499721    0.0191825    3.56516e-16  -0.0101578   -0.0103358
  0.00258537   -0.0166617     0.11379      -0.189127    -3.67051e-14  -0.155383     0.0861937     5.67632e-14  -0.831471      1.79497e-15  -0.114588    -0.260507    -5.31259e-14   0.152747     -0.198456     4.76653e-15  -9.72838e-16  -0.0978355    0.0258359     0.125334     1.79928e-15   0.0494322   -3.55147e-16  -0.16891     6.35692e-16  -0.109249     0.0973095    6.29982e-16  -0.0677356   -0.0381555
  0.00313766    0.00836877    0.0781271     0.0202769    4.13099e-15   0.0230959   -0.0902679    -5.74233e-14  -0.0149234     6.77479e-16   0.00596413   0.155616     7.41217e-15   0.0542569     0.436854    -1.90289e-14   6.47766e-16  -0.222209     0.540289      0.304711     4.12108e-15  -0.43074     -2.35366e-15  -0.0310169   3.25401e-15  -0.335832     0.121215     3.73562e-16  -0.0347102   -0.130944
  0.00428315   -0.0164479    -0.0015824     0.00709024   0.0397853    -0.122157     0.0373235     0.0138457    -0.0771615    -0.0441746     0.0425524    0.0375684    0.102663     -0.22949       0.308934     0.261615      0.466654     -0.275713    -0.188676     -0.399196    -0.374125      0.0679619   -0.139244     -0.104098   -0.200081     -0.120688     0.126364     0.0116168    -0.0829522   -0.0470911
  0.00428315   -0.0164479    -0.0015824     0.00709024  -0.0397853    -0.122157     0.0373235    -0.0138457    -0.0771615     0.0441746     0.0425524    0.0375684   -0.102663     -0.22949       0.308934    -0.261615     -0.466654     -0.275713    -0.188676     -0.399196     0.374125      0.0679619    0.139244     -0.104098    0.200081     -0.120688     0.126364    -0.0116168    -0.0829522   -0.0470911
  0.00270897   -0.000719645  -0.00608329    0.0370589    7.08796e-15  -0.0547043   -0.0266977    -1.72193e-14   0.129941     -1.47924e-16   0.0330818   -0.0562099    1.03372e-14  -0.0894162     0.0512477    1.51912e-15   4.84329e-16   0.213285     0.513882     -0.0154187    2.18786e-15   0.610649     5.02943e-15  -0.487648   -1.32801e-15   0.0479575    0.174042     4.14009e-16  -0.089943    -0.0440448
  0.00108781   -0.000723383  -0.000782986   0.0166731    3.21698e-15   0.00698052   0.0293455     1.91552e-14   0.000736555  -1.65793e-16  -0.0210728    0.0568139    4.37958e-15   0.00821131   -0.0611464    2.9688e-15   -2.54701e-16   0.0142335    0.0154213     0.0139306    5.48951e-16  -0.148043    -7.114e-16     0.197148   -6.66903e-15   0.532654     0.635612     3.07604e-15  -0.376685    -0.3167
  0.000975035  -0.00219326   -0.00353155   -0.00148327  -3.11022e-16  -0.00128834   0.000559817   2.77652e-16   0.00663228   -9.45479e-17  -0.0235109   -0.0257544    1.20082e-15  -0.0221469    -0.0226965    5.07325e-17  -1.61656e-16  -0.0244713   -0.061176      0.00667819  -6.0443e-16    0.0700419    4.973e-16    -0.0354392  -3.10919e-16   0.0265292   -0.0826624   -4.9105e-15    0.544367    -0.826615
 -0.00362902   -0.0364912     0.0720587    -0.161331    -0.152537     -0.0480888    0.61574       0.655219      0.205341     -0.0144047    -0.0109774   -0.152208     0.154037      0.000517638  -0.0450373   -0.0908597    -0.0474142    -0.0653283    0.0537208     0.0305645   -0.0945218    -0.0310561   -0.0216671     0.0190496   0.0591401    -0.088245     0.0258365   -0.00897472   -0.0200172   -0.0153503
 -0.00258159   -0.0140318     0.0101236    -0.001187    -0.0186894     0.0288584   -0.16759      -0.172167      0.119217     -0.371857      0.310141    -0.19011      0.245706     -0.255636     -0.393861    -0.314962     -0.1985       -0.213515     0.0414754     0.0253411   -0.354778     -0.124518     0.0576911    -0.0944364  -0.058264     -0.146202     0.0763459    0.0128911    -0.0540605   -0.0354179
 -0.0024496    -0.0131426    -0.0220141    -0.045191    -0.0661308     0.00656733  -0.00342749   -0.00617537    0.0682998     0.11041       0.0756884   -0.00191347  -0.0897399    -0.0519058     0.15865     -0.121609      0.247467      0.174547    -0.40202       0.38258     -0.133882     -0.0110603    0.584463     -0.277468    0.18244      -0.116149     0.0845338    0.080686     -0.135263    -0.0669398
 -0.00145267   -0.00383078   -0.0155464    -0.00308699  -0.0113421     0.0194074   -0.0477377    -0.068724      0.000622347  -0.0834939     0.0307692    0.0453815   -0.0159792     0.0389847    -0.0426263    0.120947      0.0269475     0.0914697   -0.0239428     0.0372693   -0.151031      0.301625    -0.189374      0.41911     0.631191     -0.402401     0.119695    -0.124471     -0.151946    -0.120134
 -0.000745259   0.00202599   -0.00436251    0.0232046   -0.0077887     0.0558332    0.0540185     0.0543701     0.0647133     0.0596507    -0.0447092    0.443135    -0.554099      0.304673     -0.238544    -0.292121      0.0114082    -0.279149    -0.0761622    -0.00341626  -0.241199      0.0855377   -0.196767     -0.201219   -0.0631148    -0.0735053    0.0512448   -0.00758882   -0.0362278   -0.0153022
 -0.0024496    -0.0131426    -0.0220141    -0.045191     0.0661308     0.00656733  -0.00342749    0.00617537    0.0682998    -0.11041       0.0756884   -0.00191347   0.0897399    -0.0519058     0.15865      0.121609     -0.247467      0.174547    -0.40202       0.38258      0.133882     -0.0110603   -0.584463     -0.277468   -0.18244      -0.116149     0.0845338   -0.080686     -0.135263    -0.0669398
 -0.000529544  -0.00139176    0.00288384    0.00650961  -0.00364601    0.00393178   0.00658136    0.00971988   -0.0115062    -0.0026117     0.0275564   -0.00917831  -0.0291769     0.0084559     0.0140552    0.0275748    -0.0170747    -0.0578894    0.0484186    -0.015864    -0.0231086     0.00889785   0.130994     -0.0120949  -0.105933      0.0870786   -0.460918    -0.684885     -0.456252    -0.253528
 -0.00145267   -0.00383078   -0.0155464    -0.00308699   0.0113421     0.0194074   -0.0477377     0.068724      0.000622347   0.0834939     0.0307692    0.0453815    0.0159792     0.0389847    -0.0426263   -0.120947     -0.0269475     0.0914697   -0.0239428     0.0372693    0.151031      0.301625     0.189374      0.41911    -0.631191     -0.402401     0.119695     0.124471     -0.151946    -0.120134
 -0.000529544  -0.00139176    0.00288384    0.00650961   0.00364601    0.00393178   0.00658136   -0.00971988   -0.0115062     0.0026117     0.0275564   -0.00917831   0.0291769     0.0084559     0.0140552   -0.0275748     0.0170747    -0.0578894    0.0484186    -0.015864     0.0231086     0.00889785  -0.130994     -0.0120949   0.105933      0.0870786   -0.460918     0.684885     -0.456252    -0.253528
 -0.00362902   -0.0364912     0.0720587    -0.161331     0.152537     -0.0480888    0.61574      -0.655219      0.205341      0.0144047    -0.0109774   -0.152208    -0.154037      0.000517638  -0.0450373    0.0908597     0.0474142    -0.0653283    0.0537208     0.0305645    0.0945218    -0.0310561    0.0216671     0.0190496  -0.0591401    -0.088245     0.0258365    0.00897472   -0.0200172   -0.0153503
 -0.00258159   -0.0140318     0.0101236    -0.001187     0.0186894     0.0288584   -0.16759       0.172167      0.119217      0.371857      0.310141    -0.19011     -0.245706     -0.255636     -0.393861     0.314962      0.1985       -0.213515     0.0414754     0.0253411    0.354778     -0.124518    -0.0576911    -0.0944364   0.058264     -0.146202     0.0763459   -0.0128911    -0.0540605   -0.0354179
 -0.000745259   0.00202599   -0.00436251    0.0232046    0.0077887     0.0558332    0.0540185    -0.0543701     0.0647133    -0.0596507    -0.0447092    0.443135     0.554099      0.304673     -0.238544     0.292121     -0.0114082    -0.279149    -0.0761622    -0.00341626   0.241199      0.0855377    0.196767     -0.201219    0.0631148    -0.0735053    0.0512448    0.00758882   -0.0362278   -0.0153022</code></pre><p>The values can be accesses like so:</p><pre><code class="language-julia hljs">eig.values</code></pre><pre><code class="nohighlight hljs">30-element Vector{Float64}:
 -7.313652669016772
 -5.20303327575289
 -3.749169513561686
 -2.7189087802075367
 -2.6990477177540626
 -1.737984307198177
 -0.8035991245861094
 -0.799332813252367
 -0.2504534088616168
  0.26752054218184185
  0.2914932298990216
  0.7219822375239513
  0.8061331917279517
  0.846544289700347
  1.501045485103587
  1.5342526863371466
  1.7324225079192255
  1.7998902734151025
  2.675174352055387
  2.746774612650861
  2.801444420412939
  3.2715018722018776
  3.299924728842914
  3.8509778449222534
  4.690398495171209
  4.888214927922314
  6.442683753741093
  7.366283958413225
  7.452075937628737
  9.288442262420302</code></pre><p>The vectors are stored as columns in <code>eig.vectors</code>:</p><pre><code class="language-julia hljs">eig.vectors</code></pre><pre><code class="nohighlight hljs">30×30 Matrix{Float64}:
  0.972314     -0.205411     -0.0226119    -0.00249093  -6.69015e-16   0.086586     0.00269686    1.88637e-15  -0.00718494    1.29373e-16   0.0300215   -0.020064    -8.38761e-15   0.039381      0.00902482  -1.20307e-16   1.83223e-16   0.0185675   -0.000113915  -0.0276996   -4.49896e-16  -0.0100659   -3.72629e-16  -0.0100751   4.83228e-16  -0.00725757   0.0045141    6.32973e-17  -0.00202701  -0.00313468
 -0.209379     -0.916627     -0.145877      0.251348     4.75676e-14   0.098167     0.021358      1.30747e-14  -0.0284247     1.43704e-17  -0.072756    -0.0653729   -1.4122e-14    0.0496891    -0.0120973    1.70819e-16   2.12778e-16   0.0321117    0.00984039   -0.0367795    2.63581e-16  -0.0463827   -1.02728e-16  -0.0342126   3.87055e-16  -0.0451389    0.0153164    3.21288e-16  -0.0142784   -0.0117251
 -0.0762832     0.0656493    -0.0239097    -0.301865    -6.01035e-14   0.898475    -0.0257466    -1.95921e-14  -0.0408192    -2.78934e-16  -0.0877932   -0.169184    -2.38655e-14   0.048797      0.0961295   -6.10762e-15   1.08511e-15  -0.0407679   -0.0143179    -0.15679     -5.39476e-16   0.0292513    7.96657e-16  -0.0849432   1.53518e-17  -0.0352988    0.0567989    6.19039e-16  -0.0350875   -0.0203438
 -0.0499134     0.0457976     0.0147206     0.0282495    5.49977e-15  -0.0509694    0.0389351     2.46462e-14  -0.0308255     1.42706e-15   0.611555    -0.0843145   -1.00993e-13   0.537296      0.073604     3.38173e-15   2.26846e-15   0.344187     0.00221744   -0.359986    -8.57293e-16  -0.194702    -3.87605e-15  -0.104667    1.17991e-15  -0.0960048    0.0518087    2.1302e-16   -0.0104153   -0.0720123
  0.0266014     0.173877      0.180224      0.596708     0.683733      0.154813     0.129908      0.13414      -0.0465999     0.0354627    -0.0911636   -0.129777     0.0269771     0.00616508   -0.027685    -0.0446817    -0.0446035     0.00230634  -0.0467247    -0.00151867  -0.0532741    -0.0151178    0.0584083    -0.0460314   0.047874     -0.0711238    0.0293852    0.00185644   -0.0289297   -0.0157695
  0.0142658     0.0409941    -0.0247849    -0.0637732   -0.0327022    -0.163772    -0.20656      -0.122494      0.245075      0.555907     -0.386026    -0.290366     0.279398      0.237026     -0.0437537   -0.230433     -0.0175662    -0.0102814   -0.0462361    -0.135659    -0.142524     -0.100589    -0.141152     -0.0946946   0.0251758    -0.135232     0.0647247   -0.0505091    -0.0865407   -0.05255
  0.00781882    0.024752     -0.00529919   -0.0470087   -0.0408        0.0152956    0.0704818     0.00670581   -0.0756723     0.162931     -0.18313      0.25886     -0.101909     -0.252306     -0.185858     0.391782     -0.419402      0.37277      0.0545033    -0.197774    -0.320362     -0.233777     0.141921     -0.108727   -0.0570799    -0.176854     0.00528754   0.0770448    -0.0610514   -0.0697507
  0.0266014     0.173877      0.180224      0.596708    -0.683733      0.154813     0.129908     -0.13414      -0.0465999    -0.0354627    -0.0911636   -0.129777    -0.0269771     0.00616508   -0.027685     0.0446817     0.0446035     0.00230634  -0.0467247    -0.00151867   0.0532741    -0.0151178   -0.0584083    -0.0460314  -0.047874     -0.0711238    0.0293852   -0.00185644   -0.0289297   -0.0157695
  0.0142658     0.0409941    -0.0247849    -0.0637732    0.0327022    -0.163772    -0.20656       0.122494      0.245075     -0.555907     -0.386026    -0.290366    -0.279398      0.237026     -0.0437537    0.230433      0.0175662    -0.0102814   -0.0462361    -0.135659     0.142524     -0.100589     0.141152     -0.0946946  -0.0251758    -0.135232     0.0647247    0.0505091    -0.0865407   -0.05255
  0.00781882    0.024752     -0.00529919   -0.0470087    0.0408        0.0152956    0.0704818    -0.00670581   -0.0756723    -0.162931     -0.18313      0.25886      0.101909     -0.252306     -0.185858    -0.391782      0.419402      0.37277      0.0545033    -0.197774     0.320362     -0.233777    -0.141921     -0.108727    0.0570799    -0.176854     0.00528754  -0.0770448    -0.0610514   -0.0697507
  0.0197549     0.204457     -0.938067      0.158004     3.33177e-14   0.00254341   0.153136      9.92788e-14  -0.0973405     2.59658e-16  -0.00277106  -0.0752406   -9.08339e-15   0.00860803   -0.0139339   -3.20853e-16  -2.73519e-16  -0.056159     0.0582164     0.0415304    1.07642e-15  -0.0460833   -6.24042e-16  -0.0231425   7.83211e-16  -0.0499721    0.0191825    3.56516e-16  -0.0101578   -0.0103358
  0.00258537   -0.0166617     0.11379      -0.189127    -3.67051e-14  -0.155383     0.0861937     5.67632e-14  -0.831471      1.79497e-15  -0.114588    -0.260507    -5.31259e-14   0.152747     -0.198456     4.76653e-15  -9.72838e-16  -0.0978355    0.0258359     0.125334     1.79928e-15   0.0494322   -3.55147e-16  -0.16891     6.35692e-16  -0.109249     0.0973095    6.29982e-16  -0.0677356   -0.0381555
  0.00313766    0.00836877    0.0781271     0.0202769    4.13099e-15   0.0230959   -0.0902679    -5.74233e-14  -0.0149234     6.77479e-16   0.00596413   0.155616     7.41217e-15   0.0542569     0.436854    -1.90289e-14   6.47766e-16  -0.222209     0.540289      0.304711     4.12108e-15  -0.43074     -2.35366e-15  -0.0310169   3.25401e-15  -0.335832     0.121215     3.73562e-16  -0.0347102   -0.130944
  0.00428315   -0.0164479    -0.0015824     0.00709024   0.0397853    -0.122157     0.0373235     0.0138457    -0.0771615    -0.0441746     0.0425524    0.0375684    0.102663     -0.22949       0.308934     0.261615      0.466654     -0.275713    -0.188676     -0.399196    -0.374125      0.0679619   -0.139244     -0.104098   -0.200081     -0.120688     0.126364     0.0116168    -0.0829522   -0.0470911
  0.00428315   -0.0164479    -0.0015824     0.00709024  -0.0397853    -0.122157     0.0373235    -0.0138457    -0.0771615     0.0441746     0.0425524    0.0375684   -0.102663     -0.22949       0.308934    -0.261615     -0.466654     -0.275713    -0.188676     -0.399196     0.374125      0.0679619    0.139244     -0.104098    0.200081     -0.120688     0.126364    -0.0116168    -0.0829522   -0.0470911
  0.00270897   -0.000719645  -0.00608329    0.0370589    7.08796e-15  -0.0547043   -0.0266977    -1.72193e-14   0.129941     -1.47924e-16   0.0330818   -0.0562099    1.03372e-14  -0.0894162     0.0512477    1.51912e-15   4.84329e-16   0.213285     0.513882     -0.0154187    2.18786e-15   0.610649     5.02943e-15  -0.487648   -1.32801e-15   0.0479575    0.174042     4.14009e-16  -0.089943    -0.0440448
  0.00108781   -0.000723383  -0.000782986   0.0166731    3.21698e-15   0.00698052   0.0293455     1.91552e-14   0.000736555  -1.65793e-16  -0.0210728    0.0568139    4.37958e-15   0.00821131   -0.0611464    2.9688e-15   -2.54701e-16   0.0142335    0.0154213     0.0139306    5.48951e-16  -0.148043    -7.114e-16     0.197148   -6.66903e-15   0.532654     0.635612     3.07604e-15  -0.376685    -0.3167
  0.000975035  -0.00219326   -0.00353155   -0.00148327  -3.11022e-16  -0.00128834   0.000559817   2.77652e-16   0.00663228   -9.45479e-17  -0.0235109   -0.0257544    1.20082e-15  -0.0221469    -0.0226965    5.07325e-17  -1.61656e-16  -0.0244713   -0.061176      0.00667819  -6.0443e-16    0.0700419    4.973e-16    -0.0354392  -3.10919e-16   0.0265292   -0.0826624   -4.9105e-15    0.544367    -0.826615
 -0.00362902   -0.0364912     0.0720587    -0.161331    -0.152537     -0.0480888    0.61574       0.655219      0.205341     -0.0144047    -0.0109774   -0.152208     0.154037      0.000517638  -0.0450373   -0.0908597    -0.0474142    -0.0653283    0.0537208     0.0305645   -0.0945218    -0.0310561   -0.0216671     0.0190496   0.0591401    -0.088245     0.0258365   -0.00897472   -0.0200172   -0.0153503
 -0.00258159   -0.0140318     0.0101236    -0.001187    -0.0186894     0.0288584   -0.16759      -0.172167      0.119217     -0.371857      0.310141    -0.19011      0.245706     -0.255636     -0.393861    -0.314962     -0.1985       -0.213515     0.0414754     0.0253411   -0.354778     -0.124518     0.0576911    -0.0944364  -0.058264     -0.146202     0.0763459    0.0128911    -0.0540605   -0.0354179
 -0.0024496    -0.0131426    -0.0220141    -0.045191    -0.0661308     0.00656733  -0.00342749   -0.00617537    0.0682998     0.11041       0.0756884   -0.00191347  -0.0897399    -0.0519058     0.15865     -0.121609      0.247467      0.174547    -0.40202       0.38258     -0.133882     -0.0110603    0.584463     -0.277468    0.18244      -0.116149     0.0845338    0.080686     -0.135263    -0.0669398
 -0.00145267   -0.00383078   -0.0155464    -0.00308699  -0.0113421     0.0194074   -0.0477377    -0.068724      0.000622347  -0.0834939     0.0307692    0.0453815   -0.0159792     0.0389847    -0.0426263    0.120947      0.0269475     0.0914697   -0.0239428     0.0372693   -0.151031      0.301625    -0.189374      0.41911     0.631191     -0.402401     0.119695    -0.124471     -0.151946    -0.120134
 -0.000745259   0.00202599   -0.00436251    0.0232046   -0.0077887     0.0558332    0.0540185     0.0543701     0.0647133     0.0596507    -0.0447092    0.443135    -0.554099      0.304673     -0.238544    -0.292121      0.0114082    -0.279149    -0.0761622    -0.00341626  -0.241199      0.0855377   -0.196767     -0.201219   -0.0631148    -0.0735053    0.0512448   -0.00758882   -0.0362278   -0.0153022
 -0.0024496    -0.0131426    -0.0220141    -0.045191     0.0661308     0.00656733  -0.00342749    0.00617537    0.0682998    -0.11041       0.0756884   -0.00191347   0.0897399    -0.0519058     0.15865      0.121609     -0.247467      0.174547    -0.40202       0.38258      0.133882     -0.0110603   -0.584463     -0.277468   -0.18244      -0.116149     0.0845338   -0.080686     -0.135263    -0.0669398
 -0.000529544  -0.00139176    0.00288384    0.00650961  -0.00364601    0.00393178   0.00658136    0.00971988   -0.0115062    -0.0026117     0.0275564   -0.00917831  -0.0291769     0.0084559     0.0140552    0.0275748    -0.0170747    -0.0578894    0.0484186    -0.015864    -0.0231086     0.00889785   0.130994     -0.0120949  -0.105933      0.0870786   -0.460918    -0.684885     -0.456252    -0.253528
 -0.00145267   -0.00383078   -0.0155464    -0.00308699   0.0113421     0.0194074   -0.0477377     0.068724      0.000622347   0.0834939     0.0307692    0.0453815    0.0159792     0.0389847    -0.0426263   -0.120947     -0.0269475     0.0914697   -0.0239428     0.0372693    0.151031      0.301625     0.189374      0.41911    -0.631191     -0.402401     0.119695     0.124471     -0.151946    -0.120134
 -0.000529544  -0.00139176    0.00288384    0.00650961   0.00364601    0.00393178   0.00658136   -0.00971988   -0.0115062     0.0026117     0.0275564   -0.00917831   0.0291769     0.0084559     0.0140552   -0.0275748     0.0170747    -0.0578894    0.0484186    -0.015864     0.0231086     0.00889785  -0.130994     -0.0120949   0.105933      0.0870786   -0.460918     0.684885     -0.456252    -0.253528
 -0.00362902   -0.0364912     0.0720587    -0.161331     0.152537     -0.0480888    0.61574      -0.655219      0.205341      0.0144047    -0.0109774   -0.152208    -0.154037      0.000517638  -0.0450373    0.0908597     0.0474142    -0.0653283    0.0537208     0.0305645    0.0945218    -0.0310561    0.0216671     0.0190496  -0.0591401    -0.088245     0.0258365    0.00897472   -0.0200172   -0.0153503
 -0.00258159   -0.0140318     0.0101236    -0.001187     0.0186894     0.0288584   -0.16759       0.172167      0.119217      0.371857      0.310141    -0.19011     -0.245706     -0.255636     -0.393861     0.314962      0.1985       -0.213515     0.0414754     0.0253411    0.354778     -0.124518    -0.0576911    -0.0944364   0.058264     -0.146202     0.0763459   -0.0128911    -0.0540605   -0.0354179
 -0.000745259   0.00202599   -0.00436251    0.0232046    0.0077887     0.0558332    0.0540185    -0.0543701     0.0647133    -0.0596507    -0.0447092    0.443135     0.554099      0.304673     -0.238544     0.292121     -0.0114082    -0.279149    -0.0761622    -0.00341626   0.241199      0.0855377    0.196767     -0.201219    0.0631148    -0.0735053    0.0512448    0.00758882   -0.0362278   -0.0153022</code></pre><p>If you need the full spectrum, but would like to use less memory, consider using the in-place <code>eigen!</code>.</p><p>For larger Hamiltonians, it is better to use an iterative solver. Here, there are several options. We will look at <code>eigs</code> from <a href="https://github.com/JuliaLinearAlgebra/Arpack.jl"><code>Arpack.jl</code></a> and <code>eigsolve</code> from <a href="https://github.com/Jutho/KrylovKit.jl/">KrylovKit.jl</a>.</p><pre><code class="language-julia hljs">using Arpack
using KrylovKit

num_eigvals = 3

sm = sparse(ham)
vals_ar, vecs_ar = eigs(sm; which=:SR, nev=num_eigvals)
vals_ar</code></pre><pre><code class="nohighlight hljs">3-element Vector{Float64}:
 -7.313652669016796
 -5.203033275752877
 -3.7491695135616765</code></pre><pre><code class="language-julia hljs">vals_kk, vecs_kk = eigsolve(sm, num_eigvals, :SR)
vals_kk</code></pre><pre><code class="nohighlight hljs">30-element Vector{Float64}:
 -7.313652669016772
 -5.203033275752871
 -3.7491695135616716
 -2.7189087802075402
 -2.699047717754059
 -1.7379843071981895
 -0.8035991245861132
 -0.7993328132523639
 -0.2504534088616204
  0.26752054218183474
  0.2914932298990234
  0.7219822375239353
  0.8061331917279393
  0.8465442897003399
  1.501045485103588
  1.5342526863371466
  1.7324225079192237
  1.7998902734150954
  2.6751743520553806
  2.7467746126508503
  2.801444420412939
  3.2715018722018803
  3.299924728842905
  3.850977844922256
  4.690398495171202
  4.888214927922316
  6.442683753741095
  7.366283958413222
  7.45207593762874
  9.288442262420302</code></pre><p>Both solvers use the <a href="https://en.wikipedia.org/wiki/Lanczos_algorithm">Lanczos algorithm</a> for Hermitian matrices and the <a href="https://en.wikipedia.org/wiki/Arnoldi_iteration">Arnoldi algorithm</a> for non-Hermitian ones. They both take the desired number of eigenpairs to compute and a symbol denoting which eigenpairs to look for. In this case, we use <code>:SR</code>, which stands for &quot;smallest real part&quot;.</p><p>If diagonalisation takes too long, you can use the <code>tol</code> keyword argument to <code>eigs</code> or <code>eigsolve</code>. Using drastically lower tolerances than default can still produce good results in practice. This, however, should be checked on a case-by-case basis.</p><p>For very large Hamiltonians, where the sparse matrix would not fit into memory, you can use <code>eigsolve</code> matrix-free. While this method is by far the slowest of the ones discussed, its advantage is that it doesn&#39;t have to store the matrix - only a few copies of full vectors are needed.</p><p>To use it, you first need a starting vector:</p><pre><code class="language-julia hljs">dvec = DVec(add =&gt; 1.0)</code></pre><pre><code class="nohighlight hljs">DVec{BoseFS{4, 7, BitString{10, 1, UInt16}},Float64} with 1 entry, style = IsDeterministic{Float64}()
  fs&quot;|0 0 0 4 0 0 0⟩&quot; =&gt; 1.0</code></pre><p>Then, you pass that vector and the Hamiltonian to <code>eigsolve</code>. Since <code>eigsolve</code> has no way of knowing the Hamiltonian is Hermitian, we have to provide that information through the <code>issymmetric</code> or <code>ishermitian</code> keyword arguments. Make sure to only pass this argument when the Hamiltonian is actually symmetric. One way to check is to use the <code>LOStructure</code>:</p><pre><code class="language-julia hljs">LOStructure(ham)</code></pre><pre><code class="nohighlight hljs">IsHermitian()</code></pre><pre><code class="language-julia hljs">vals_mf, vecs_mf = eigsolve(ham, dvec, num_eigvals, :SR; issymmetric=true)
vals_mf</code></pre><pre><code class="nohighlight hljs">30-element Vector{Float64}:
 -7.313652669016779
 -5.2030332757528726
 -3.7491695135616556
 -2.7189087802075385
 -2.6990477177540697
 -1.7379843071981789
 -0.8035991245861211
 -0.7993328132523636
 -0.25045340886163103
  0.26752054218184007
  0.2914932298990198
  0.7219822375239424
  0.8061331917279482
  0.8465442897003417
  1.5010454851035835
  1.5342526863371413
  1.7324225079192237
  1.7998902734151025
  2.6751743520553752
  2.74677461265086
  2.8014444204129383
  3.271501872201884
  3.2999247288429077
  3.8509778449222525
  4.690398495171212
  4.888214927922314
  6.442683753741093
  7.366283958413218
  7.452075937628739
  9.2884422624203</code></pre><p>Keep in mind that if an eigenvector is orthogonal to <code>dvec</code>, KrylovKit will miss it. Consider the following example:</p><pre><code class="language-julia hljs">eigsolve(ham, vecs_mf[2], num_eigvals, :SR, issymmetric=true)[1]</code></pre><pre><code class="nohighlight hljs">1-element Vector{Float64}:
 -5.203033275752877</code></pre><h2 id="Reducing-matrix-size-with-symmetries"><a class="docs-heading-anchor" href="#Reducing-matrix-size-with-symmetries">Reducing matrix size with symmetries</a><a id="Reducing-matrix-size-with-symmetries-1"></a><a class="docs-heading-anchor-permalink" href="#Reducing-matrix-size-with-symmetries" title="Permalink"></a></h2><p>As these matrices tend to get large quickly, memory is usually the bottleneck. There are currently two methods implemented to reduce the matrix size, <code>ParitySymmetry</code> and <code>TimeReversalSymmetry</code>. You should only use these where the relevant symmetries actually apply - no checks are performed to make sure they do. To demonstrate them, let&#39;s use a Hamiltonian where both do apply. Please consult the documentation for a more in-depth description of these options.</p><p>The Hamiltonian presented in this example is compatible with the <code>ParitySymmetry</code>. Let&#39;s see how the matrix size is reduced when applying it.</p><pre><code class="language-julia hljs">size(sparse(ham))</code></pre><pre><code class="nohighlight hljs">(30, 30)</code></pre><pre><code class="language-julia hljs">size(sparse(ParitySymmetry(ham)))</code></pre><pre><code class="nohighlight hljs">(20, 20)</code></pre><p>Its eigenvalues are a subset of the full [...]. To get the other half, we can pass the <code>even</code> keyword argument to it. When doing that, we need to make sure the starting address of the Hamiltonian is not even.</p><pre><code class="language-julia hljs">all_eigs = eigvals(Matrix(ham))

even_eigs = eigvals(Matrix(ParitySymmetry(ham)))

add_odd = BoseFS(M, cld(M, 2) =&gt; N - 3, cld(M, 2) - 1 =&gt; 2, cld(M, 2) + 2 =&gt; 1)
odd_eigs = eigvals(Matrix(ParitySymmetry(HubbardMom1D(add_odd); even=false)))

sort([even_eigs; odd_eigs]) ≈ all_eigs</code></pre><pre><code class="nohighlight hljs">true</code></pre><h2 id="Computing-observables"><a class="docs-heading-anchor" href="#Computing-observables">Computing observables</a><a id="Computing-observables-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-observables" title="Permalink"></a></h2><p>Since operators in Rimu operate on <code>DVec</code>s, we need a way to convert the vectors coming from <code>eigen</code> or <code>eigs</code> to them. We can use <code>BasisSetRep.basis</code> to do that. As an example, let&#39;s look at the momentum density.</p><pre><code class="language-julia hljs">dvec = DVec(zip(bsr.basis, eigvecs(Matrix(ham))[:, 1]))</code></pre><pre><code class="nohighlight hljs">DVec{BoseFS{4, 7, BitString{10, 1, UInt16}},Float64} with 30 entries, style = IsDeterministic{Float64}()
  fs&quot;|1 0 0 2 0 0 1⟩&quot; =&gt; -0.0499134
  fs&quot;|0 0 1 2 1 0 0⟩&quot; =&gt; -0.209379
  fs&quot;|1 1 2 0 0 0 0⟩&quot; =&gt; -0.00258159
  fs&quot;|2 0 1 1 0 0 0⟩&quot; =&gt; 0.00781882
  fs&quot;|0 0 2 1 0 1 0⟩&quot; =&gt; 0.0266014
  fs&quot;|0 0 0 1 1 0 2⟩&quot; =&gt; 0.00781882
  fs&quot;|0 0 0 1 0 2 1⟩&quot; =&gt; 0.00428315
  fs&quot;|0 0 2 0 2 0 0⟩&quot; =&gt; 0.0197549
  fs&quot;|1 0 1 0 1 0 1⟩&quot; =&gt; 0.00313766
  fs&quot;|0 0 0 0 2 1 1⟩&quot; =&gt; -0.00258159
  fs&quot;|1 0 0 1 1 1 0⟩&quot; =&gt; 0.0142658
  fs&quot;|0 1 1 1 0 0 1⟩&quot; =&gt; 0.0142658
  fs&quot;|0 0 0 0 1 3 0⟩&quot; =&gt; -0.000745259
  fs&quot;|0 1 0 2 0 1 0⟩&quot; =&gt; -0.0762832
  fs&quot;|1 2 0 1 0 0 0⟩&quot; =&gt; 0.00428315
  fs&quot;|0 1 0 1 2 0 0⟩&quot; =&gt; 0.0266014
  fs&quot;|0 2 0 0 0 2 0⟩&quot; =&gt; 0.00270897
  fs&quot;|0 1 0 0 0 0 3⟩&quot; =&gt; -0.000529544
  fs&quot;|0 3 1 0 0 0 0⟩&quot; =&gt; -0.000745259
  fs&quot;|2 1 0 0 1 0 0⟩&quot; =&gt; -0.00145267
  ⋮   =&gt; ⋮</code></pre><pre><code class="language-julia hljs">[dot(dvec, DensityMatrixDiagonal(i), dvec) for i in 1:7]</code></pre><pre><code class="nohighlight hljs">7-element Vector{Float64}:
 0.0028792972435832285
 0.006812238356101928
 0.046378082175090346
 3.8878607644504473
 0.046378082175090304
 0.006812238356101933
 0.002879297243583208</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="G2-example.html">« Calculating observables</a><a class="docs-footer-nextpage" href="../statstools.html">StatsTools »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 13 October 2022 19:38">Thursday 13 October 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
