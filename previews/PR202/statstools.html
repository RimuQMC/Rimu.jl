<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>StatsTools · Rimu.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Rimu.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Rimu.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Guide</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="generated/BHM-example.html">1D Bose-Hubbard Model</a></li><li><a class="tocitem" href="generated/BHM-example-mpi.html">Rimu with MPI</a></li><li><a class="tocitem" href="generated/G2-example.html">Calculating observables</a></li><li><a class="tocitem" href="generated/exact-example.html">Exact diagonalisation</a></li><li><a class="tocitem" href="generated/HO-example.html">Degenerate perturbation theory in a harmonic oscillator basis</a></li></ul></li><li><span class="tocitem">User documentation</span><ul><li class="is-active"><a class="tocitem" href="statstools.html">StatsTools</a><ul class="internal"><li><a class="tocitem" href="#Blocking-analysis"><span>Blocking analysis</span></a></li><li><a class="tocitem" href="#Exported"><span>Exported</span></a></li><li><a class="tocitem" href="#Additional-docstrings"><span>Additional docstrings</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="interfaces.html">Interfaces</a></li><li><a class="tocitem" href="hamiltonians.html">Hamiltonians</a></li><li><a class="tocitem" href="dictvectors.html">Dict vectors</a></li><li><a class="tocitem" href="addresses.html">BitString addresses</a></li><li><a class="tocitem" href="stochasticstyles.html">Stochastic styles</a></li><li><a class="tocitem" href="RMPI.html">RMPI</a></li><li><a class="tocitem" href="rimuio.html">I/O</a></li><li><a class="tocitem" href="randomnumbers.html">Random numbers</a></li><li><a class="tocitem" href="documentation.html">Documentation generation</a></li><li><a class="tocitem" href="testing.html">Code testing</a></li></ul></li><li><a class="tocitem" href="API.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User documentation</a></li><li class="is-active"><a href="statstools.html">StatsTools</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="statstools.html">StatsTools</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/joachimbrand/Rimu.jl/blob/develop/docs/src/statstools.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Module-Rimu/StatsTools"><a class="docs-heading-anchor" href="#Module-Rimu/StatsTools">Module <code>Rimu/StatsTools</code></a><a id="Module-Rimu/StatsTools-1"></a><a class="docs-heading-anchor-permalink" href="#Module-Rimu/StatsTools" title="Permalink"></a></h1><p>The  module <code>Rimu/StatsTools</code> contains helper function for analysis and post processing of Monte Carlo data.</p><h2 id="Blocking-analysis"><a class="docs-heading-anchor" href="#Blocking-analysis">Blocking analysis</a><a id="Blocking-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Blocking-analysis" title="Permalink"></a></h2><p>After equilibration, FCIQMC produces information about observables through correlated time series. In order to estimate the statistical errors the time series need to be decorrelated. The main workhorse for achieving this is the <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a>, which is based on the paper by Flyvberg and Peterson <a href="http://aip.scitation.org/doi/10.1063/1.457480">JCP (1989)</a>, and automated with the M test of Jonsson <a href="https://link.aps.org/doi/10.1103/PhysRevE.98.043304">PRE (2018)</a>.</p><p>Analysing the stochastic errors of observables obtained from the ratio of sample means is done with <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means</code></a>, where error propagation of correlated uncertainties is done with the help of the package <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>.</p><p>Many convenience functions are implemented for directly analysing data obtained from <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a> as a <code>DataFrame</code>. See, e.g., <a href="statstools.html#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>shift_estimator</code></a> and <a href="statstools.html#Rimu.StatsTools.projected_energy-Tuple{DataFrames.DataFrame}"><code>projected_energy</code></a>. Asymptotically unbiased estimators are implemented as <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator</code></a>, <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator</code></a> and <a href="statstools.html#Rimu.StatsTools.rayleigh_replica_estimator-Tuple{Vector, Vector, Vector, Any, Any}"><code>rayleigh_replica_estimator</code></a>.</p><h2 id="Exported"><a class="docs-heading-anchor" href="#Exported">Exported</a><a id="Exported-1"></a><a class="docs-heading-anchor-permalink" href="#Exported" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools" href="#Rimu.StatsTools"><code>Rimu.StatsTools</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Tools for the statistical analysis of Monte Carlo data.</p><p><strong>Exports:</strong></p><ul><li><a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.blocking_analysis_data-Tuple{AbstractVector}"><code>blocking_analysis_data</code></a></li><li><a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means</code></a></li><li><a href="statstools.html#Rimu.StatsTools.growth_witness"><code>growth_witness</code></a></li><li><a href="statstools.html#Rimu.StatsTools.smoothen-Tuple{AbstractVector, Integer}"><code>smoothen</code></a></li><li><a href="statstools.html#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>shift_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.projected_energy-Tuple{DataFrames.DataFrame}"><code>projected_energy</code></a></li><li><a href="statstools.html#Rimu.StatsTools.variational_energy_estimator-Tuple{Any, Any}"><code>variational_energy_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.growth_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>growth_estimator_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.mixed_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>mixed_estimator_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.rayleigh_replica_estimator-Tuple{Vector, Vector, Vector, Any, Any}"><code>rayleigh_replica_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.rayleigh_replica_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>rayleigh_replica_estimator_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>val_and_errs</code></a></li><li><a href="statstools.html#Rimu.StatsTools.val-Tuple{Any}"><code>val</code></a></li><li><a href="statstools.html#Rimu.StatsTools.mean_and_se-Tuple{Rimu.StatsTools.BlockingResult}"><code>mean_and_se</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/StatsTools.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}" href="#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>Rimu.StatsTools.blocking_analysis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">blocking_analysis(v::AbstractVector; α = 0.01, corrected = true, skip=0, warn=true)
-&gt; BlockingResult(mean, err, err_err, p_cov, k, blocks)</code></pre><p>Compute the sample mean <code>mean</code> and estimate the standard deviation of the mean (standard error) <code>err</code> of a correlated time series. It uses the blocking algorithm from Flyvberg and Peterson <a href="http://aip.scitation.org/doi/10.1063/1.457480">JCP (1989)</a> and the M test of Jonsson <a href="https://link.aps.org/doi/10.1103/PhysRevE.98.043304">PRE (2018)</a> at significance level <span>$1-α$</span>.</p><p>Use <code>skip</code> to skip the first <code>skip</code> elements in <code>v</code>. <code>corrected</code> controls whether bias correction for variances is used. If decorrelating the time series fails according to the M test, <code>NaN</code> is returned as the standard error and <code>-1</code> for <code>k</code>. The keyword argument <code>warn</code> controls whether a warning message is logged.</p><p>The summary result is returned as a <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>. <code>k - 1</code> is the number of blocking transformations required to pass the hypothesis test for an uncorrelated time series and <code>err_err</code> the estimated standard error or <code>err</code>.</p><p>The detailed results from each reblocking step can be obtained with <a href="statstools.html#Rimu.StatsTools.blocking_analysis_data-Tuple{AbstractVector}"><code>blocking_analysis_data</code></a>.</p><p>See <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>, <a href="statstools.html#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>shift_estimator</code></a>, <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means</code></a>, <a href="statstools.html#Rimu.StatsTools.blocking_analysis_data-Tuple{AbstractVector}"><code>blocking_analysis_data</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L109-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.blocking_analysis_data-Tuple{AbstractVector}" href="#Rimu.StatsTools.blocking_analysis_data-Tuple{AbstractVector}"><code>Rimu.StatsTools.blocking_analysis_data</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">blocking_analysis_data(v::AbstractVector; kwargs...) -&gt;
(; br::BlockingResult, df::DataFrame)</code></pre><p>Perform a <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a> and return the summary result <code>br</code> as well as a <code>DataFrame</code> <code>df</code> with information about the standard error in each blocking step.</p><p>For a description of the keyword arguments see <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; data = smoothen(rand(10_000), 2^6); # generate correlated data

julia&gt; br, df = blocking_analysis_data(data)
(br = BlockingResult{Float64}
  mean = 0.5088 ± 0.0029
  with uncertainty of ± 0.00023454488294744232
  from 78 blocks after 7 transformations (k = 8).
, df = 13×6 DataFrame
 Row │ blocks  mean      std_err      std_err_err  p_cov       mj
     │ Int64   Float64   Float64      Float64      Float64     Float64
─────┼──────────────────────────────────────────────────────────────────────
   1 │  10000  0.508806  0.000375044  2.6521e-6    1.40658e-7  9715.08
   2 │   5000  0.508806  0.000528547  5.28599e-6   2.79361e-7  4778.14
   3 │   2500  0.508806  0.000743386  1.05152e-5   5.52622e-7  2298.64
   4 │   1250  0.508806  0.00104064   2.08212e-5   1.08293e-6  1056.24
   5 │    625  0.508806  0.00144177   4.08121e-5   2.07871e-6   427.949
   6 │    312  0.508736  0.00194209   7.78707e-5   3.77171e-6   128.711
   7 │    156  0.508736  0.00247921   0.00014081   6.14647e-6    17.3075
   8 │     78  0.508736  0.00291063   0.000234545  8.47174e-6     0.731386
   9 │     39  0.508736  0.00284613   0.000326474  8.10046e-6     0.901054
  10 │     19  0.508241  0.0026998    0.000449967  7.28892e-6     2.85915
  11 │      9  0.507939  0.00359907   0.000899766  1.29533e-5     1.08644
  12 │      4  0.509327  0.00440559   0.00179857   1.94092e-5     0.0370381
  13 │      2  0.509327  0.00432708   0.00305971   1.87237e-5     0.125)

julia&gt; using StatsPlots; unicodeplots();

julia&gt; plot([br.k,br.k],[0.0,maximum(df.std_err.+df.std_err_err)], label=&quot;m test&quot;);

julia&gt; @df df plot!(
           1:length(:std_err), :std_err;
           err=:std_err_err, xlabel=&quot;k&quot;, label=&quot;std err&quot;,
           title=&quot;std err vs blocking steps&quot;
       )
               ⠀⠀⠀⠀⠀⠀⠀⠀⠀std err vs blocking steps⠀⠀⠀⠀⠀⠀⠀⠀
               ┌────────────────────────────────────────┐
    0.00423501 │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠀⠀⠀⠀│ m test
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠀⠀⢸⠀⠀⠀⠀│ std err
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⢸⠀⠀⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⢸⠀⠀⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⡠⢺⠒⠒⢺⠀⠀⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⡀⠀⠀⡆⣀⠤⡗⠉⠀⢸⠀⠀⢸⡆⠀⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡧⠤⠔⡗⠊⠉⡏⠀⠀⡇⠀⠀⢸⠀⠀⢸⢣⠀⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠔⠁⡇⠀⠀⠁⠀⠀⠁⠀⠀⠁⠀⠀⠀⠀⠀⢸⠸⡀⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠴⠁⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⠀⡇⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠔⠁⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠔⠊⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣦⠀│
               │⠀⠀⠀⠀⠀⠀⠀⠀⡠⠔⠒⠁⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⠀│
               │⠀⠀⠀⢀⣀⠤⠒⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀│
               │⠀⠒⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀│
   -0.00012335 │⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠧⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤│
               └────────────────────────────────────────┘
               ⠀0.64⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀k⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀13.36⠀</code></pre><p>A vertical line at <code>k==8</code> indicates the blocking step identified by hypothesis testing to decorrelate the time series data. The decorrelation length can thus be estimated at <span>$2^{k-1} = 2^7 = 128$</span>. Note that the data was correlated with a sliding window of <span>$2^6$</span> steps.</p><p>See <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a>, <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L161-L231">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.mean_and_se-Tuple{Rimu.StatsTools.BlockingResult}" href="#Rimu.StatsTools.mean_and_se-Tuple{Rimu.StatsTools.BlockingResult}"><code>Rimu.StatsTools.mean_and_se</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mean_and_se(v::AbstractVector; α = 0.01, corrected::Bool=true, skip=0) -&gt; mean, err
mean_and_se(r::BlockingResult) -&gt; mean, err</code></pre><p>Return the mean and standard error (as a tuple) of a time series obtained from <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a>. See also <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L237-L242">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Statistics.cov-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Complex}}" href="#Statistics.cov-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Complex}}"><code>Statistics.cov</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cov(r::BlockingResult{&lt;:Complex})</code></pre><p>Return the covariance matrix of the multivariate normal distribution approximating the uncertainty of the blocking result <code>r</code> of a complex time series. See (https://en.wikipedia.org/wiki/Complex<em>normal</em>distribution).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L62-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}" href="#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>Rimu.StatsTools.ratio_of_means</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ratio_of_means(num, denom; α=0.01, corrected=true, mc_samples=nothing, skip=0, warn=true)
-&gt; r::RatioBlockingResult</code></pre><p>Estimate the ratio of <code>mean(num)/mean(denom)</code> assuming that <code>num</code> and <code>denom</code> are possibly correlated time series, skipping the first <code>skip</code> elements. A blocking analysis with m-test is used to uncorrelate the time series, see <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a>. The remaining standard error and correlation of the means is propagated using <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>. The results are reported as a <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p><p>Robust estimates for the ratio are obtained from <code>pmedian(r)</code> and confidence intervals from <code>pquantile()</code>, e.g. <code>pquantile(r, [0.025, 0.975])</code> for the 95% confidence interval.</p><p>Estimates from linear uncertainty propagation are returned as <code>r.f</code> and <code>r.σ_f</code> using <a href="statstools.html#Rimu.StatsTools.x_by_y_linear-NTuple{5, Any}"><code>x_by_y_linear</code></a>. The standard error estimate <code>r.σ_f</code> should only be trusted when the coefficient of variation <code>std(denom)/mean(denom)</code> is small: <code>abs(r.δ_y) &lt; 0.1</code>. Under this condition can the ratio be approximated as a normal distribution. See <a href="https://en.wikipedia.org/wiki/Propagation_of_uncertainty">wikipedia</a> and <a href="http://link.springer.com/10.1007/s00362-012-0429-2">Díaz-Francés, Rubio (2013)</a></p><p>The keyword <code>mc_samples</code> controls the number of samples used for error propagation by <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>. Use <code>nothing</code> for the default and <code>Val(1000)</code> to set the number to 1000 samples in a type-consistent way.</p><p>The keyword <code>warn</code> controls whether warning messages are logged when blocking fails or noisy denominators are encountered.</p><p>Note: to compute statistics on the <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>, use functions <code>pmedian</code>, <code>pquantile</code>, <code>pmiddle</code>, <code>piterate</code>, <code>pextrema</code>, <code>pminimum</code>, <code>pmaximum</code>, <code>pmean</code>, and <code>pcov</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/ratio_of_means.jl#L95-L125">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.errs-Tuple" href="#Rimu.StatsTools.errs-Tuple"><code>Rimu.StatsTools.errs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">errs(x; n=1, p=nothing, name=:err) -&gt; (; err_l, err_u)</code></pre><p>Return the lower and upper error bar for the uncertain value <code>x</code>.</p><p>See <a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>val_and_errs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/convenience.jl#L114-L119">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.to_measurement-Tuple{MonteCarloMeasurements.Particles}" href="#Rimu.StatsTools.to_measurement-Tuple{MonteCarloMeasurements.Particles}"><code>Rimu.StatsTools.to_measurement</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">to_measurement(p::MonteCarloMeasurements.Particles) -&gt; ::Measurements.measurement</code></pre><p>Convert an uncertain number from <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>  to <a href="https://github.com/JuliaPhysics/Measurements.jl"><code>Measurements</code></a> format  using the median as the central point. The new <code>±</code> boundaries will include  the 68% quantile around the median.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/convenience.jl#L3-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.val-Tuple{Any}" href="#Rimu.StatsTools.val-Tuple{Any}"><code>Rimu.StatsTools.val</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">val(x)</code></pre><p>Return the best estimate value for an uncertain <code>x</code>. Defaults to the <code>median</code> for uncertain <code>x</code> represented by a (sampled) distribution. Supports  <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a> and <a href="https://github.com/JuliaPhysics/Measurements.jl"><code>Measurements</code></a>.</p><p>See <a href="statstools.html#Rimu.StatsTools.errs-Tuple"><code>errs</code></a>, <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>, <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/convenience.jl#L16-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.val_and_errs-Tuple{Any}" href="#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>Rimu.StatsTools.val_and_errs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">val_and_errs(x; n=1, p=nothing, name=:val) -&gt; (;val, val_l, val_u)</code></pre><p>Return the median and the lower and upper error bar for the uncertain value <code>x</code> as a <code>NamedTuple</code>. This is useful for plotting scripts. The interval <code>[val - val_l, val + val_u]</code> represents the confidence interval at level <code>n*σ</code>, or at probability <code>p</code>. Setting <code>p</code> overrides <code>n</code>. Supports  <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a> and <a href="https://github.com/JuliaPhysics/Measurements.jl"><code>Measurements</code></a>. The  names in the <code>NamedTuple</code> can be changed with <code>name</code>.</p><p><strong>Example:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; results = [blocking_analysis(i:0.1:2i+20) for i in 1:3]; # mock results

julia&gt; v = val_and_errs.(results, name=&quot;res&quot;); # Vector of NamedTuple&#39;s with standard errors

julia&gt; DataFrame(v)
3×3 DataFrame
 Row │ res      res_l    res_u
     │ Float64  Float64  Float64
─────┼───────────────────────────
   1 │    11.5  1.7282   1.7282
   2 │    13.0  1.7282   1.7282
   3 │    14.5  1.78885  1.78885</code></pre><p>See <a href="statstools.html#Core.NamedTuple-Tuple{Rimu.StatsTools.BlockingResult}"><code>NamedTuple</code></a>, <a href="statstools.html#Rimu.StatsTools.val-Tuple{Any}"><code>val</code></a>, <a href="statstools.html#Rimu.StatsTools.errs-Tuple"><code>errs</code></a>, <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>, <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/convenience.jl#L32-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.growth_witness" href="#Rimu.StatsTools.growth_witness"><code>Rimu.StatsTools.growth_witness</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">growth_witness(df::DataFrame, [b]; shift=:shift, norm=:norm, dτ=df.dτ[end], skip=0)</code></pre><p>Calculate the growth witness directly from a <code>DataFrame</code> returned by <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a>. The keyword arguments <code>shift</code> and <code>norm</code> can be used to change the names of the relevant columns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/growth_witness.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.growth_witness-Tuple{AbstractArray, AbstractArray, Any}" href="#Rimu.StatsTools.growth_witness-Tuple{AbstractArray, AbstractArray, Any}"><code>Rimu.StatsTools.growth_witness</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">growth_witness(shift::AbstractArray, norm::AbstractArray, dt, [b]; skip=0) -&gt; g
growth_witness(df::DataFrame, [b]; skip=0) -&gt; g</code></pre><p>Compute the growth witness</p><p class="math-container">\[G^{(n)} = S^{(n)} - \frac{\vert\mathbf{c}^{(n+1)}\vert -
          \vert\mathbf{c}^{(n)}\vert}{\vert\mathbf{c}^{(n)}\vert d\tau},\]</p><p>where <code>S</code> is the <code>shift</code> and <span>$\vert\mathbf{c}^{(n)}\vert ==$</span> <code>norm[n, 1]</code>. Setting <code>b ≥ 1</code> a sliding average over <code>b</code> time steps is computed using <a href="statstools.html#Rimu.StatsTools.smoothen-Tuple{AbstractVector, Integer}"><code>smoothen()</code></a>. The first <code>skip</code> time steps are skipped. <code>mean(growth_witness)</code> is approximately the same as <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator</code></a> with <code>h=0</code>.</p><p>See also <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/growth_witness.jl#L4-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.smoothen-Tuple{AbstractVector, Integer}" href="#Rimu.StatsTools.smoothen-Tuple{AbstractVector, Integer}"><code>Rimu.StatsTools.smoothen</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">smoothen(noisy::AbstractVector, b)</code></pre><p>Smoothen the array <code>noisy</code> by averaging over a sliding window of length <code>b</code> and wrapping <code>noisy</code> periodically. The <code>mean(noisy)</code> is preserved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/growth_witness.jl#L52-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.growth_estimator-NTuple{4, Any}" href="#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>Rimu.StatsTools.growth_estimator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">growth_estimator(
    shift, wn, h, dτ;
    skip = 0,
    E_r = mean(shift[skip+1:end]),
    weights = w_exp,
    change_type = identity,
    kwargs...
) -&gt; r::RatioBlockingResult
growth_estimator(
    df::DataFrame, h; 
    shift_name=:shift, 
    norm_name=:norm, 
    dτ=df.dτ[end], 
    kwargs...
) -&gt; r::RatioBlockingResult</code></pre><p>Compute the growth estimator with reference energy <code>E_r</code> by the reweighting technique described in <a href="http://dx.doi.org/10.1063/1.465195">Umrigar <em>et al.</em> (1993)</a>, see Eq. (20). <code>shift</code> and <code>wn</code> are equal length vectors containing the shift and walker number time series, respectively. Reweighting is done over <code>h</code> time steps and <code>length(shift) - skip</code> time steps are used for the blocking analysis done with <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a>. <code>dτ</code> is the time step and <code>weights</code> a function that calulates the weights. See <a href="statstools.html#Rimu.StatsTools.w_exp-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_exp()</code></a> and <a href="statstools.html#Rimu.StatsTools.w_lin-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_lin()</code></a>.</p><p class="math-container">\[E_{gr} = E_r - \frac{1}{dτ}\ln
    \frac{\sum_n w_{h+1}^{(n+1)} N_\mathrm{w}^{(n+1)}}
        {\sum_m w_{h}^{(m)} N_\mathrm{w}^{(m)}}\]</p><p>When <code>h</code> is greater than the autocorrelation time scale of the <code>shift</code>, then <code>E_gr</code> (returned as <code>r.ratio</code>) is an unbiased but approximate estimator for the ground state energy <span>$E_0$</span> with an error <span>$\mathcal{O}(dτ^2)$</span> and potentially increased confidence intervals compared to the (biased) shift estimator. Error propagation is done with <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>. Progagation through the logarithm can be modified by setting <code>change_type</code> to <a href="statstools.html#Rimu.StatsTools.to_measurement-Tuple{MonteCarloMeasurements.Particles}"><code>to_measurement</code></a> in order to avoid <code>NaN</code> results from negative outliers.</p><p>If <code>success==true</code> the blocking analysis was successful in <code>k-1</code> steps, using <code>blocks</code> uncorrelated data points.</p><p>The second method calculates the growth estimator directly from a <code>DataFrame</code> returned by <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a>. The keyword arguments <code>shift_name</code> and <code>norm_name</code> can be used to change the names  of the relevant columns.</p><p>See also <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator()</code></a> and <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L64-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.growth_estimator_analysis-Tuple{DataFrames.DataFrame}" href="#Rimu.StatsTools.growth_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.growth_estimator_analysis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">growth_estimator_analysis(df::DataFrame; kwargs...)
-&gt; (;df_ge, correlation_estimate, se, se_l, se_u)</code></pre><p>Compute the <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator</code></a> on a <code>DataFrame</code> <code>df</code> returned from <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a> repeatedly over a range of reweighting depths.</p><p>Returns a <code>NamedTuple</code> with the fields</p><ul><li><code>df_ge</code>: <code>DataFrame</code> with reweighting depth and <code>growth_estiamator</code> data. See example below.</li><li><code>correlation_estimate</code>: estimated correlation time from blocking analysis</li><li><code>se, se_l, se_u</code>: <a href="statstools.html#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>shift_estimator</code></a> and error</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>h_range</code>: The default is about <code>h_values</code> values from 0 to twice the estimated correlation time</li><li><code>h_values = 100</code>: minimum number of reweighting depths</li><li><code>skip = 0</code>: initial time steps to exclude from averaging</li><li><code>threading = Threads.nthreads() &gt; 1</code>: if <code>false</code> a progress meter is displayed</li><li><code>shift_name = :shift</code> name of column in <code>df</code> with shift data</li><li><code>norm_name = :norm</code> name of column in <code>df</code> with walkernumber data</li><li><code>warn = true</code> whether to log warning messages when blocking fails or denominators are small</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">df, _ = lomc!(...)
df_ge, correlation_estimate, se, se_l, se_u = growth_estimator_analysis(df; skip=5_000)

using StatsPlots
@df df_ge plot(_ -&gt; se, :h, ribbon = (se_l, se_u), label = &quot;⟨S⟩&quot;) # constant line and ribbon for shift estimator
@df df_ge plot!(:h, :val, ribbon = (:val_l, :val_u), label=&quot;E_gr&quot;) # growth estimator as a function of reweighting depth
xlabel!(&quot;h&quot;)</code></pre><p>See also: <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator</code></a>, <a href="statstools.html#Rimu.StatsTools.mixed_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>mixed_estimator_analysis</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L162-L194">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.mixed_estimator-NTuple{5, Any}" href="#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>Rimu.StatsTools.mixed_estimator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mixed_estimator(
    hproj, vproj, shift, h, dτ;
    skip = 0,
    E_r = mean(shift[skip+1:end]),
    weights = w_exp,
    kwargs...
) -&gt; r::RatioBlockingResult
mixed_estimator(
    df::DataFrame, h;
    hproj_name=:hproj, 
    vproj_name=:vproj, 
    shift_name=:shift, 
    dτ=df.dτ[end], 
    kwargs...
)</code></pre><p>Compute the mixed estimator by the reweighting technique described in <a href="http://dx.doi.org/10.1063/1.465195">Umrigar <em>et al.</em> (1993)</a>, Eq. (19)</p><p class="math-container">\[E_\mathrm{mix} = \frac{\sum_n w_{h}^{(n)}  (Ĥ&#39;\mathbf{v})⋅\mathbf{c}^{(n)}}
        {\sum_m w_{h}^{(m)}  \mathbf{v}⋅\mathbf{c}^{(m)}} ,\]</p><p>where the time series <code>hproj ==</code> <span>$(Ĥ&#39;\mathbf{v})⋅\mathbf{c}^{(n)}$</span> and <code>vproj ==</code> <span>$\mathbf{v}⋅\mathbf{c}^{(m)}$</span> have the same length as <code>shift</code> (See <a href="API.html#Rimu.ProjectedEnergy"><code>ProjectedEnergy</code></a> on how to set these up). Reweighting is done over <code>h</code> time steps and <code>length(shift) - skip</code> time steps are used for the blocking analysis done with <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a>. <code>dτ</code> is the time step and <code>weights</code> a function that calulates the weights. See <a href="statstools.html#Rimu.StatsTools.w_exp-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_exp()</code></a> and <a href="statstools.html#Rimu.StatsTools.w_lin-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_lin()</code></a>. Additional keyword arguments are passed on to <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a>.</p><p>When <code>h</code> is greater than the autocorrelation time scale of the <code>shift</code>, then <code>r.ratio</code> is an unbiased but approximate estimator for the ground state energy <span>$E_0$</span> with an error <span>$\mathcal{O}(dτ^2)$</span> and potentially increased confidence intervals compared to the unweighted ratio. Error propagation is done with <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>. Results are returned as <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p><p>The second method calculates the mixed energy estimator directly from a <code>DataFrame</code>  returned by <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a>. The keyword arguments <code>hproj_name</code>, <code>vproj_name</code>, and  <code>shift_name</code> can be used to change the names of the relevant columns.</p><p>See also <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator()</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L255-L299">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.mixed_estimator_analysis-Tuple{DataFrames.DataFrame}" href="#Rimu.StatsTools.mixed_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.mixed_estimator_analysis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mixed_estimator_analysis(df::DataFrame; kwargs...)
-&gt; (; df_me, correlation_estimate, se, se_l, se_u)</code></pre><p>Compute the <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator</code></a> on a <code>DataFrame</code> <code>df</code> returned from <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a> repeatedly over a range of reweighting depths.</p><p>Returns a <code>NamedTuple</code> with the fields</p><ul><li><code>df_me</code>: <code>DataFrame</code> with reweighting depth and <code>mixed_estiamator</code> data. See example below.</li><li><code>correlation_estimate</code>: estimated correlation time from blocking analysis</li><li><code>se, se_l, se_u</code>: <a href="statstools.html#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>shift_estimator</code></a> and error</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>h_range</code>: The default is about <code>h_values</code> values from 0 to twice the estimated correlation time</li><li><code>h_values = 100</code>: minimum number of reweighting depths</li><li><code>skip = 0</code>: initial time steps to exclude from averaging</li><li><code>threading = Threads.nthreads() &gt; 1</code>: if <code>false</code> a progress meter is displayed</li><li><code>shift_name = :shift</code> name of column in <code>df</code> with shift data</li><li><code>hproj_name = :hproj</code> name of column in <code>df</code> with operator overlap data</li><li><code>vproj_name = :vproj</code> name of column in <code>df</code> with projector overlap data</li><li><code>warn = true</code> whether to log warning messages when blocking fails or denominators are small</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">df, _ = lomc!(...)
df_me, correlation_estimate, se, se_l, se_u = mixed_estimator_analysis(df; skip=5_000)

using StatsPlots
@df df_me plot(_ -&gt; se, :h, ribbon = (se_l, se_u), label = &quot;⟨S⟩&quot;) # constant line and ribbon for shift estimator
@df df_me plot!(:h, :val, ribbon = (:val_l, :val_u), label=&quot;E_mix&quot;) # mixed estimator as a function of reweighting depth
xlabel!(&quot;h&quot;)</code></pre><p>See also: <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator</code></a>, <a href="statstools.html#Rimu.StatsTools.growth_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>growth_estimator_analysis</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L322-L354">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.projected_energy-Tuple{DataFrames.DataFrame}" href="#Rimu.StatsTools.projected_energy-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.projected_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">projected_energy(
    df::DataFrame;
    skip=0, hproj=:hproj, vproj=:vproj, kwargs...
) -&gt; r::RatioBlockingResult</code></pre><p>Compute the projected energy estimator</p><p class="math-container">\[E_\mathrm{p} = \frac{\sum_n  \mathbf{v}⋅Ĥ\mathbf{c}^{(n)}}
        {\sum_m \mathbf{v}⋅\mathbf{c}^{(m)}} ,\]</p><p>where the time series <code>df.hproj ==</code> <span>$\mathbf{v}⋅Ĥ\mathbf{c}^{(n)}$</span> and <code>df.vproj ==</code> <span>$\mathbf{v}⋅\mathbf{c}^{(m)}$</span> are taken from <code>df</code>, skipping the first <code>skip</code> entries (use <code>post_step =</code><a href="API.html#Rimu.ProjectedEnergy"><code>ProjectedEnergy()</code></a> to set these up in <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!()</code></a>). <code>projected_energy</code> is equivalent to <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator</code></a> with <code>h=0</code>.</p><p>The keyword arguments <code>hproj</code> and <code>vproj</code> can be used to change the names of the relevant columns. Other <code>kwargs</code> are passed on to <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means</code></a>. Returns a <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p><p>See <a href="statstools.html#Core.NamedTuple-Tuple{Rimu.StatsTools.BlockingResult}"><code>NamedTuple</code></a>, <a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>val_and_errs</code></a>, <a href="statstools.html#Rimu.StatsTools.val-Tuple{Any}"><code>val</code></a>, <a href="statstools.html#Rimu.StatsTools.errs-Tuple"><code>errs</code></a> for processing results.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L640-L663">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.rayleigh_replica_estimator-Tuple{Vector, Vector, Vector, Any, Any}" href="#Rimu.StatsTools.rayleigh_replica_estimator-Tuple{Vector, Vector, Vector, Any, Any}"><code>Rimu.StatsTools.rayleigh_replica_estimator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rayleigh_replica_estimator(
    op_ol, vec_ol, shift, h, dτ;
    skip = 0,
    E_r = mean(shift[skip+1:end]),
    weights = w_exp,
    kwargs...
) -&gt; r::RatioBlockingResult
rayleigh_replica_estimator(
    df::DataFrame;
    shift_name=&quot;shift&quot;,
    op_name=&quot;Op1&quot;, 
    vec_name=&quot;dot&quot;, 
    h=0,
    skip=0, 
    Anorm=1,
    kwargs...
) -&gt; r::RatioBlockingResult</code></pre><p>Compute the estimator of a Rayleigh quotient of operator <span>$\hat{A}$</span> with reweighting,</p><p class="math-container">\[A_\mathrm{est}(h) = \frac{\sum_{a&lt;b} \sum_n w_{h,a}^{(n)} w_{h,b}^{(n)}  
    \mathbf{c}_a^{(n)} \cdot \hat{A} \cdot \mathbf{c}_b^{(n)}}
    {\sum_{a&lt;b} \sum_n w_{h,a}^{(n)} w_{h,b}^{(n)} \mathbf{c}_a^{(n)} \cdot \mathbf{c}_b^{(n)}},\]</p><p>using data from multiple replicas. </p><p>Argument <code>op_ol</code> holds data for the operator overlap <span>$\mathbf{c}_a^{(n)} \hat{A} \mathbf{c}_b^{(n)}$</span>  and <code>vec_ol</code> holds data for the vector overlap <span>$\mathbf{c}_a^{(n)} \mathbf{c}_b^{(n)}$</span>. They are of type <code>Vector{Vector}</code>, with each element <code>Vector</code>  holding the data for a pair of replicas. Argument <code>shift</code> is of type <code>Vector{Vector}</code>, with each element <code>Vector</code>  holding the shift data for each individual replica.</p><p>The second method computes the Rayleigh quotient directly from a <code>DataFrame</code> returned by  <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a>. The keyword arguments <code>shift_name</code>, <code>op_name</code> and <code>vec_name</code> can be used to  change the names of the relevant columns, see <a href="API.html#Rimu.AllOverlaps"><code>AllOverlaps</code></a> for default  formatting. The operator overlap data can be scaled by a prefactor <code>Anorm</code>. A specific  reweighting depth can be set with keyword argument <code>h</code>. The default is <code>h = 0</code> which  calculates the Rayleigh quotient without reweighting.</p><p>The reweighting is an extension of the mixed estimator using the reweighting technique  described in <a href="http://dx.doi.org/10.1063/1.465195">Umrigar <em>et al.</em> (1993)</a>.  Reweighting is done over <code>h</code> time steps and <code>length(shift) - skip</code> time steps are used  for the blocking analysis done with <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a>.  <code>dτ</code> is the time step and <code>weights</code> a function that calulates the weights. See <a href="statstools.html#Rimu.StatsTools.w_exp-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_exp()</code></a> and <a href="statstools.html#Rimu.StatsTools.w_lin-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_lin()</code></a>. Additional keyword arguments are passed on to <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a>.</p><p>Error propagation is done with <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>. Results are returned as <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p><p>See also <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator</code></a>, <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator()</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L416-L468">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.rayleigh_replica_estimator_analysis-Tuple{DataFrames.DataFrame}" href="#Rimu.StatsTools.rayleigh_replica_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.rayleigh_replica_estimator_analysis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rayleigh_replica_estimator_analysis(df::DataFrame; kwargs...)
-&gt; (; df_rre, df_se)</code></pre><p>Compute the <a href="statstools.html#Rimu.StatsTools.rayleigh_replica_estimator-Tuple{Vector, Vector, Vector, Any, Any}"><code>rayleigh_replica_estimator</code></a> on a <code>DataFrame</code> <code>df</code> returned from <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a> repeatedly over a range of reweighting depths.</p><p>Returns a <code>NamedTuple</code> with the fields</p><ul><li><code>df_rre</code>: <code>DataFrame</code> with reweighting depth and <code>rayleigh_replica_estimator</code> data. See example below.</li><li><code>df_se</code>: <code>DataFrame</code> with <a href="statstools.html#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>shift_estimator</code></a> output, one row per replica</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>h_range</code>: The default is about <code>h_values</code> values from 0 to twice the estimated correlation time</li><li><code>h_values = 100</code>: minimum number of reweighting depths</li><li><code>skip = 0</code>: initial time steps to exclude from averaging</li><li><code>threading = Threads.nthreads() &gt; 1</code>: if <code>false</code> a progress meter is displayed</li><li><code>shift_name = &quot;shift&quot;</code>: shift data corresponding to column in <code>df</code> with names <code>&lt;shift&gt;_1</code>, ...</li><li><code>op_name = &quot;Op1&quot;</code>: name of operator overlap corresponding to column in <code>df</code> with names <code>c1_&lt;op_ol&gt;_c2</code>, ...</li><li><code>vec_name = &quot;dot&quot;</code>: name of vector-vector overlap corresponding to column in <code>df</code> with names <code>c1_&lt;vec_ol&gt;_c2</code>, ... </li><li><code>Anorm = 1</code>: a scalar prefactor to scale the operator overlap data</li><li><code>warn = true</code>: whether to log warning messages when blocking fails or denominators are small</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">df, _ = lomc!(...)
df_rre, df_se = rayleigh_replica_estimator_analysis(df; skip=5_000)

using StatsPlots
@df df_rre plot(_ -&gt; se, :h, ribbon = (se_l, se_u), label = &quot;⟨S⟩&quot;) # constant line and ribbon for shift estimator
@df df_rre plot!(:h, :val, ribbon = (:val_l, :val_u), label=&quot;E_mix&quot;) # Rayleigh quotient estimator as a function of reweighting depth
xlabel!(&quot;h&quot;)</code></pre><p>See also: <a href="statstools.html#Rimu.StatsTools.rayleigh_replica_estimator-Tuple{Vector, Vector, Vector, Any, Any}"><code>rayleigh_replica_estimator</code></a>, <a href="statstools.html#Rimu.StatsTools.mixed_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>mixed_estimator_analysis</code></a>, <a href="API.html#Rimu.AllOverlaps"><code>AllOverlaps</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L530-L562">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}" href="#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.shift_estimator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">shift_estimator(df::DataFrame; shift=:shift, kwargs...) -&gt; r::BlockingResult</code></pre><p>Return the shift estimator from the data in <code>df.shift</code>. The keyword argument <code>shift</code> can be used to change the name of the relevant column. Other keyword arguments are passed on to <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a>. Returns a <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>.</p><p>See also <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator</code></a>, <a href="statstools.html#Rimu.StatsTools.projected_energy-Tuple{DataFrames.DataFrame}"><code>projected_energy</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L670-L677">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.w_exp-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}" href="#Rimu.StatsTools.w_exp-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>Rimu.StatsTools.w_exp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">w_exp(shift, h, dτ; E_r = mean(shift), skip = 0)</code></pre><p>Compute the weights for reweighting over <code>h</code> time steps with reference energy <code>E_r</code> from the exponential formula</p><p class="math-container">\[w_h^{(n)} = \prod_{j=1}^h \exp[-dτ(S^{(q+n-j)}-E_r)] ,\]</p><p>where <code>q = skip</code>.</p><p>See also <a href="statstools.html#Rimu.StatsTools.w_lin-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_lin()</code></a>, <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator()</code></a>, <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator()</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L6-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.w_lin-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}" href="#Rimu.StatsTools.w_lin-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>Rimu.StatsTools.w_lin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">w_lin(shift, h, dτ; E_r = mean(shift), skip = 0)</code></pre><p>Compute the weights for reweighting over <code>h</code> time steps with reference energy <code>E_r</code> from the linearised formula</p><p class="math-container">\[w_h^{(n)} = \prod_{j=1}^h [1-dτ(S^{(q+n-j)}-E_r)] ,\]</p><p>where <code>q = skip</code>.</p><p>See also <a href="statstools.html#Rimu.StatsTools.w_exp-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>w_exp()</code></a>, <a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>growth_estimator()</code></a>, <a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>mixed_estimator()</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/reweighting.jl#L35-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.replica_fidelity-Tuple{DataFrames.DataFrame}" href="#Rimu.StatsTools.replica_fidelity-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.replica_fidelity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">replica_fidelity(df::DataFrame; p_field = :hproj, skip = 0)</code></pre><p>Compute the fidelity of the average coefficient vector and the projector defined in <code>p_field</code> from the result of replica <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a> passed as  argument <code>df</code>, using replicas <code>_1</code> and <code>_2</code>. Calls <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a> to perform a blocking analysis on a ratio of the means of separate time series and returns a <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>. The first <code>skip</code> steps in the time series are skipped.</p><p>The fidelity of states <code>|ψ⟩</code> and <code>|ϕ⟩</code> is defined as</p><p class="math-container">\[F(ψ,ϕ) = \frac{|⟨ψ|ϕ⟩|^2}{⟨ψ|ψ⟩⟨ϕ|ϕ⟩} .\]</p><p>Specifically, <code>replica_fidelity</code> computes</p><p class="math-container">\[F(\mathbf{v},⟨\mathbf{c}⟩) =
    \frac{⟨(\mathbf{c}_1⋅\mathbf{v})(\mathbf{v}⋅\mathbf{c}_1)⟩}
    {⟨\mathbf{c}_1⋅\mathbf{c}_1⟩} ,\]</p><p>where <code>v</code> is the projector specified by <code>p_field</code>, which is assumed to be normalised to unity with the two-norm (i.e. <code>v⋅v == 1</code>), and <span>$\mathbf{c}_1$</span> and <span>$\mathbf{c}_2$</span> are two replica coefficient vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/fidelity.jl#L1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.variational_energy_estimator-Tuple{Any, Any}" href="#Rimu.StatsTools.variational_energy_estimator-Tuple{Any, Any}"><code>Rimu.StatsTools.variational_energy_estimator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">variational_energy_estimator(shifts, overlaps; kwargs...)
variational_energy_estimator(df::DataFrame; max_replicas=:all, kwargs...)
-&gt; r::RatioBlockingResult</code></pre><p>Compute the variational energy estimator from the replica time series of the <code>shifts</code> and coefficient vector <code>overlaps</code> by blocking analysis. The keyword argument <code>max_replicas</code> can be used to constrain the number of replicas processed to be smaller than all available in <code>df</code>. Other keyword arguments are passed on to <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a>. Returns a <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p><p>An estimator for the variational energy</p><p class="math-container">\[\frac{⟨\mathbf{c}⟩^† \mathbf{H}⟨\mathbf{c}⟩}{⟨\mathbf{c}⟩^†⟨\mathbf{c}⟩}\]</p><p>is calculated from</p><p class="math-container">\[Ē_{v}  =  \frac{\sum_{a&lt;b}^R \overline{(S_a+S_b) \mathbf{c}_a^† \mathbf{c}_b}}
               {2\sum_{a&lt;b}^R \overline{\mathbf{c}_a^† \mathbf{c}_b}} ,\]</p><p>where the sum goes over distinct pairs out of the <span>$R$</span> replicas. See <a href="http://arxiv.org/abs/2103.07800">arXiv:2103.07800</a>.</p><p>The <code>DataFrame</code> version can extract the relevant information from the result of <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a>. Set up <a href="API.html#Rimu.lomc!-Tuple{Any, Any}"><code>lomc!</code></a> with the keyword argument <code>replica = AllOverlaps(R)</code> and <code>R ≥ 2</code>. If passing <code>shifts</code> and <code>overlaps</code>, the data has to be arranged in the correct order (as provided in the <code>DataFrame</code> version).</p><p>See <a href="API.html#Rimu.AllOverlaps"><code>AllOverlaps</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/variational_energy_estimator.jl#L1-L31">source</a></section></article><h2 id="Additional-docstrings"><a class="docs-heading-anchor" href="#Additional-docstrings">Additional docstrings</a><a id="Additional-docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-docstrings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MonteCarloMeasurements.Particles-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}" href="#MonteCarloMeasurements.Particles-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}"><code>MonteCarloMeasurements.Particles</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MonteCarloMeasurements.Particles(r::BlockingResult; mc_samples = 2000)
MonteCarloMeasurements.±(r::BlockingResult)</code></pre><p>Convert a <code>BlockingResult</code> into a <code>Particles</code> object for nonlinear error propagation with <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L93-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.BlockingResult" href="#Rimu.StatsTools.BlockingResult"><code>Rimu.StatsTools.BlockingResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BlockingResult(mean, err, err_err, p_cov, k, blocks)</code></pre><p>Result of <a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>blocking_analysis</code></a>.</p><p><strong>Fields:</strong></p><ul><li><code>mean</code>: sample mean</li><li><code>err</code>: standard error (estimated standard deviation of the mean)</li><li><code>err_err</code>: estimated uncertainty of <code>err</code></li><li><code>p_cov</code>: estimated pseudo covariance of <code>mean</code>, relevant for complex time series</li><li><code>k::Int</code>: k-1 blocking steps were used to uncorrelate time series</li><li><code>blocks::Int</code>: number of uncorrelated values after blocking</li></ul><p>Has methods for <a href="statstools.html#Core.NamedTuple-Tuple{Rimu.StatsTools.BlockingResult}"><code>NamedTuple</code></a>, <a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>val_and_errs</code></a>, <a href="statstools.html#Rimu.StatsTools.val-Tuple{Any}"><code>val</code></a>, <a href="statstools.html#Rimu.StatsTools.errs-Tuple"><code>errs</code></a>, <a href="statstools.html#Rimu.StatsTools.mean_and_se-Tuple{Rimu.StatsTools.BlockingResult}"><code>mean_and_se</code></a>, <code>Measurements.:±</code>, <a href="statstools.html#MonteCarloMeasurements.Particles-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}"><code>MonteCarloMeasurements.Particles</code></a>, and <code>Statistics.cov</code> for <code>Complex</code> data.</p><p><strong>Example:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; blocking_analysis(smoothen(randn(2^10), 2^5))
BlockingResult{Float64}
  mean = -0.026 ± 0.029
  with uncertainty of ± 0.003638545517264226
  from 32 blocks after 5 transformations (k = 6).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L5-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Measurements.measurement-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}" href="#Measurements.measurement-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}"><code>Measurements.measurement</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">measurement(r::BlockingResult)
Measurements.±(r::BlockingResult)</code></pre><p>Convert a <code>BlockingResult</code> into a <code>Measurement</code> for linear error propagation with <a href="https://github.com/JuliaPhysics/Measurements.jl"><code>Measurements</code></a>.</p><p>Limitation: Does not account for covariance in complex <code>BlockingResult</code>. Consider using <a href="statstools.html#MonteCarloMeasurements.Particles-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}"><code>MonteCarloMeasurements.Particles(r)</code></a>!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L75-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.blocker-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T" href="#Rimu.StatsTools.blocker-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T"><code>Rimu.StatsTools.blocker</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">blocker(v::Vector) -&gt; new_v::Vector</code></pre><p>Reblock the data by successively taking the mean of two adjacent data points to form a new vector with a half of the <code>length(v)</code>. The last data point will be discarded if <code>length(v)</code> is odd.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L248-L253">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.blocks_with_m-Tuple{Any}" href="#Rimu.StatsTools.blocks_with_m-Tuple{Any}"><code>Rimu.StatsTools.blocks_with_m</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">blocks_with_m(v; corrected = true) -&gt; (;blocks, mean, std_err, std_err_err, p_cov, mj)</code></pre><p>Perform the blocking algorithm from Flyvberg and Peterson <a href="http://aip.scitation.org/doi/10.1063/1.457480">JCP (1989)</a>. Returns named tuple with the results from all blocking steps. See <a href="statstools.html#Rimu.StatsTools.mtest-Tuple{AbstractVector}"><code>mtest()</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L288-L293">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.mtest-Tuple{AbstractVector}" href="#Rimu.StatsTools.mtest-Tuple{AbstractVector}"><code>Rimu.StatsTools.mtest</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mtest(mj::AbstractVector; α = 0.01) -&gt; k
mtest(table::NamedTuple; α = 0.01) -&gt; k</code></pre><p>Hypothesis test for decorrelation of a time series after blocking transformations with significance level <span>$1-α$</span> after Jonson <a href="https://doi.org/10.1103/PhysRevE.98.043304">PRE (2018)</a>. <code>mj</code> or <code>table.mj</code> is expected to be a vector with relevant <span>$M_j$</span> values from a blocking analysis as obtained from <a href="statstools.html#Rimu.StatsTools.blocks_with_m-Tuple{Any}"><code>blocks_with_m()</code></a>. Returns the row number <code>k</code> where the M-test is passed. If the M-test has failed <code>mtest()</code> returns the value <code>-1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/blocking.jl#L263-L273">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.RatioBlockingResult" href="#Rimu.StatsTools.RatioBlockingResult"><code>Rimu.StatsTools.RatioBlockingResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RatioBlockingResult(ratio, f, σ_f, δ_y, k, success)</code></pre><p>Result of <a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>ratio_of_means()</code></a>.</p><p><strong>Fields:</strong></p><ul><li><code>ratio::P</code>: ratio with uncertainties propagated by <a href="https://github.com/baggepinnen/MonteCarloMeasurements.jl"><code>MonteCarloMeasurements</code></a></li><li><code>f::T</code>: ratio of means</li><li><code>σ_f::T</code>: std from linear propagation</li><li><code>δ_y::T</code>: coefficient of variation for denominator (≤ 0.1 for normal approx)</li><li><code>k::Int</code>: k-1 blocking steps were used to uncorrelate time series</li><li><code>blocks::Int</code>: number of data values after blocking</li><li><code>success::Bool</code>: false if any of the blocking steps failed</li></ul><p>Has methods for <a href="statstools.html#Core.NamedTuple-Tuple{Rimu.StatsTools.BlockingResult}"><code>NamedTuple</code></a>, <a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>val_and_errs</code></a>, <a href="statstools.html#Rimu.StatsTools.val-Tuple{Any}"><code>val</code></a>, <a href="statstools.html#Rimu.StatsTools.errs-Tuple"><code>errs</code></a>.</p><p>Note: to compute statistics on the <code>RatioBlockingResult</code>, use functions <code>pmedian</code>, <code>pquantile</code>, <code>pmiddle</code>, <code>piterate</code>, <code>pextrema</code>, <code>pminimum</code>, <code>pmaximum</code>, <code>pmean</code>, and <code>pcov</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/ratio_of_means.jl#L3-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.particles-Tuple{Any, Any, Any}" href="#Rimu.StatsTools.particles-Tuple{Any, Any, Any}"><code>Rimu.StatsTools.particles</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">particles(samples, μ, σ)
particles(samples, μ::AbstractVector, Σ::AbstractMatrix)</code></pre><p>Return <code>Particles</code> object from <code>MonteCarloMeasurements</code> with single- or multivariate normal distribution. Zero variance parameters are supported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/ratio_of_means.jl#L189-L194">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.particles-Tuple{Any, Distributions.Distribution}" href="#Rimu.StatsTools.particles-Tuple{Any, Distributions.Distribution}"><code>Rimu.StatsTools.particles</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">particles(samples, d)
particles(::Nothing, d)
particles(::Val{T}, d) where T</code></pre><p>Return <code>Particles</code> object from  <code>MonteCarloMeasurements</code> using  a type-stable constructor if possible. Pass <code>nothing</code> for the default number of particles or <code>Val(1_000)</code> for using 1000 particles in a type-stable manner. If <code>d</code> is a <code>Particles</code> object it is passed through without re-sampling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/ratio_of_means.jl#L173-L181">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.ratio_estimators-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}" href="#Rimu.StatsTools.ratio_estimators-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}"><code>Rimu.StatsTools.ratio_estimators</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ratio_estimators(x, y, [k]; corrected=true, mc_samples=10_000) -&gt; (; r, f, σ_f, δ_y, n)</code></pre><p>Estimators for the ratio of means <code>mean(x)/mean(y)</code>. If <code>k</code> is given, <code>k-1</code> blocking steps are performed to remove internal correlations in the time series <code>x</code> and <code>y</code>. Otherwise these are assumed to be free of internal correlations. Correlations between <code>x</code> and <code>y</code> may be present and are taken into account.</p><p><strong>Return values:</strong></p><ul><li><code>r::Particles</code> is the Monte Carlo sampled ratio estimator, see <a href="statstools.html#MonteCarloMeasurements.Particles-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}"><code>Particles</code></a></li><li><code>f = mean(x)/mean(y)</code></li><li><code>σ_f</code> standard deviation of <code>f</code> from linear error propagation (normal approximation)</li><li><code>δ_y = std(y)/mean(y)</code> coefficient of variation; &lt; 0.1 for normal approximation to work</li><li><code>n</code>: number of uncorrelated data used for uncertainty estimation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/ratio_of_means.jl#L221-L235">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.x_by_y_linear-NTuple{5, Any}" href="#Rimu.StatsTools.x_by_y_linear-NTuple{5, Any}"><code>Rimu.StatsTools.x_by_y_linear</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">x_by_y_linear(μ_x,μ_y,σ_x,σ_y,ρ) -&gt; f, σ_f</code></pre><p>Linear error propagation for ratio <code>f = x/y</code> assuming <code>x</code> and <code>y</code> are correlated normal random variables and assuming the ratio can be approximated as a normal distribution. See <a href="https://en.wikipedia.org/wiki/Propagation_of_uncertainty">wikipedia</a> and <a href="http://link.springer.com/10.1007/s00362-012-0429-2">Díaz-Francés, Rubio (2013)</a>.</p><p class="math-container">\[σ_f = \sqrt{\frac{σ_x}{μ_y}^2 + \frac{μ_x σ_y}{μ_y^2}^2 - \frac{2 ρ μ_x}{μ_y^3}}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/ratio_of_means.jl#L156-L165">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Core.NamedTuple-Tuple{Rimu.StatsTools.BlockingResult}" href="#Core.NamedTuple-Tuple{Rimu.StatsTools.BlockingResult}"><code>Core.NamedTuple</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NamedTuple(x::BlockingResult; n=1, p=nothing, name=:val)
NamedTuple(x::RatioBlockingResult; n=1, p=nothing, name=:val)</code></pre><p>Return a named tuple with value and error bars (see <a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>val_and_errs</code></a>) as well as additional numerical fields relevant for <code>x</code>.</p><p><strong>Example:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; results = [blocking_analysis(i:0.1:2i+20) for i in 1:3]; # mock results

julia&gt; df = NamedTuple.(results, name=:res)|&gt;DataFrame
3×7 DataFrame
 Row │ res      res_l    res_u    res_err_err  res_p_cov  res_k  res_blocks
     │ Float64  Float64  Float64  Float64      Float64    Int64  Int64
─────┼──────────────────────────────────────────────────────────────────────
   1 │    11.5  1.7282   1.7282      0.352767    2.98667      5          13
   2 │    13.0  1.7282   1.7282      0.352767    2.98667      5          13
   3 │    14.5  1.78885  1.78885     0.350823    3.2          5          14</code></pre><pre><code class="language-julia-repl hljs">julia&gt; rbs = ratio_of_means(1 .+sin.(1:0.1:11),2 .+sin.(2:0.1:12)); # more mock results

julia&gt; [NamedTuple(rbs),]|&gt;DataFrame
1×9 DataFrame
 Row │ val       val_l      val_u      val_f     val_σ_f    val_δ_y    val_k  val_blocks  val_success
     │ Float64   Float64    Float64    Float64   Float64    Float64    Int64  Int64       Bool
─────┼────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ 0.581549  0.0925669  0.0812292  0.560532  0.0875548  0.0875548      4          12         true
</code></pre><p>See <a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>val_and_errs</code></a>, <a href="statstools.html#Rimu.StatsTools.val-Tuple{Any}"><code>val</code></a>, <a href="statstools.html#Rimu.StatsTools.errs-Tuple"><code>errs</code></a>, <a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>BlockingResult</code></a>, <a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>RatioBlockingResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/convenience.jl#L125-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.autocovariance-Tuple{AbstractVector, Int64}" href="#Rimu.StatsTools.autocovariance-Tuple{AbstractVector, Int64}"><code>Rimu.StatsTools.autocovariance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">autocovariance(v::Vector,h::Int; corrected::Bool=true)</code></pre><p><span>$\hat{\gamma}(h) =\frac{1}{n}\sum_{t=1}^{n-h}(v_{t+h}-\bar{v})(v_t-\bar{v})^*$</span> Calculate the autocovariance of dataset <code>v</code> with a delay <code>h</code>. If <code>corrected</code> is <code>true</code> (the default) then the sum is scaled with <code>n-h</code>, whereas the sum is scaled with <code>n</code> if corrected is <code>false</code> where <code>n = length(v)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/variances.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Rimu.StatsTools.pseudo_cov-Tuple{Any, Any}" href="#Rimu.StatsTools.pseudo_cov-Tuple{Any, Any}"><code>Rimu.StatsTools.pseudo_cov</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pseudo_cov(x, y; xmean = mean(x), ymean = mean(y), corrected = true)</code></pre><p>Compute the pseudo covariance between collections <code>x</code> and <code>y</code> returning a scalar:</p><p class="math-container">\[\frac{1}{n}\sum_{i=1}^{n} (x_i - \bar{x})(y_{i} - \bar{y})\]</p><p>Optionally, precomputed means can be passed as keyword arguments. <code>pseudo_cov(x,y)</code> is functionally equivalent to <code>Statistics.cov(x, conj(y); corrected = false)</code> but it is found to be significantly faster and avoids allocations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/joachimbrand/Rimu.jl/blob/437c26a310467a7b0b0c8d1e1c8b65eb4fba49d5/src/StatsTools/variances.jl#L18-L28">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="statstools.html#Rimu.StatsTools"><code>Rimu.StatsTools</code></a></li><li><a href="statstools.html#Core.NamedTuple-Tuple{Rimu.StatsTools.BlockingResult}"><code>Core.NamedTuple</code></a></li><li><a href="statstools.html#MonteCarloMeasurements.Particles-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}"><code>MonteCarloMeasurements.Particles</code></a></li><li><a href="statstools.html#Rimu.StatsTools.BlockingResult"><code>Rimu.StatsTools.BlockingResult</code></a></li><li><a href="statstools.html#Rimu.StatsTools.RatioBlockingResult"><code>Rimu.StatsTools.RatioBlockingResult</code></a></li><li><a href="statstools.html#Measurements.measurement-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Real}}"><code>Measurements.measurement</code></a></li><li><a href="statstools.html#Rimu.StatsTools.autocovariance-Tuple{AbstractVector, Int64}"><code>Rimu.StatsTools.autocovariance</code></a></li><li><a href="statstools.html#Rimu.StatsTools.blocker-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T"><code>Rimu.StatsTools.blocker</code></a></li><li><a href="statstools.html#Rimu.StatsTools.blocking_analysis-Tuple{AbstractVector}"><code>Rimu.StatsTools.blocking_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.blocking_analysis_data-Tuple{AbstractVector}"><code>Rimu.StatsTools.blocking_analysis_data</code></a></li><li><a href="statstools.html#Rimu.StatsTools.blocks_with_m-Tuple{Any}"><code>Rimu.StatsTools.blocks_with_m</code></a></li><li><a href="statstools.html#Rimu.StatsTools.errs-Tuple"><code>Rimu.StatsTools.errs</code></a></li><li><a href="statstools.html#Rimu.StatsTools.growth_estimator-NTuple{4, Any}"><code>Rimu.StatsTools.growth_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.growth_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.growth_estimator_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.growth_witness"><code>Rimu.StatsTools.growth_witness</code></a></li><li><a href="statstools.html#Rimu.StatsTools.growth_witness-Tuple{AbstractArray, AbstractArray, Any}"><code>Rimu.StatsTools.growth_witness</code></a></li><li><a href="statstools.html#Rimu.StatsTools.mean_and_se-Tuple{Rimu.StatsTools.BlockingResult}"><code>Rimu.StatsTools.mean_and_se</code></a></li><li><a href="statstools.html#Rimu.StatsTools.mixed_estimator-NTuple{5, Any}"><code>Rimu.StatsTools.mixed_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.mixed_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.mixed_estimator_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.mtest-Tuple{AbstractVector}"><code>Rimu.StatsTools.mtest</code></a></li><li><a href="statstools.html#Rimu.StatsTools.particles-Tuple{Any, Any, Any}"><code>Rimu.StatsTools.particles</code></a></li><li><a href="statstools.html#Rimu.StatsTools.particles-Tuple{Any, Distributions.Distribution}"><code>Rimu.StatsTools.particles</code></a></li><li><a href="statstools.html#Rimu.StatsTools.projected_energy-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.projected_energy</code></a></li><li><a href="statstools.html#Rimu.StatsTools.pseudo_cov-Tuple{Any, Any}"><code>Rimu.StatsTools.pseudo_cov</code></a></li><li><a href="statstools.html#Rimu.StatsTools.ratio_estimators-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}"><code>Rimu.StatsTools.ratio_estimators</code></a></li><li><a href="statstools.html#Rimu.StatsTools.ratio_of_means-Tuple{Any, Any}"><code>Rimu.StatsTools.ratio_of_means</code></a></li><li><a href="statstools.html#Rimu.StatsTools.rayleigh_replica_estimator-Tuple{Vector, Vector, Vector, Any, Any}"><code>Rimu.StatsTools.rayleigh_replica_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.rayleigh_replica_estimator_analysis-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.rayleigh_replica_estimator_analysis</code></a></li><li><a href="statstools.html#Rimu.StatsTools.replica_fidelity-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.replica_fidelity</code></a></li><li><a href="statstools.html#Rimu.StatsTools.shift_estimator-Tuple{DataFrames.DataFrame}"><code>Rimu.StatsTools.shift_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.smoothen-Tuple{AbstractVector, Integer}"><code>Rimu.StatsTools.smoothen</code></a></li><li><a href="statstools.html#Rimu.StatsTools.to_measurement-Tuple{MonteCarloMeasurements.Particles}"><code>Rimu.StatsTools.to_measurement</code></a></li><li><a href="statstools.html#Rimu.StatsTools.val-Tuple{Any}"><code>Rimu.StatsTools.val</code></a></li><li><a href="statstools.html#Rimu.StatsTools.val_and_errs-Tuple{Any}"><code>Rimu.StatsTools.val_and_errs</code></a></li><li><a href="statstools.html#Rimu.StatsTools.variational_energy_estimator-Tuple{Any, Any}"><code>Rimu.StatsTools.variational_energy_estimator</code></a></li><li><a href="statstools.html#Rimu.StatsTools.w_exp-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>Rimu.StatsTools.w_exp</code></a></li><li><a href="statstools.html#Rimu.StatsTools.w_lin-Tuple{Union{SubArray{&lt;:Any, 1, &lt;:Vector, &lt;:Any, true}, Vector}, Any, Any}"><code>Rimu.StatsTools.w_lin</code></a></li><li><a href="statstools.html#Rimu.StatsTools.x_by_y_linear-NTuple{5, Any}"><code>Rimu.StatsTools.x_by_y_linear</code></a></li><li><a href="statstools.html#Statistics.cov-Tuple{Rimu.StatsTools.BlockingResult{&lt;:Complex}}"><code>Statistics.cov</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="generated/HO-example.html">« Degenerate perturbation theory in a harmonic oscillator basis</a><a class="docs-footer-nextpage" href="interfaces.html">Interfaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 22 May 2023 09:36">Monday 22 May 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
